{
    "url": "https://api.github.com/repos/pallets/flask/issues/2941",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/2941/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/2941/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/2941/events",
    "html_url": "https://github.com/pallets/flask/issues/2941",
    "id": 370056493,
    "node_id": "MDU6SXNzdWUzNzAwNTY0OTM=",
    "number": 2941,
    "title": "Testing API with 1.0.2: <Response streamed [404 NOT FOUND]>",
    "user": {
        "login": "edouard-lopez",
        "id": 1212392,
        "node_id": "MDQ6VXNlcjEyMTIzOTI=",
        "avatar_url": "https://avatars1.githubusercontent.com/u/1212392?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/edouard-lopez",
        "html_url": "https://github.com/edouard-lopez",
        "followers_url": "https://api.github.com/users/edouard-lopez/followers",
        "following_url": "https://api.github.com/users/edouard-lopez/following{/other_user}",
        "gists_url": "https://api.github.com/users/edouard-lopez/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/edouard-lopez/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/edouard-lopez/subscriptions",
        "organizations_url": "https://api.github.com/users/edouard-lopez/orgs",
        "repos_url": "https://api.github.com/users/edouard-lopez/repos",
        "events_url": "https://api.github.com/users/edouard-lopez/events{/privacy}",
        "received_events_url": "https://api.github.com/users/edouard-lopez/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 3,
    "created_at": "2018-10-15T08:40:28Z",
    "updated_at": "2018-10-15T18:33:59Z",
    "closed_at": "2018-10-15T17:46:58Z",
    "author_association": "NONE",
    "body": "**related:** flask-restful/flask-restful#782\r\n\r\nComplete cource code can be found in [coaxis-asp/opt](https://github.com/Coaxis-ASP/opt/tree/master/daemon/api) repository.\r\n\r\n### Requirements\r\n\r\n`Python 3.6.6`\r\n\r\n```\r\nFlask==1.0.2\r\nFlask-RESTful==0.3.6\r\n```\r\n\r\n### Project Layout\r\n\r\n```\r\n./api/\r\n\u251c\u2500\u2500 __init__.py\r\n\u251c\u2500\u2500 tests\r\n\u2502   \u251c\u2500\u2500 __init__.py\r\n\u2502   \u251c\u2500\u2500 test_views.py  \r\n\u2514\u2500\u2500 views.py  # declare API (cf. below)\r\n```\r\n\r\n### `views.py`\r\n\r\n```\r\nfrom flask import Flask, Response, request\r\nfrom flask_restful import Api, Resource, abort\r\n\r\napp = Flask(__name__)\r\napi = Api(app, prefix='/api')\r\n\r\nclass Root(Resource):\r\n    def get(self):\r\n        return {\r\n            'results': None\r\n        }\r\n\r\napi.add_resource(Root, '/')\r\n\r\nif __name__ == \"__main__\":\r\n    app.run(debug=True, host='0.0.0.0')\r\n```\r\n\r\n### `test_views.py`\r\n\r\n```\r\nfrom pprint import pprint\r\nfrom unittest import TestCase\r\n\r\nfrom views import app\r\n\r\nclass TestIntegrations(TestCase):\r\n    def setUp(self):\r\n        self.app = app.test_client()\r\n\r\n    def test_thing(self):\r\n        response = self.app.get('/sites/')\r\n        pprint(response)\r\n        self.assertDictEqual(response.json, {'results': None})\r\n```\r\n\r\n### Error\r\n\r\n```\r\n$ python3 -m unittest tests.test_views --verbose\r\ntest_thing (tests.test_views.TestIntegrations) ... \r\n<Response streamed [404 NOT FOUND]>\r\nFAIL\r\n\r\n======================================================================\r\nFAIL: test_thing (tests.test_views.TestIntegrations)\r\n----------------------------------------------------------------------\r\nTraceback (most recent call last):\r\n  File \"/data/projects/coaxis-opt/daemon/api/tests/test_views.py\", line 13, in test_thing\r\n    self.assertDictEqual(response.json, {'results': None})\r\nAssertionError: None is not an instance of <class 'dict'> : First argument is not a dictionary\r\n\r\n----------------------------------------------------------------------\r\nRan 1 test in 0.007s\r\n\r\nFAILED (failures=1)\r\n```\r\n\r\n### Question\r\n\r\nDespite my API responding correctly in the browser and all my other tests running with `unittest`, the test case for the API fail with an error `404`. What the matter ?",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/429802638",
            "html_url": "https://github.com/pallets/flask/issues/2941#issuecomment-429802638",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2941",
            "id": 429802638,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQyOTgwMjYzOA==",
            "user": {
                "login": "garenchan",
                "id": 13200012,
                "node_id": "MDQ6VXNlcjEzMjAwMDEy",
                "avatar_url": "https://avatars2.githubusercontent.com/u/13200012?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/garenchan",
                "html_url": "https://github.com/garenchan",
                "followers_url": "https://api.github.com/users/garenchan/followers",
                "following_url": "https://api.github.com/users/garenchan/following{/other_user}",
                "gists_url": "https://api.github.com/users/garenchan/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/garenchan/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/garenchan/subscriptions",
                "organizations_url": "https://api.github.com/users/garenchan/orgs",
                "repos_url": "https://api.github.com/users/garenchan/repos",
                "events_url": "https://api.github.com/users/garenchan/events{/privacy}",
                "received_events_url": "https://api.github.com/users/garenchan/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-10-15T10:51:34Z",
            "updated_at": "2018-10-15T10:51:54Z",
            "author_association": "CONTRIBUTOR",
            "body": "Your application only has a view function for url '**/api/**'.  So in your test case, the client accessed url '**/sites/**' and got a 404 response."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/429948687",
            "html_url": "https://github.com/pallets/flask/issues/2941#issuecomment-429948687",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2941",
            "id": 429948687,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQyOTk0ODY4Nw==",
            "user": {
                "login": "edouard-lopez",
                "id": 1212392,
                "node_id": "MDQ6VXNlcjEyMTIzOTI=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1212392?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/edouard-lopez",
                "html_url": "https://github.com/edouard-lopez",
                "followers_url": "https://api.github.com/users/edouard-lopez/followers",
                "following_url": "https://api.github.com/users/edouard-lopez/following{/other_user}",
                "gists_url": "https://api.github.com/users/edouard-lopez/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/edouard-lopez/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/edouard-lopez/subscriptions",
                "organizations_url": "https://api.github.com/users/edouard-lopez/orgs",
                "repos_url": "https://api.github.com/users/edouard-lopez/repos",
                "events_url": "https://api.github.com/users/edouard-lopez/events{/privacy}",
                "received_events_url": "https://api.github.com/users/edouard-lopez/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-10-15T17:46:58Z",
            "updated_at": "2018-10-15T17:46:58Z",
            "author_association": "NONE",
            "body": "Thanks!\r\nI was trying to hit `/` not `sites/` just copied the work path. \r\n\r\nAnyway, I still got the issue with `/` but using `/api/` worked !"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/429965903",
            "html_url": "https://github.com/pallets/flask/issues/2941#issuecomment-429965903",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2941",
            "id": 429965903,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQyOTk2NTkwMw==",
            "user": {
                "login": "edouard-lopez",
                "id": 1212392,
                "node_id": "MDQ6VXNlcjEyMTIzOTI=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1212392?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/edouard-lopez",
                "html_url": "https://github.com/edouard-lopez",
                "followers_url": "https://api.github.com/users/edouard-lopez/followers",
                "following_url": "https://api.github.com/users/edouard-lopez/following{/other_user}",
                "gists_url": "https://api.github.com/users/edouard-lopez/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/edouard-lopez/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/edouard-lopez/subscriptions",
                "organizations_url": "https://api.github.com/users/edouard-lopez/orgs",
                "repos_url": "https://api.github.com/users/edouard-lopez/repos",
                "events_url": "https://api.github.com/users/edouard-lopez/events{/privacy}",
                "received_events_url": "https://api.github.com/users/edouard-lopez/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-10-15T18:33:59Z",
            "updated_at": "2018-10-15T18:33:59Z",
            "author_association": "NONE",
            "body": "I setup a minimal project to run test: [test-flask-restful-api](https://github.com/edouard-lopez/test-flask-restful-api)."
        }
    ]
}