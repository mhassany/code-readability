{
    "url": "https://api.github.com/repos/pallets/flask/issues/829",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/829/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/829/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/829/events",
    "html_url": "https://github.com/pallets/flask/pull/829",
    "id": 17876989,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NzUxMTcwOQ==",
    "number": 829,
    "title": "Making redirecting safe / Deprecating redirects to 3rd party hosts",
    "user": {
        "login": "DasIch",
        "id": 182316,
        "node_id": "MDQ6VXNlcjE4MjMxNg==",
        "avatar_url": "https://avatars0.githubusercontent.com/u/182316?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/DasIch",
        "html_url": "https://github.com/DasIch",
        "followers_url": "https://api.github.com/users/DasIch/followers",
        "following_url": "https://api.github.com/users/DasIch/following{/other_user}",
        "gists_url": "https://api.github.com/users/DasIch/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/DasIch/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/DasIch/subscriptions",
        "organizations_url": "https://api.github.com/users/DasIch/orgs",
        "repos_url": "https://api.github.com/users/DasIch/repos",
        "events_url": "https://api.github.com/users/DasIch/events{/privacy}",
        "received_events_url": "https://api.github.com/users/DasIch/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 9,
    "created_at": "2013-08-09T18:03:28Z",
    "updated_at": "2016-04-01T21:15:44Z",
    "closed_at": "2016-04-01T21:15:44Z",
    "author_association": "CONTRIBUTOR",
    "pull_request": {
        "url": "https://api.github.com/repos/pallets/flask/pulls/829",
        "html_url": "https://github.com/pallets/flask/pull/829",
        "diff_url": "https://github.com/pallets/flask/pull/829.diff",
        "patch_url": "https://github.com/pallets/flask/pull/829.patch"
    },
    "body": "This PR adds a `safe_hosts` parameter to `redirect`, which allows defining a safe set of hosts to redirect to and issues a `DeprecationWarning`, if `redirect` is used to redirect to a different host than the one of the application or defined in `safe_hosts`. In the future instead of a `DeprecationWarning` being issued, an exception should be raised.\n\nThe purpose of this change is to prevent [unvalidated redirects](https://www.owasp.org/index.php/Top_10_2010-A10-Unvalidated_Redirects_and_Forwards), which is currently listed among the Top 10 of the most common web application vulnerabilities by OWASP and was recently mentioned by [Jacob Kaplan-Moss at a talk at PyCon Australia](https://www.youtube.com/watch?v=sra9x44lXgU). It's also an easy way to improve our results in comparisions like these ;)\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/22426224",
            "html_url": "https://github.com/pallets/flask/pull/829#issuecomment-22426224",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/829",
            "id": 22426224,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIyNDI2MjI0",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2013-08-09T22:12:05Z",
            "updated_at": "2013-08-09T22:12:15Z",
            "author_association": "MEMBER",
            "body": "Don't things like OAuth require the site to redirect to arbitrary hosts?\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/24466054",
            "html_url": "https://github.com/pallets/flask/pull/829#issuecomment-24466054",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/829",
            "id": 24466054,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI0NDY2MDU0",
            "user": {
                "login": "grahamlyons",
                "id": 284688,
                "node_id": "MDQ6VXNlcjI4NDY4OA==",
                "avatar_url": "https://avatars2.githubusercontent.com/u/284688?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/grahamlyons",
                "html_url": "https://github.com/grahamlyons",
                "followers_url": "https://api.github.com/users/grahamlyons/followers",
                "following_url": "https://api.github.com/users/grahamlyons/following{/other_user}",
                "gists_url": "https://api.github.com/users/grahamlyons/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/grahamlyons/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/grahamlyons/subscriptions",
                "organizations_url": "https://api.github.com/users/grahamlyons/orgs",
                "repos_url": "https://api.github.com/users/grahamlyons/repos",
                "events_url": "https://api.github.com/users/grahamlyons/events{/privacy}",
                "received_events_url": "https://api.github.com/users/grahamlyons/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2013-09-15T07:48:27Z",
            "updated_at": "2013-09-15T07:48:27Z",
            "author_association": "NONE",
            "body": "Yes, they do. And what about redirecting between the `.com` and `.co.uk` version of your domain, or the `www.` and `m.` version? \n\nAlso, the first link gives the example of an unvalidated redirect to an admin page which would be on the same domain and so isn't protected by this. \n\nI don't believe that this security vulnerability could or should be protected against by the framework, it's something which needs to be decided by the application logic. \n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/24469899",
            "html_url": "https://github.com/pallets/flask/pull/829#issuecomment-24469899",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/829",
            "id": 24469899,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI0NDY5ODk5",
            "user": {
                "login": "DasIch",
                "id": 182316,
                "node_id": "MDQ6VXNlcjE4MjMxNg==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/182316?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/DasIch",
                "html_url": "https://github.com/DasIch",
                "followers_url": "https://api.github.com/users/DasIch/followers",
                "following_url": "https://api.github.com/users/DasIch/following{/other_user}",
                "gists_url": "https://api.github.com/users/DasIch/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/DasIch/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/DasIch/subscriptions",
                "organizations_url": "https://api.github.com/users/DasIch/orgs",
                "repos_url": "https://api.github.com/users/DasIch/repos",
                "events_url": "https://api.github.com/users/DasIch/events{/privacy}",
                "received_events_url": "https://api.github.com/users/DasIch/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2013-09-15T11:35:54Z",
            "updated_at": "2013-09-15T11:35:54Z",
            "author_association": "CONTRIBUTOR",
            "body": "You can specify exceptions with the `safe_hosts` parameter, this includes the host you are currently redirecting to. You can still make arbitrary redirects, it's just inconvenient.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/24469980",
            "html_url": "https://github.com/pallets/flask/pull/829#issuecomment-24469980",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/829",
            "id": 24469980,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI0NDY5OTgw",
            "user": {
                "login": "ThiefMaster",
                "id": 179599,
                "node_id": "MDQ6VXNlcjE3OTU5OQ==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/179599?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ThiefMaster",
                "html_url": "https://github.com/ThiefMaster",
                "followers_url": "https://api.github.com/users/ThiefMaster/followers",
                "following_url": "https://api.github.com/users/ThiefMaster/following{/other_user}",
                "gists_url": "https://api.github.com/users/ThiefMaster/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ThiefMaster/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ThiefMaster/subscriptions",
                "organizations_url": "https://api.github.com/users/ThiefMaster/orgs",
                "repos_url": "https://api.github.com/users/ThiefMaster/repos",
                "events_url": "https://api.github.com/users/ThiefMaster/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ThiefMaster/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2013-09-15T11:41:12Z",
            "updated_at": "2013-09-15T11:42:33Z",
            "author_association": "MEMBER",
            "body": "Instead of DeprecationWarning I would rather default `safe_hosts` to `None` and make this allow any host by default and raising an error if something else is used. That way you don't get a \"toothless tiger\" while not breaking anyone's application. In any case, an option to disable host validation would be very important. Imagine a site which has the explicit purpose to be an open redirector (e.g. tinyurl-like site). Being forced to use a custom `redirect` function or build the `safe_hosts` value based on the redirect target would be pretty ugly.\n\nAdditionally I think the default value should come from the Flask config - I don't think having to specify valid targets all the time is a good idea.\n\nFor the types of values accepted I think the following would be useful:\n- `None` - do not check the host\n- Any collection/iterable - check the host; abort if not found. `domain.tld` should also cover `any.sub.domain.tld`\n- A callable - call it every time and let that function check if the host is allowed or not. However, I'm not sure if that's really necessary or something that belongs on a higher level (application code) instead.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/38323535",
            "html_url": "https://github.com/pallets/flask/pull/829#issuecomment-38323535",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/829",
            "id": 38323535,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM4MzIzNTM1",
            "user": {
                "login": "kennethreitz",
                "id": 119893,
                "node_id": "MDQ6VXNlcjExOTg5Mw==",
                "avatar_url": "https://avatars2.githubusercontent.com/u/119893?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/kennethreitz",
                "html_url": "https://github.com/kennethreitz",
                "followers_url": "https://api.github.com/users/kennethreitz/followers",
                "following_url": "https://api.github.com/users/kennethreitz/following{/other_user}",
                "gists_url": "https://api.github.com/users/kennethreitz/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/kennethreitz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/kennethreitz/subscriptions",
                "organizations_url": "https://api.github.com/users/kennethreitz/orgs",
                "repos_url": "https://api.github.com/users/kennethreitz/repos",
                "events_url": "https://api.github.com/users/kennethreitz/events{/privacy}",
                "received_events_url": "https://api.github.com/users/kennethreitz/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-03-21T21:00:17Z",
            "updated_at": "2014-03-21T21:00:17Z",
            "author_association": "CONTRIBUTOR",
            "body": "I completely agree with @ThiefMaster. Flask is wonderful because of it's simplicity and it's ability to allow you to _just do HTTP_. This fucks with that.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/53195944",
            "html_url": "https://github.com/pallets/flask/pull/829#issuecomment-53195944",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/829",
            "id": 53195944,
            "node_id": "MDEyOklzc3VlQ29tbWVudDUzMTk1OTQ0",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-08-24T14:53:50Z",
            "updated_at": "2014-08-24T14:53:58Z",
            "author_association": "MEMBER",
            "body": "I actually like the general idea of this PR, but also agree with ThiefMaster that the default `None` should mean that any host is allowed. Otherwise I'm pretty sure people will write code like this:\n\n```\nredirect(url, safe_hosts=[urlparse(url).netloc])\n```\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/109520433",
            "html_url": "https://github.com/pallets/flask/pull/829#issuecomment-109520433",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/829",
            "id": 109520433,
            "node_id": "MDEyOklzc3VlQ29tbWVudDEwOTUyMDQzMw==",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-06-06T04:34:21Z",
            "updated_at": "2015-06-06T04:34:21Z",
            "author_association": "MEMBER",
            "body": "@DasIch Mind if I close this PR, at least for now? The idea seems too unfinished to be merged like that.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/109520498",
            "html_url": "https://github.com/pallets/flask/pull/829#issuecomment-109520498",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/829",
            "id": 109520498,
            "node_id": "MDEyOklzc3VlQ29tbWVudDEwOTUyMDQ5OA==",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-06-06T04:34:31Z",
            "updated_at": "2015-06-06T04:34:31Z",
            "author_association": "MEMBER",
            "body": "Also this PR has gotten quite stale.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/204567829",
            "html_url": "https://github.com/pallets/flask/pull/829#issuecomment-204567829",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/829",
            "id": 204567829,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIwNDU2NzgyOQ==",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-04-01T21:15:44Z",
            "updated_at": "2016-04-01T21:15:44Z",
            "author_association": "MEMBER",
            "body": "Closing due to inactivity. Feel free to refile! (or ping me)\n"
        }
    ]
}