{
    "url": "https://api.github.com/repos/pallets/flask/issues/3345",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/3345/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/3345/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/3345/events",
    "html_url": "https://github.com/pallets/flask/issues/3345",
    "id": 486722803,
    "node_id": "MDU6SXNzdWU0ODY3MjI4MDM=",
    "number": 3345,
    "title": "Route Decorator redirects improperly",
    "user": {
        "login": "IceBearZero",
        "id": 25065012,
        "node_id": "MDQ6VXNlcjI1MDY1MDEy",
        "avatar_url": "https://avatars2.githubusercontent.com/u/25065012?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/IceBearZero",
        "html_url": "https://github.com/IceBearZero",
        "followers_url": "https://api.github.com/users/IceBearZero/followers",
        "following_url": "https://api.github.com/users/IceBearZero/following{/other_user}",
        "gists_url": "https://api.github.com/users/IceBearZero/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/IceBearZero/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/IceBearZero/subscriptions",
        "organizations_url": "https://api.github.com/users/IceBearZero/orgs",
        "repos_url": "https://api.github.com/users/IceBearZero/repos",
        "events_url": "https://api.github.com/users/IceBearZero/events{/privacy}",
        "received_events_url": "https://api.github.com/users/IceBearZero/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 4,
    "created_at": "2019-08-29T03:57:48Z",
    "updated_at": "2019-08-29T15:36:48Z",
    "closed_at": "2019-08-29T13:14:43Z",
    "author_association": "NONE",
    "body": "### Expected Behavior\r\nUsing the route decorator (below), I expect going to `/devices/1` to execute the related method, but instead it throws a 308 redirect response back to `devices`.\r\n\r\nIf I change the url to `/devices/2` it properly executes the method\r\n\r\nRemoving the 3rd route decorator does not change the behaviour, `devices/1` still redirects\r\n\r\n```python\r\n\r\n@app.route('/devices', methods=['GET'], defaults={\"page\":1,\"per_page\":1})\r\n@app.route('/devices/<int:page>', methods=['GET'], defaults={\"per_page\":1})\r\n@app.route('/devices/<int:page>/<int:per_page>', methods=['GET'])\r\ndef devices_get(page, per_page):\r\n\r\n```\r\n\r\n```\r\ndevices_get           GET      /devices/<int:page>/<int:per_page>\r\ndevices_get           GET      /devices/<int:page>\r\ndevices_get           GET      /devices\r\n```\r\n\r\n### Environment\r\n\r\n* Python version: 3.7\r\n* Flask version: '1.1.1'\r\n* werkzeug-0.15.5\r\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/526130647",
            "html_url": "https://github.com/pallets/flask/issues/3345#issuecomment-526130647",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3345",
            "id": 526130647,
            "node_id": "MDEyOklzc3VlQ29tbWVudDUyNjEzMDY0Nw==",
            "user": {
                "login": "mdbottino",
                "id": 25780651,
                "node_id": "MDQ6VXNlcjI1NzgwNjUx",
                "avatar_url": "https://avatars1.githubusercontent.com/u/25780651?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/mdbottino",
                "html_url": "https://github.com/mdbottino",
                "followers_url": "https://api.github.com/users/mdbottino/followers",
                "following_url": "https://api.github.com/users/mdbottino/following{/other_user}",
                "gists_url": "https://api.github.com/users/mdbottino/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/mdbottino/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mdbottino/subscriptions",
                "organizations_url": "https://api.github.com/users/mdbottino/orgs",
                "repos_url": "https://api.github.com/users/mdbottino/repos",
                "events_url": "https://api.github.com/users/mdbottino/events{/privacy}",
                "received_events_url": "https://api.github.com/users/mdbottino/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-08-29T10:42:40Z",
            "updated_at": "2019-08-29T10:45:39Z",
            "author_association": "NONE",
            "body": "Actually I think it's expected because of the way you set the routes. If you remove the `/devices` route it should work (exactly as before) but without redirects. \r\n\r\nAlso, as a side note it would be cleaner if you put the defaults in the function definition instead of the route if they are all the same. The default method is GET if you don't specify otherwise. This would be equivalent but without redirects:\r\n\r\n```\r\n@app.route('/devices/<int:page>/<int:per_page>')\r\n@app.route('/devices/<int:page>')\r\ndef devices_get(page=1, per_page=1):\r\n```"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/526179552",
            "html_url": "https://github.com/pallets/flask/issues/3345#issuecomment-526179552",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3345",
            "id": 526179552,
            "node_id": "MDEyOklzc3VlQ29tbWVudDUyNjE3OTU1Mg==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-08-29T13:14:43Z",
            "updated_at": "2019-08-29T13:14:43Z",
            "author_association": "MEMBER",
            "body": "This is expected. When multiple routes are associated with an endpoint and the route can be simplified by omitting defaults, Werkzeug's router (and therefore Flask) does so.\r\n\r\nYou'd notice the same thing if you went to `/devices/2/1`, it would redirect to `/devices/2` because the default for `per_page` is 1."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/526182932",
            "html_url": "https://github.com/pallets/flask/issues/3345#issuecomment-526182932",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3345",
            "id": 526182932,
            "node_id": "MDEyOklzc3VlQ29tbWVudDUyNjE4MjkzMg==",
            "user": {
                "login": "IceBearZero",
                "id": 25065012,
                "node_id": "MDQ6VXNlcjI1MDY1MDEy",
                "avatar_url": "https://avatars2.githubusercontent.com/u/25065012?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/IceBearZero",
                "html_url": "https://github.com/IceBearZero",
                "followers_url": "https://api.github.com/users/IceBearZero/followers",
                "following_url": "https://api.github.com/users/IceBearZero/following{/other_user}",
                "gists_url": "https://api.github.com/users/IceBearZero/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/IceBearZero/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/IceBearZero/subscriptions",
                "organizations_url": "https://api.github.com/users/IceBearZero/orgs",
                "repos_url": "https://api.github.com/users/IceBearZero/repos",
                "events_url": "https://api.github.com/users/IceBearZero/events{/privacy}",
                "received_events_url": "https://api.github.com/users/IceBearZero/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-08-29T13:23:14Z",
            "updated_at": "2019-08-29T13:23:14Z",
            "author_association": "NONE",
            "body": "Thanks everyone .. I tested this more and realized it was expected, and starts to make sense .. \r\nI also tried the defaults in the function def. and for reasons it didnt work, but I may have had too many moving pieces and was doing something dumb. Thanks"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/526241958",
            "html_url": "https://github.com/pallets/flask/issues/3345#issuecomment-526241958",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3345",
            "id": 526241958,
            "node_id": "MDEyOklzc3VlQ29tbWVudDUyNjI0MTk1OA==",
            "user": {
                "login": "IceBearZero",
                "id": 25065012,
                "node_id": "MDQ6VXNlcjI1MDY1MDEy",
                "avatar_url": "https://avatars2.githubusercontent.com/u/25065012?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/IceBearZero",
                "html_url": "https://github.com/IceBearZero",
                "followers_url": "https://api.github.com/users/IceBearZero/followers",
                "following_url": "https://api.github.com/users/IceBearZero/following{/other_user}",
                "gists_url": "https://api.github.com/users/IceBearZero/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/IceBearZero/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/IceBearZero/subscriptions",
                "organizations_url": "https://api.github.com/users/IceBearZero/orgs",
                "repos_url": "https://api.github.com/users/IceBearZero/repos",
                "events_url": "https://api.github.com/users/IceBearZero/events{/privacy}",
                "received_events_url": "https://api.github.com/users/IceBearZero/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-08-29T15:36:48Z",
            "updated_at": "2019-08-29T15:36:48Z",
            "author_association": "NONE",
            "body": "Leaving this here as well, as mentioned, moving defaults to the method-def. works, and also removes the redirect, so things work as (I) expected ;) .. thanks again\r\n"
        }
    ]
}