{
    "url": "https://api.github.com/repos/pallets/flask/issues/772",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/772/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/772/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/772/events",
    "html_url": "https://github.com/pallets/flask/issues/772",
    "id": 15639670,
    "node_id": "MDU6SXNzdWUxNTYzOTY3MA==",
    "number": 772,
    "title": "Flask 0.10.x and Werkzeug 0.9.x encoding issue",
    "user": {
        "login": "maxcountryman",
        "id": 74351,
        "node_id": "MDQ6VXNlcjc0MzUx",
        "avatar_url": "https://avatars3.githubusercontent.com/u/74351?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/maxcountryman",
        "html_url": "https://github.com/maxcountryman",
        "followers_url": "https://api.github.com/users/maxcountryman/followers",
        "following_url": "https://api.github.com/users/maxcountryman/following{/other_user}",
        "gists_url": "https://api.github.com/users/maxcountryman/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/maxcountryman/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/maxcountryman/subscriptions",
        "organizations_url": "https://api.github.com/users/maxcountryman/orgs",
        "repos_url": "https://api.github.com/users/maxcountryman/repos",
        "events_url": "https://api.github.com/users/maxcountryman/events{/privacy}",
        "received_events_url": "https://api.github.com/users/maxcountryman/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 4,
    "created_at": "2013-06-17T15:49:01Z",
    "updated_at": "2013-06-18T13:28:04Z",
    "closed_at": "2013-06-18T10:29:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "This appears to be an issue with how Werkzeug is encoding headers, new to the version series 0.9.x:\n\n``` python\n>>> from flask import Flask\n>>> app = Flask(__name__)\n>>> app.test_client().get('/', headers=[('User-Agent', u'\u4e2d\u6587')])\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/Library/Python/2.7/site-packages/werkzeug/test.py\", line 760, in get\n    return self.open(*args, **kw)\n  File \"/Library/Python/2.7/site-packages/flask/testing.py\", line 108, in open\n    follow_redirects=follow_redirects)\n  File \"/Library/Python/2.7/site-packages/werkzeug/test.py\", line 724, in open\n    environ = args[0].get_environ()\n  File \"/Library/Python/2.7/site-packages/werkzeug/test.py\", line 573, in get_environ\n    for key, value in self.headers.to_wsgi_list():\n  File \"/Library/Python/2.7/site-packages/werkzeug/datastructures.py\", line 1185, in to_wsgi_list\n    return [(k, v.encode('latin1')) for k, v in self]\nUnicodeEncodeError: 'latin-1' codec can't encode characters in position 0-1: ordinal not in range(256)\n```\n\nThis affects https://github.com/maxcountryman/flask-login/issues/78.\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/19555539",
            "html_url": "https://github.com/pallets/flask/issues/772#issuecomment-19555539",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/772",
            "id": 19555539,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE5NTU1NTM5",
            "user": {
                "login": "DasIch",
                "id": 182316,
                "node_id": "MDQ6VXNlcjE4MjMxNg==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/182316?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/DasIch",
                "html_url": "https://github.com/DasIch",
                "followers_url": "https://api.github.com/users/DasIch/followers",
                "following_url": "https://api.github.com/users/DasIch/following{/other_user}",
                "gists_url": "https://api.github.com/users/DasIch/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/DasIch/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/DasIch/subscriptions",
                "organizations_url": "https://api.github.com/users/DasIch/orgs",
                "repos_url": "https://api.github.com/users/DasIch/repos",
                "events_url": "https://api.github.com/users/DasIch/events{/privacy}",
                "received_events_url": "https://api.github.com/users/DasIch/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2013-06-17T16:10:17Z",
            "updated_at": "2013-06-17T16:10:17Z",
            "author_association": "CONTRIBUTOR",
            "body": "Is a non-latin1 User-Agent even allowed?\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/19556157",
            "html_url": "https://github.com/pallets/flask/issues/772#issuecomment-19556157",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/772",
            "id": 19556157,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE5NTU2MTU3",
            "user": {
                "login": "maxcountryman",
                "id": 74351,
                "node_id": "MDQ6VXNlcjc0MzUx",
                "avatar_url": "https://avatars3.githubusercontent.com/u/74351?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/maxcountryman",
                "html_url": "https://github.com/maxcountryman",
                "followers_url": "https://api.github.com/users/maxcountryman/followers",
                "following_url": "https://api.github.com/users/maxcountryman/following{/other_user}",
                "gists_url": "https://api.github.com/users/maxcountryman/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/maxcountryman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/maxcountryman/subscriptions",
                "organizations_url": "https://api.github.com/users/maxcountryman/orgs",
                "repos_url": "https://api.github.com/users/maxcountryman/repos",
                "events_url": "https://api.github.com/users/maxcountryman/events{/privacy}",
                "received_events_url": "https://api.github.com/users/maxcountryman/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2013-06-17T16:19:09Z",
            "updated_at": "2013-06-17T16:19:09Z",
            "author_association": "CONTRIBUTOR",
            "body": "@DasIch no idea, but this worked with Flask 0.9 and Werkzeug 0.8.x, fwiw.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/19602873",
            "html_url": "https://github.com/pallets/flask/issues/772#issuecomment-19602873",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/772",
            "id": 19602873,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE5NjAyODcz",
            "user": {
                "login": "mitsuhiko",
                "id": 7396,
                "node_id": "MDQ6VXNlcjczOTY=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/7396?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/mitsuhiko",
                "html_url": "https://github.com/mitsuhiko",
                "followers_url": "https://api.github.com/users/mitsuhiko/followers",
                "following_url": "https://api.github.com/users/mitsuhiko/following{/other_user}",
                "gists_url": "https://api.github.com/users/mitsuhiko/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/mitsuhiko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mitsuhiko/subscriptions",
                "organizations_url": "https://api.github.com/users/mitsuhiko/orgs",
                "repos_url": "https://api.github.com/users/mitsuhiko/repos",
                "events_url": "https://api.github.com/users/mitsuhiko/events{/privacy}",
                "received_events_url": "https://api.github.com/users/mitsuhiko/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2013-06-18T10:29:28Z",
            "updated_at": "2013-06-18T10:29:28Z",
            "author_association": "MEMBER",
            "body": "HTTP does not allow non latin1 headers out of the box. We changed the default encoding to latin1 because that's what WSGI on Python 3 does as well. For certain headers custom behavior is applied. For instance setting cookies to utf-8 values is allowed by tunneling it through latin1.\n\nThe correct solution for non latin1 headers is this RFC: http://tools.ietf.org/html/rfc5987 - we might implement that at a later point.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/19610862",
            "html_url": "https://github.com/pallets/flask/issues/772#issuecomment-19610862",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/772",
            "id": 19610862,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE5NjEwODYy",
            "user": {
                "login": "maxcountryman",
                "id": 74351,
                "node_id": "MDQ6VXNlcjc0MzUx",
                "avatar_url": "https://avatars3.githubusercontent.com/u/74351?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/maxcountryman",
                "html_url": "https://github.com/maxcountryman",
                "followers_url": "https://api.github.com/users/maxcountryman/followers",
                "following_url": "https://api.github.com/users/maxcountryman/following{/other_user}",
                "gists_url": "https://api.github.com/users/maxcountryman/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/maxcountryman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/maxcountryman/subscriptions",
                "organizations_url": "https://api.github.com/users/maxcountryman/orgs",
                "repos_url": "https://api.github.com/users/maxcountryman/repos",
                "events_url": "https://api.github.com/users/maxcountryman/events{/privacy}",
                "received_events_url": "https://api.github.com/users/maxcountryman/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2013-06-18T13:28:04Z",
            "updated_at": "2013-06-18T13:28:04Z",
            "author_association": "CONTRIBUTOR",
            "body": "It would be nice if this bug were kept open given that this breaks functionality from werkzeug 0.8.x; at least until RFC 5987 is implemented.\n"
        }
    ]
}