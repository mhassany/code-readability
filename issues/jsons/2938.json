{
    "url": "https://api.github.com/repos/pallets/flask/issues/2938",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/2938/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/2938/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/2938/events",
    "html_url": "https://github.com/pallets/flask/issues/2938",
    "id": 369000920,
    "node_id": "MDU6SXNzdWUzNjkwMDA5MjA=",
    "number": 2938,
    "title": "flask redirect failed",
    "user": {
        "login": "wiwengweng",
        "id": 1968042,
        "node_id": "MDQ6VXNlcjE5NjgwNDI=",
        "avatar_url": "https://avatars0.githubusercontent.com/u/1968042?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/wiwengweng",
        "html_url": "https://github.com/wiwengweng",
        "followers_url": "https://api.github.com/users/wiwengweng/followers",
        "following_url": "https://api.github.com/users/wiwengweng/following{/other_user}",
        "gists_url": "https://api.github.com/users/wiwengweng/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/wiwengweng/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/wiwengweng/subscriptions",
        "organizations_url": "https://api.github.com/users/wiwengweng/orgs",
        "repos_url": "https://api.github.com/users/wiwengweng/repos",
        "events_url": "https://api.github.com/users/wiwengweng/events{/privacy}",
        "received_events_url": "https://api.github.com/users/wiwengweng/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 1,
    "created_at": "2018-10-11T08:09:40Z",
    "updated_at": "2018-10-11T08:12:03Z",
    "closed_at": "2018-10-11T08:11:39Z",
    "author_association": "NONE",
    "body": "### Expected Behavior\r\n\r\nI have templates layout.html, index.html and 200.html, index and 200 inherit layout.html\r\nI try to submit a picture(base64 encoded) in index page, and if successful, redirect to 200.html\r\n\r\n````\r\n\r\n<!-- extend base layout -->\r\n{% extends \"layout.html\" %}\r\n\r\n{% block content %}\r\n<body>\r\n\r\n<div align=\"center\" id=\"container\">\r\n\r\n    <h2>Demo</h2>\r\n\r\n    <video playsinline autoplay></video>\r\n    <button type=\"submit\" class=\"btn btn-primary\">snapshot</button>\r\n    <canvas></canvas>\r\n    <br>\r\n    <label>name\uff1a</label><input type=\"text\">\r\n        <br><br>\r\n\t<button id=\"submit\" type=\"submit\" class=\"btn btn-primary\">submit</button>\r\n\r\n\r\n</div>\r\n<div id=\"myDiv\"></div>\r\n<script type=\"text/javascript\" src=\"{{ url_for('static', filename='js/lib/adapter.js') }}\"></script>\r\n<script type=\"text/javascript\" src=\"{{ url_for('static', filename='js/main.js') }}\" async></script>\r\n\r\n</body>\r\n{% endblock %}\r\n````\r\n\r\nmain.js\r\n```javascript\r\nconst submit = document.getElementById(\"submit\");\r\n\r\nsubmit.onclick = function() {  // post submit\r\nconst xmlhttp =new XMLHttpRequest();\r\n\txmlhttp.onreadystatechange=function()\r\n\t  {\r\n\t  if (xmlhttp.readyState==4 && xmlhttp.status==200)\r\n\t\t{\r\n\t\tdocument.getElementById(\"myDiv\").innerHTML=xmlhttp.responseText;\r\n\t\t}\r\n\t  }\r\nconst name = document.querySelector('input').value;\t  \r\nxmlhttp.open(\"POST\",\"/save_img/\"+name,true);\r\nxmlhttp.setRequestHeader(\"Content-type\",\"application/x-www-form-urlencoded\");\r\n// dataURL = dataURL.replaceAll(\"\\\\+\", \"%2B\");\r\ndataURL = encodeURIComponent(dataURL)\r\n    xmlhttp.send(\"img=\" + dataURL);\r\n}\r\n```\r\n\r\n```python\r\n\r\n@app.route('/save_img/<string:name>', methods=['POST', 'GET'])\r\ndef save_image(name):\r\n    # todo feature code\r\n    img_base64 = request.form.get(\"img\")\r\n    base64_data = re.sub('^data:image/.+;base64,', '', img_base64).encode()\r\n    feature_code = codec.func_call(base64_data, name)\r\n    # todo save img and name to db\r\n    data = Feature(feature_code, name)\r\n    db.session.add(data)\r\n    db.session.commit()\r\n    flash('successful!!')\r\n    return redirect(url_for('successful'))\r\n\r\n@app.route('/successful')\r\ndef successful():\r\n    return render_template('200.html')\r\n\r\n```\r\n\r\n### Actual Behavior\r\n\r\ncontent of index.html still remains in the page, and content in 200.html also show on the page.\r\n\r\n```pytb\r\nno exception\r\n```\r\n\r\n### Environment\r\n\r\n* Python version: 2.7.13\r\n* Flask version:1.0.2 and 0.12\r\n* Werkzeug version: 0.14.1\r\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/428862117",
            "html_url": "https://github.com/pallets/flask/issues/2938#issuecomment-428862117",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2938",
            "id": 428862117,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQyODg2MjExNw==",
            "user": {
                "login": "ThiefMaster",
                "id": 179599,
                "node_id": "MDQ6VXNlcjE3OTU5OQ==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/179599?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ThiefMaster",
                "html_url": "https://github.com/ThiefMaster",
                "followers_url": "https://api.github.com/users/ThiefMaster/followers",
                "following_url": "https://api.github.com/users/ThiefMaster/following{/other_user}",
                "gists_url": "https://api.github.com/users/ThiefMaster/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ThiefMaster/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ThiefMaster/subscriptions",
                "organizations_url": "https://api.github.com/users/ThiefMaster/orgs",
                "repos_url": "https://api.github.com/users/ThiefMaster/repos",
                "events_url": "https://api.github.com/users/ThiefMaster/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ThiefMaster/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-10-11T08:11:39Z",
            "updated_at": "2018-10-11T08:12:03Z",
            "author_association": "MEMBER",
            "body": "You cannot redirect from an AJAX request by sending a redirect status/header. Well, you can, but it will only affect the result of that request, and not redirect the page. Instead, return the URL as JSON data and then use JavaScript to redirect.\r\n\r\nAlso, use Stack Overflow or IRC for future questions that are about your own code."
        }
    ]
}