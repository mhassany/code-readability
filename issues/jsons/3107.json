{
    "url": "https://api.github.com/repos/pallets/flask/issues/3107",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/3107/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/3107/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/3107/events",
    "html_url": "https://github.com/pallets/flask/issues/3107",
    "id": 415641584,
    "node_id": "MDU6SXNzdWU0MTU2NDE1ODQ=",
    "number": 3107,
    "title": "Due of database access : \"Truncated or oversized response headers received from daemon process...\"",
    "user": {
        "login": "quoidautre",
        "id": 191692,
        "node_id": "MDQ6VXNlcjE5MTY5Mg==",
        "avatar_url": "https://avatars2.githubusercontent.com/u/191692?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/quoidautre",
        "html_url": "https://github.com/quoidautre",
        "followers_url": "https://api.github.com/users/quoidautre/followers",
        "following_url": "https://api.github.com/users/quoidautre/following{/other_user}",
        "gists_url": "https://api.github.com/users/quoidautre/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/quoidautre/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/quoidautre/subscriptions",
        "organizations_url": "https://api.github.com/users/quoidautre/orgs",
        "repos_url": "https://api.github.com/users/quoidautre/repos",
        "events_url": "https://api.github.com/users/quoidautre/events{/privacy}",
        "received_events_url": "https://api.github.com/users/quoidautre/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 4,
    "created_at": "2019-02-28T14:09:47Z",
    "updated_at": "2019-03-07T14:49:10Z",
    "closed_at": "2019-02-28T15:18:03Z",
    "author_association": "NONE",
    "body": "Hi,\r\n\r\nI've post this issue #3090, past days  but, for now, I've some news :). \r\n\r\nSo, I've the same error  ```Truncated or oversized response headers received from daemon process 'my_app': /var/www/python/flask/first_app/my_app/my_app.wsgi``` **when I access the database** !.\r\n\r\nIt's works when I comment the 2 lines of routes.py, and it's work when I use the _flask run --host=0.0.0.0 --port=5000_ command.\r\n\r\n```python\r\ndef index():\r\n    #d = Departement()\r\n    #query =  d.query.all()\r\n```\r\n\r\nHere the tree of my application : \r\n```shell\r\n$ tree ..\r\n..\r\n\u2514\u2500\u2500 first_app\r\n    \u251c\u2500\u2500 my_app\r\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 config.py\r\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 __init__.py\r\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 models.py\r\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 my_app.wsgi\r\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 routes.py\r\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 templates\r\n    \u2502\u00a0\u00a0     \u251c\u2500\u2500 base.html\r\n    \u2502\u00a0\u00a0     \u2514\u2500\u2500 index.html\r\n    \u2514\u2500\u2500 my_app.py\r\n\r\n```\r\n\r\n---\r\n\r\n#### __init__.py : \r\n```python\r\nfrom flask import Flask\r\nfrom config import Config\r\nfrom flask_sqlalchemy import SQLAlchemy\r\nfrom flask_migrate import Migrate\r\n\r\nmy_app = Flask(__name__)\r\nmy_app.config.from_object(Config)\r\n\r\ndb = SQLAlchemy(my_app)\r\nmigrate = Migrate(my_app, db)\r\n\r\nfrom my_app import routes,models\r\n```\r\n#### routes.py : \r\n```python\r\nfrom flask import render_template, flash, redirect, url_for\r\nfrom my_app import my_app\r\nfrom my_app.models import Departement\r\n\r\n@my_app.route('/')\r\n@my_app.route('/index')\r\ndef index():\r\n    d = Departement()\r\n    query =  d.query.all()\r\n    \r\n    return render_template('index.html', title='Home', departements=query)\r\n```\r\n#### my_app.py : \r\n```python\r\nfrom my_app import my_app\r\n```\r\n#### models.py : \r\n```python\r\nfrom my_app import db\r\n\r\nclass Departement(db.Model):\r\n    __tablename__ = \"departements\"\r\n    code_dept = db.Column(db.Integer, primary_key=True)\r\n    nom_dept = db.Column(db.String(50), index=True)\r\n    passwd \t= db.Column(db.String(50))\r\n    \r\n    def __repr__(self):\r\n        return '<Departement(s) : {0}, {1}, {2}>'.format(self.code_dept, self.nom_dept,self.passwd)    \r\n```\r\n#### config.py : \r\n```python\r\nimport os\r\nbasedir = os.path.abspath(os.path.dirname(__file__))\r\n\r\nclass Config(object):\r\n    SECRET_KEY = os.environ.get('SECRET_KEY') or 'you-will-never-guess'\r\n    \r\n    DATABASE_CONFIG = {\r\n        'username':'***',\r\n        'password':'***',\r\n        'host':'localhost',\r\n        'database':'***'\r\n        }\r\n\r\n    SQLALCHEMY_DATABASE_URI = 'postgresql+psycopg2://' + DATABASE_CONFIG['username'] + ':' + DATABASE_CONFIG['password'] + '@' + DATABASE_CONFIG['host'] + '/' + DATABASE_CONFIG['database']\r\n    SQLALCHEMY_TRACK_MODIFICATIONS = False\r\n``` \r\n#### my_app.wsgi : \r\n```python\r\nfrom my_app import my_app as application\r\n```\r\n#### The templates (for testing)\r\n\r\n#### base.html : \r\n```html\r\n<html>\r\n    <head>\r\n      {% if title %}\r\n      <title>{{ title }} - My App</title>\r\n      {% else %}\r\n      <title>Welcome to My App!</title>\r\n      {% endif %}\r\n    </head>\r\n    <body>\r\n        <div>App :: \r\n            <a href=\"{{ url_for('index') }}\">Home</a>\r\n        </div>\r\n        <hr>\r\n        {% with messages = get_flashed_messages() %}\r\n        {% if messages %}\r\n        <ul>\r\n            {% for message in messages %}\r\n            <li>{{ message }}</li>\r\n            {% endfor %}\r\n        </ul>\r\n        {% endif %}\r\n        {% endwith %}\r\n        {% block content %}{% endblock %}\r\n    </body>\r\n</html>\r\n``` \r\n#### index.html : \r\n```html\r\n{% extends \"base.html\" %}\r\n\r\n{% block content %}\r\n    {% for d in departements %}\r\n    <div><p>{{ d.code_dept }} => <b>{{ d.nom_dept }}</b></p></div>\r\n    {% endfor %}\r\n{% endblock %}\r\n```\r\n\r\n#### the vhost : \r\n\r\n```apache\r\n<VirtualHost *:80>\r\n      ServerName vm.basicflaskapp\r\n      DocumentRoot /var/www/python/flask/first_app\r\n      LogLevel info\r\n\r\n       WSGIDaemonProcess my_app user=www-data group=www-data python-path=/var/www/python/flask/first_app:/home/vagrant/.virtualenvs/first_app_flask/lib/python2.7/site-packages\r\n       WSGIScriptAlias / /var/www/python/flask/first_app/my_app/my_app.wsgi\r\n\r\n        <Directory /var/www/python/flask/first_app>\r\n            Require all granted\r\n        </Directory>\r\n\r\n        <Directory /var/www/python/flask/first_app/my_app>\r\n            WSGIProcessGroup my_app\r\n            WSGIApplicationGroup %{GLOBAL}\r\n            Require all granted\r\n        </Directory>\r\n\r\n        ErrorLog ${APACHE_LOG_DIR}/first_app_flask-error.log\r\n        CustomLog ${APACHE_LOG_DIR}/first_app_flask-access.log combined\r\n</VirtualHost>\r\n```\r\n\r\n### Actual Behavior\r\n\r\n```pytb\r\n[Thu Feb 28 14:34:43.850678 2019] [mpm_worker:notice] [pid 4932:tid 140038462543744] AH00297: SIGUSR1 received.  Doing graceful restart\r\n[Thu Feb 28 14:34:43.908680 2019] [wsgi:warn] [pid 4932:tid 140038462543744] mod_wsgi: Compiled for Python/2.7.11+.\r\n[Thu Feb 28 14:34:43.908700 2019] [wsgi:warn] [pid 4932:tid 140038462543744] mod_wsgi: Runtime using Python/2.7.12.\r\n[Thu Feb 28 14:34:43.909245 2019] [mpm_worker:notice] [pid 4932:tid 140038462543744] AH00292: Apache/2.4.38 (Ubuntu) OpenSSL/1.1.1a mod_wsgi/4.5.2 Python/2.7.12 configured -- resuming normal operations\r\n[Thu Feb 28 14:34:43.909293 2019] [core:notice] [pid 4932:tid 140038462543744] AH00094: Command line: '/usr/sbin/apache2'\r\n\r\n==> /var/log/apache2/first_app_flask-error.log <==\r\n[Thu Feb 28 14:34:43.924834 2019] [wsgi:info] [pid 20347:tid 140038462543744] mod_wsgi (pid=20347): Attach interpreter ''.\r\n[Thu Feb 28 14:34:43.925160 2019] [wsgi:info] [pid 20347:tid 140038462543744] mod_wsgi (pid=20347): Adding '/var/www/python/flask/first_app' to path.\r\n[Thu Feb 28 14:34:43.929157 2019] [wsgi:info] [pid 20347:tid 140038462543744] mod_wsgi (pid=20347): Adding '/home/vagrant/.virtualenvs/first_app_flask/lib/python2.7/site-packages' to path.\r\n[Thu Feb 28 14:34:45.846737 2019] [wsgi:info] [pid 20347:tid 140038331447040] [remote 192.168.56.1:0] mod_wsgi (pid=20347, process='my_app', application=''): Loading WSGI script '/var/www/python/flask/first_app/my_app/my_app.wsgi'.\r\n[Thu Feb 28 14:34:46.273215 2019] [wsgi:error] [pid 20347:tid 140038331447040] /home/vagrant/.virtualenvs/first_app_flask/lib/python2.7/site-packages/psycopg2/__init__.py:144: UserWarning: The psycopg2 wheel package will be renamed from release 2.8; in order to keep installing from binary please use \"pip install psycopg2-binary\" instead. For details see: <http://initd.org/psycopg/docs/install.html#binary-install-from-pypi>.\r\n[Thu Feb 28 14:34:46.273426 2019] [wsgi:error] [pid 20347:tid 140038331447040]   \"\"\")\r\n[Thu Feb 28 14:34:46.390437 2019] [wsgi:error] [pid 20350:tid 140038213990144] [client 192.168.56.1:29516] Truncated or oversized response headers received from daemon process 'my_app': /var/www/python/flask/first_app/my_app/my_app.wsgi\r\n\r\n==> /var/log/apache2/first_app_flask-access.log <==\r\n192.168.56.1 - - [28/Feb/2019:14:34:45 +0100] \"GET / HTTP/1.1\" 500 613 \"-\" \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:65.0) Gecko/20100101 Firefox/65.0\"\r\n\r\n==> /var/log/apache2/error.log <==\r\n[Thu Feb 28 14:34:46.912778 2019] [core:notice] [pid 4932:tid 140038462543744] AH00051: child pid 20347 exit signal Segmentation fault (11), possible coredump in /etc/apache2\r\n\r\n==> /var/log/apache2/first_app_flask-error.log <==\r\n[Thu Feb 28 14:34:46.919359 2019] [wsgi:info] [pid 20442:tid 140038462543744] mod_wsgi (pid=20442): Attach interpreter ''.\r\n[Thu Feb 28 14:34:46.919460 2019] [wsgi:info] [pid 20442:tid 140038462543744] mod_wsgi (pid=20442): Adding '/var/www/python/flask/first_app' to path.\r\n[Thu Feb 28 14:34:46.920621 2019] [wsgi:info] [pid 20442:tid 140038462543744] mod_wsgi (pid=20442): Adding '/home/vagrant/.virtualenvs/first_app_flask/lib/python2.7/site-packages' to path\r\n```\r\n\r\n### Environment\r\n\r\n```\r\n$ pip freeze\r\nalembic==1.0.7\r\nClick==7.0\r\nFlask==1.0.2\r\nFlask-Migrate==2.4.0\r\nFlask-SQLAlchemy==2.3.2\r\nFlask-WTF==0.14.2\r\nitsdangerous==1.1.0\r\nJinja2==2.10\r\nMako==1.0.7\r\nMarkupSafe==1.1.1\r\npsycopg2==2.7.7\r\npython-dateutil==2.8.0\r\npython-dotenv==0.10.1\r\npython-editor==1.0.4\r\nsix==1.12.0\r\nSQLAlchemy==1.2.18\r\nWerkzeug==0.14.1\r\nWTForms==2.2.1\r\n\r\n$ apachectl -v\r\nServer version: Apache/2.4.38 (Ubuntu)\r\nServer built:   2019-02-11T07:27:00\r\n\r\n$ uname -a\r\nLinux vm 4.4.0-45-generic #66-Ubuntu SMP Wed Oct 19 14:12:37 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\r\n\r\n$ cat /etc/lsb-release\r\nDISTRIB_ID=Ubuntu\r\nDISTRIB_RELEASE=16.04\r\nDISTRIB_CODENAME=xenial\r\nDISTRIB_DESCRIPTION=\"Ubuntu 16.04.6 LTS\"\r\n\r\n```\r\n\r\nHave you an idea please ? :)\r\n\r\nThanks\r\nF.",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/468311403",
            "html_url": "https://github.com/pallets/flask/issues/3107#issuecomment-468311403",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3107",
            "id": 468311403,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ2ODMxMTQwMw==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-02-28T15:18:03Z",
            "updated_at": "2019-02-28T15:18:03Z",
            "author_association": "MEMBER",
            "body": "I'm sorry, we still can't help with this. If you believe it to be an issue with Flask, you'll need to narrow it down to a minimal example demonstrating that the issue is with Flask. Given that `flask run`, and your app without db access don't cause the issue, this seems unlikely.\r\n\r\nPlease use Stack Overflow for questions about your own code. This tracker is for issues related to the project itself. Be sure to include a [minimal, complete, and verifiable example](https://stackoverflow.com/help/mcve)."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/468324405",
            "html_url": "https://github.com/pallets/flask/issues/3107#issuecomment-468324405",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3107",
            "id": 468324405,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ2ODMyNDQwNQ==",
            "user": {
                "login": "quoidautre",
                "id": 191692,
                "node_id": "MDQ6VXNlcjE5MTY5Mg==",
                "avatar_url": "https://avatars2.githubusercontent.com/u/191692?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/quoidautre",
                "html_url": "https://github.com/quoidautre",
                "followers_url": "https://api.github.com/users/quoidautre/followers",
                "following_url": "https://api.github.com/users/quoidautre/following{/other_user}",
                "gists_url": "https://api.github.com/users/quoidautre/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/quoidautre/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/quoidautre/subscriptions",
                "organizations_url": "https://api.github.com/users/quoidautre/orgs",
                "repos_url": "https://api.github.com/users/quoidautre/repos",
                "events_url": "https://api.github.com/users/quoidautre/events{/privacy}",
                "received_events_url": "https://api.github.com/users/quoidautre/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-02-28T15:50:59Z",
            "updated_at": "2019-02-28T15:50:59Z",
            "author_association": "NONE",
            "body": "The code I've joined is **verifiable**. All the files + the apache vhost."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/468489230",
            "html_url": "https://github.com/pallets/flask/issues/3107#issuecomment-468489230",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3107",
            "id": 468489230,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ2ODQ4OTIzMA==",
            "user": {
                "login": "ThiefMaster",
                "id": 179599,
                "node_id": "MDQ6VXNlcjE3OTU5OQ==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/179599?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ThiefMaster",
                "html_url": "https://github.com/ThiefMaster",
                "followers_url": "https://api.github.com/users/ThiefMaster/followers",
                "following_url": "https://api.github.com/users/ThiefMaster/following{/other_user}",
                "gists_url": "https://api.github.com/users/ThiefMaster/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ThiefMaster/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ThiefMaster/subscriptions",
                "organizations_url": "https://api.github.com/users/ThiefMaster/orgs",
                "repos_url": "https://api.github.com/users/ThiefMaster/repos",
                "events_url": "https://api.github.com/users/ThiefMaster/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ThiefMaster/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-03-01T00:03:28Z",
            "updated_at": "2019-03-01T00:03:28Z",
            "author_association": "MEMBER",
            "body": "Way too many files. A bug report like this should ideally have ONE python file and if needed a webserver config file - and if that's not an option at least have a cloneable git repo. But we're not going to copy&paste tons of files manually..."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/470554468",
            "html_url": "https://github.com/pallets/flask/issues/3107#issuecomment-470554468",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3107",
            "id": 470554468,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MDU1NDQ2OA==",
            "user": {
                "login": "quoidautre",
                "id": 191692,
                "node_id": "MDQ6VXNlcjE5MTY5Mg==",
                "avatar_url": "https://avatars2.githubusercontent.com/u/191692?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/quoidautre",
                "html_url": "https://github.com/quoidautre",
                "followers_url": "https://api.github.com/users/quoidautre/followers",
                "following_url": "https://api.github.com/users/quoidautre/following{/other_user}",
                "gists_url": "https://api.github.com/users/quoidautre/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/quoidautre/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/quoidautre/subscriptions",
                "organizations_url": "https://api.github.com/users/quoidautre/orgs",
                "repos_url": "https://api.github.com/users/quoidautre/repos",
                "events_url": "https://api.github.com/users/quoidautre/events{/privacy}",
                "received_events_url": "https://api.github.com/users/quoidautre/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-03-07T14:49:10Z",
            "updated_at": "2019-03-07T14:49:10Z",
            "author_association": "NONE",
            "body": "It's maybe useful to others, that my issue was fixed by desactivating the SSL support !!!, in postgresql.conf : \r\n```conf\r\n 80 ssl = off               # (change requires restart)\r\n```\r\nFabrice"
        }
    ]
}