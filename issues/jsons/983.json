{
    "url": "https://api.github.com/repos/pallets/flask/issues/983",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/983/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/983/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/983/events",
    "html_url": "https://github.com/pallets/flask/issues/983",
    "id": 27889719,
    "node_id": "MDU6SXNzdWUyNzg4OTcxOQ==",
    "number": 983,
    "title": "Can't customize url_for external links without causing 404 errors",
    "user": {
        "login": "hawicz",
        "id": 763777,
        "node_id": "MDQ6VXNlcjc2Mzc3Nw==",
        "avatar_url": "https://avatars1.githubusercontent.com/u/763777?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/hawicz",
        "html_url": "https://github.com/hawicz",
        "followers_url": "https://api.github.com/users/hawicz/followers",
        "following_url": "https://api.github.com/users/hawicz/following{/other_user}",
        "gists_url": "https://api.github.com/users/hawicz/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/hawicz/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/hawicz/subscriptions",
        "organizations_url": "https://api.github.com/users/hawicz/orgs",
        "repos_url": "https://api.github.com/users/hawicz/repos",
        "events_url": "https://api.github.com/users/hawicz/events{/privacy}",
        "received_events_url": "https://api.github.com/users/hawicz/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 6,
    "created_at": "2014-02-19T16:47:00Z",
    "updated_at": "2017-06-06T19:17:55Z",
    "closed_at": "2014-11-02T18:48:27Z",
    "author_association": "NONE",
    "body": "I have a server set up where there is a front-end web server (i.e. proxy) sitting in front of my Flask application.  Because of this, I need to be able to generate external links that have a different url than the actual requests coming to my Flask application.\ne.g. my app is running on http://foo.example.com:1234/, but url_for(..., _external=True) needs to generate things like \"https://some.other.com/\"\n\nThe suggested way of doing this, by changing SERVER_NAME, doesn't work because that is for both url_for() and by the underlying werkzeug routing code so changing it causes 404 errors.\n\nWould it be feasible to add an EXTERNAL_SERVER_NAME setting that is used instead?\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/35660758",
            "html_url": "https://github.com/pallets/flask/issues/983#issuecomment-35660758",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/983",
            "id": 35660758,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM1NjYwNzU4",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-02-20T19:42:24Z",
            "updated_at": "2014-02-20T19:44:12Z",
            "author_association": "MEMBER",
            "body": "I don't think so.\n\nLet's try to figure this out another way. So, i assume clients access your site via `http://some.other.com`, but your Flask app recieves requests which mention `http://foo.example.com:1234`. The usual way to deal with this situation is to employ middleware like the [`ProxyFix` included in Werkzeug](http://werkzeug.pocoo.org/docs/contrib/fixers/#werkzeug.contrib.fixers.ProxyFix), which is basically changing `HOST_NAME`. I have no idea where you got the `SERVER_NAME` thing from, and i wonder how a wrong host name could break your URL map assuming you don't use host name matching.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/35663987",
            "html_url": "https://github.com/pallets/flask/issues/983#issuecomment-35663987",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/983",
            "id": 35663987,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM1NjYzOTg3",
            "user": {
                "login": "bndr",
                "id": 1145456,
                "node_id": "MDQ6VXNlcjExNDU0NTY=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1145456?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/bndr",
                "html_url": "https://github.com/bndr",
                "followers_url": "https://api.github.com/users/bndr/followers",
                "following_url": "https://api.github.com/users/bndr/following{/other_user}",
                "gists_url": "https://api.github.com/users/bndr/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/bndr/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bndr/subscriptions",
                "organizations_url": "https://api.github.com/users/bndr/orgs",
                "repos_url": "https://api.github.com/users/bndr/repos",
                "events_url": "https://api.github.com/users/bndr/events{/privacy}",
                "received_events_url": "https://api.github.com/users/bndr/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-02-20T20:15:50Z",
            "updated_at": "2014-02-20T20:15:50Z",
            "author_association": "NONE",
            "body": "http://flask.pocoo.org/docs/api/#flask.url_for\n\n```\n_external \u2013 if set to True, an absolute URL is generated. \nServer address can be changed via SERVER_NAME configuration variable which defaults to localhost.\n```\n\nBut I actually don't understand how it's not working for you. I use Nginx as a Frontend proxy, that listens on port 80 on domain.com, and pass requests to gunicorn/Flask listening on `localhost:9000`, and have no problems with url_for()\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/37574421",
            "html_url": "https://github.com/pallets/flask/issues/983#issuecomment-37574421",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/983",
            "id": 37574421,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM3NTc0NDIx",
            "user": {
                "login": "DasIch",
                "id": 182316,
                "node_id": "MDQ6VXNlcjE4MjMxNg==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/182316?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/DasIch",
                "html_url": "https://github.com/DasIch",
                "followers_url": "https://api.github.com/users/DasIch/followers",
                "following_url": "https://api.github.com/users/DasIch/following{/other_user}",
                "gists_url": "https://api.github.com/users/DasIch/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/DasIch/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/DasIch/subscriptions",
                "organizations_url": "https://api.github.com/users/DasIch/orgs",
                "repos_url": "https://api.github.com/users/DasIch/repos",
                "events_url": "https://api.github.com/users/DasIch/events{/privacy}",
                "received_events_url": "https://api.github.com/users/DasIch/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-03-13T19:11:19Z",
            "updated_at": "2014-03-13T19:11:19Z",
            "author_association": "CONTRIBUTOR",
            "body": "Has the suggestion by @untitaker helped?\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/61418264",
            "html_url": "https://github.com/pallets/flask/issues/983#issuecomment-61418264",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/983",
            "id": 61418264,
            "node_id": "MDEyOklzc3VlQ29tbWVudDYxNDE4MjY0",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-11-02T18:48:26Z",
            "updated_at": "2014-11-02T18:48:26Z",
            "author_association": "MEMBER",
            "body": "Closing due to staleness.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/306497582",
            "html_url": "https://github.com/pallets/flask/issues/983#issuecomment-306497582",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/983",
            "id": 306497582,
            "node_id": "MDEyOklzc3VlQ29tbWVudDMwNjQ5NzU4Mg==",
            "user": {
                "login": "jamesratcliffe",
                "id": 20323342,
                "node_id": "MDQ6VXNlcjIwMzIzMzQy",
                "avatar_url": "https://avatars2.githubusercontent.com/u/20323342?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/jamesratcliffe",
                "html_url": "https://github.com/jamesratcliffe",
                "followers_url": "https://api.github.com/users/jamesratcliffe/followers",
                "following_url": "https://api.github.com/users/jamesratcliffe/following{/other_user}",
                "gists_url": "https://api.github.com/users/jamesratcliffe/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/jamesratcliffe/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jamesratcliffe/subscriptions",
                "organizations_url": "https://api.github.com/users/jamesratcliffe/orgs",
                "repos_url": "https://api.github.com/users/jamesratcliffe/repos",
                "events_url": "https://api.github.com/users/jamesratcliffe/events{/privacy}",
                "received_events_url": "https://api.github.com/users/jamesratcliffe/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-06-06T14:08:31Z",
            "updated_at": "2017-06-06T14:08:31Z",
            "author_association": "NONE",
            "body": "I had the same issue using nginx as my proxy. I fixed it by telling nginx to send a Host header. Minimal example:\r\n```\r\nserver {\r\n    listen 80;\r\n    server_name XXXXXX;\r\n\r\n    location / {\r\n        proxy_set_header Host $http_host; # <<<------ This\r\n        proxy_pass http://127.0.0.1:8000;\r\n    }\r\n}\r\n```"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/306589315",
            "html_url": "https://github.com/pallets/flask/issues/983#issuecomment-306589315",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/983",
            "id": 306589315,
            "node_id": "MDEyOklzc3VlQ29tbWVudDMwNjU4OTMxNQ==",
            "user": {
                "login": "jamesratcliffe",
                "id": 20323342,
                "node_id": "MDQ6VXNlcjIwMzIzMzQy",
                "avatar_url": "https://avatars2.githubusercontent.com/u/20323342?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/jamesratcliffe",
                "html_url": "https://github.com/jamesratcliffe",
                "followers_url": "https://api.github.com/users/jamesratcliffe/followers",
                "following_url": "https://api.github.com/users/jamesratcliffe/following{/other_user}",
                "gists_url": "https://api.github.com/users/jamesratcliffe/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/jamesratcliffe/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jamesratcliffe/subscriptions",
                "organizations_url": "https://api.github.com/users/jamesratcliffe/orgs",
                "repos_url": "https://api.github.com/users/jamesratcliffe/repos",
                "events_url": "https://api.github.com/users/jamesratcliffe/events{/privacy}",
                "received_events_url": "https://api.github.com/users/jamesratcliffe/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-06-06T19:17:55Z",
            "updated_at": "2017-06-06T19:17:55Z",
            "author_association": "NONE",
            "body": "See also http://flask.pocoo.org/docs/0.12/deploying/wsgi-standalone/#deploying-proxy-setups"
        }
    ]
}