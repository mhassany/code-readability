{
    "url": "https://api.github.com/repos/pallets/flask/issues/1360",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/1360/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/1360/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/1360/events",
    "html_url": "https://github.com/pallets/flask/pull/1360",
    "id": 59328724,
    "node_id": "MDExOlB1bGxSZXF1ZXN0MzAyMTk4MDM=",
    "number": 1360,
    "title": "Add exception details to response",
    "user": {
        "login": "keyan",
        "id": 6401746,
        "node_id": "MDQ6VXNlcjY0MDE3NDY=",
        "avatar_url": "https://avatars0.githubusercontent.com/u/6401746?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/keyan",
        "html_url": "https://github.com/keyan",
        "followers_url": "https://api.github.com/users/keyan/followers",
        "following_url": "https://api.github.com/users/keyan/following{/other_user}",
        "gists_url": "https://api.github.com/users/keyan/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/keyan/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/keyan/subscriptions",
        "organizations_url": "https://api.github.com/users/keyan/orgs",
        "repos_url": "https://api.github.com/users/keyan/repos",
        "events_url": "https://api.github.com/users/keyan/events{/privacy}",
        "received_events_url": "https://api.github.com/users/keyan/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 10,
    "created_at": "2015-02-28T06:30:53Z",
    "updated_at": "2018-10-23T17:43:32Z",
    "closed_at": "2015-03-05T19:59:12Z",
    "author_association": "MEMBER",
    "pull_request": {
        "url": "https://api.github.com/repos/pallets/flask/pulls/1360",
        "html_url": "https://github.com/pallets/flask/pull/1360",
        "diff_url": "https://github.com/pallets/flask/pull/1360.diff",
        "patch_url": "https://github.com/pallets/flask/pull/1360.patch"
    },
    "body": "This pull request is in regards to issue #1317. I reproduced the 400 error that kenjones-cisco was talking about using this code: gist.github.com/keyanp/bc4d1a3a1e6c5cb5170a\n\nSo I took a look at making a subclass of BadRequest, but indeed this is part of Werkzeug. So instead I was thinking of adding the ValueError content to the shell console or to the response body. By just adding the exception to the response body it at least improves the 400 message and probably will make it easier to debug. The response body (which is also in the gist above) would now look like:\n\n```\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 3.2 Final//EN\">\n<title>400 Bad Request</title>\n<h1>Bad Request</h1>\n<p>No JSON object could be decoded</p>\n```\n\nIf this isn't really that helpful perhaps I can just output the exception details to the console? Could someone point me in the direction of where in the codebase Flask handles console logging?\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/77208473",
            "html_url": "https://github.com/pallets/flask/pull/1360#issuecomment-77208473",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1360",
            "id": 77208473,
            "node_id": "MDEyOklzc3VlQ29tbWVudDc3MjA4NDcz",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-03-04T17:50:23Z",
            "updated_at": "2015-03-04T17:50:23Z",
            "author_association": "MEMBER",
            "body": "Looks pretty good, if you can manage, please also add tests (I can do that too if you don't have time)\n\nThanks!\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/77210587",
            "html_url": "https://github.com/pallets/flask/pull/1360#issuecomment-77210587",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1360",
            "id": 77210587,
            "node_id": "MDEyOklzc3VlQ29tbWVudDc3MjEwNTg3",
            "user": {
                "login": "keyan",
                "id": 6401746,
                "node_id": "MDQ6VXNlcjY0MDE3NDY=",
                "avatar_url": "https://avatars0.githubusercontent.com/u/6401746?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/keyan",
                "html_url": "https://github.com/keyan",
                "followers_url": "https://api.github.com/users/keyan/followers",
                "following_url": "https://api.github.com/users/keyan/following{/other_user}",
                "gists_url": "https://api.github.com/users/keyan/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/keyan/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/keyan/subscriptions",
                "organizations_url": "https://api.github.com/users/keyan/orgs",
                "repos_url": "https://api.github.com/users/keyan/repos",
                "events_url": "https://api.github.com/users/keyan/events{/privacy}",
                "received_events_url": "https://api.github.com/users/keyan/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-03-04T18:00:57Z",
            "updated_at": "2015-03-04T18:00:57Z",
            "author_association": "MEMBER",
            "body": "Sure I'll add tests, doesn't seem to be a consensus on checking for DEBUG setting though. Do you suggest using `_app_ctx_stack.top` similar to its use for `max_content_length`?\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/77211131",
            "html_url": "https://github.com/pallets/flask/pull/1360#issuecomment-77211131",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1360",
            "id": 77211131,
            "node_id": "MDEyOklzc3VlQ29tbWVudDc3MjExMTMx",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-03-04T18:03:39Z",
            "updated_at": "2015-03-04T18:03:39Z",
            "author_association": "MEMBER",
            "body": "> Do you suggest using _app_ctx_stack.top similar to its use for max_content_length?\n\nI was thinking about using `current_app` and catching RuntimeError, but using the stack directly as you say seems more consistent with the rest of the code.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/77230941",
            "html_url": "https://github.com/pallets/flask/pull/1360#issuecomment-77230941",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1360",
            "id": 77230941,
            "node_id": "MDEyOklzc3VlQ29tbWVudDc3MjMwOTQx",
            "user": {
                "login": "keyan",
                "id": 6401746,
                "node_id": "MDQ6VXNlcjY0MDE3NDY=",
                "avatar_url": "https://avatars0.githubusercontent.com/u/6401746?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/keyan",
                "html_url": "https://github.com/keyan",
                "followers_url": "https://api.github.com/users/keyan/followers",
                "following_url": "https://api.github.com/users/keyan/following{/other_user}",
                "gists_url": "https://api.github.com/users/keyan/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/keyan/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/keyan/subscriptions",
                "organizations_url": "https://api.github.com/users/keyan/orgs",
                "repos_url": "https://api.github.com/users/keyan/repos",
                "events_url": "https://api.github.com/users/keyan/events{/privacy}",
                "received_events_url": "https://api.github.com/users/keyan/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-03-04T19:43:10Z",
            "updated_at": "2015-03-04T19:45:12Z",
            "author_association": "MEMBER",
            "body": "EDIT: I'm trying to see why this is failing the Travis build...\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/77413848",
            "html_url": "https://github.com/pallets/flask/pull/1360#issuecomment-77413848",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1360",
            "id": 77413848,
            "node_id": "MDEyOklzc3VlQ29tbWVudDc3NDEzODQ4",
            "user": {
                "login": "keyan",
                "id": 6401746,
                "node_id": "MDQ6VXNlcjY0MDE3NDY=",
                "avatar_url": "https://avatars0.githubusercontent.com/u/6401746?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/keyan",
                "html_url": "https://github.com/keyan",
                "followers_url": "https://api.github.com/users/keyan/followers",
                "following_url": "https://api.github.com/users/keyan/following{/other_user}",
                "gists_url": "https://api.github.com/users/keyan/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/keyan/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/keyan/subscriptions",
                "organizations_url": "https://api.github.com/users/keyan/orgs",
                "repos_url": "https://api.github.com/users/keyan/repos",
                "events_url": "https://api.github.com/users/keyan/events{/privacy}",
                "received_events_url": "https://api.github.com/users/keyan/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-03-05T17:55:22Z",
            "updated_at": "2015-03-05T17:55:22Z",
            "author_association": "MEMBER",
            "body": "@untitaker Thanks for looking over the previous commits. I ended up added a couple tests and changed the logic to use `_app_ctx_stack` similar to `max_content_length`.\n\nThe issue I was running into with the tests was that Python 3.4 throws a different exception message for trying to load data from an empty json, and so I ended up hardcoding the exception details. I'm not sure how you feel about that, but I think since the function `on_json_loading_failed` is only being called in this specific instance it should be safe to pass a string manually. Let me know your thoughts.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/77414335",
            "html_url": "https://github.com/pallets/flask/pull/1360#issuecomment-77414335",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1360",
            "id": 77414335,
            "node_id": "MDEyOklzc3VlQ29tbWVudDc3NDE0MzM1",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-03-05T17:57:58Z",
            "updated_at": "2015-03-05T17:57:58Z",
            "author_association": "MEMBER",
            "body": "It's true, it's easier for assertion for the error message to be consistent. This can be achieved with `BadRequest('Failed to decode JSON object: {}'.format(e))` too, though.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/77415930",
            "html_url": "https://github.com/pallets/flask/pull/1360#issuecomment-77415930",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1360",
            "id": 77415930,
            "node_id": "MDEyOklzc3VlQ29tbWVudDc3NDE1OTMw",
            "user": {
                "login": "keyan",
                "id": 6401746,
                "node_id": "MDQ6VXNlcjY0MDE3NDY=",
                "avatar_url": "https://avatars0.githubusercontent.com/u/6401746?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/keyan",
                "html_url": "https://github.com/keyan",
                "followers_url": "https://api.github.com/users/keyan/followers",
                "following_url": "https://api.github.com/users/keyan/following{/other_user}",
                "gists_url": "https://api.github.com/users/keyan/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/keyan/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/keyan/subscriptions",
                "organizations_url": "https://api.github.com/users/keyan/orgs",
                "repos_url": "https://api.github.com/users/keyan/repos",
                "events_url": "https://api.github.com/users/keyan/events{/privacy}",
                "received_events_url": "https://api.github.com/users/keyan/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-03-05T18:06:18Z",
            "updated_at": "2015-03-05T18:06:38Z",
            "author_association": "MEMBER",
            "body": "Changed so that the response content for Python 3.3 and below (in DEBUG mode) is now: \n\n`Failed to decode JSON object: No JSON object could be decoded`\n\nWhile for Python 3.4 it is:\n\n`Failed to decode JSON object: Expecting value: line 1 column 1 (char 0)`\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/77418634",
            "html_url": "https://github.com/pallets/flask/pull/1360#issuecomment-77418634",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1360",
            "id": 77418634,
            "node_id": "MDEyOklzc3VlQ29tbWVudDc3NDE4NjM0",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-03-05T18:20:38Z",
            "updated_at": "2015-03-05T18:20:38Z",
            "author_association": "MEMBER",
            "body": "For some miraculous reason we now leak the request context... will look into this later.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/77420916",
            "html_url": "https://github.com/pallets/flask/pull/1360#issuecomment-77420916",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1360",
            "id": 77420916,
            "node_id": "MDEyOklzc3VlQ29tbWVudDc3NDIwOTE2",
            "user": {
                "login": "keyan",
                "id": 6401746,
                "node_id": "MDQ6VXNlcjY0MDE3NDY=",
                "avatar_url": "https://avatars0.githubusercontent.com/u/6401746?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/keyan",
                "html_url": "https://github.com/keyan",
                "followers_url": "https://api.github.com/users/keyan/followers",
                "following_url": "https://api.github.com/users/keyan/following{/other_user}",
                "gists_url": "https://api.github.com/users/keyan/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/keyan/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/keyan/subscriptions",
                "organizations_url": "https://api.github.com/users/keyan/orgs",
                "repos_url": "https://api.github.com/users/keyan/repos",
                "events_url": "https://api.github.com/users/keyan/events{/privacy}",
                "received_events_url": "https://api.github.com/users/keyan/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-03-05T18:30:10Z",
            "updated_at": "2015-03-05T18:30:10Z",
            "author_association": "MEMBER",
            "body": "Yeah I'm not sure why the request context was being leaked, but the error I was getting was specific to formatting strings in Python 2.6, where you are required to provide an index for arguments. Build looks good now though, and I incorporated the changes you commented on.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/77439666",
            "html_url": "https://github.com/pallets/flask/pull/1360#issuecomment-77439666",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1360",
            "id": 77439666,
            "node_id": "MDEyOklzc3VlQ29tbWVudDc3NDM5NjY2",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-03-05T19:59:17Z",
            "updated_at": "2015-03-05T19:59:17Z",
            "author_association": "MEMBER",
            "body": "Excellent, thanks!\n"
        }
    ]
}