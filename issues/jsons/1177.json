{
    "url": "https://api.github.com/repos/pallets/flask/issues/1177",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/1177/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/1177/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/1177/events",
    "html_url": "https://github.com/pallets/flask/issues/1177",
    "id": 42894221,
    "node_id": "MDU6SXNzdWU0Mjg5NDIyMQ==",
    "number": 1177,
    "title": "Should jsonify() throw an exception when provided a list?",
    "user": {
        "login": "jgehrcke",
        "id": 265630,
        "node_id": "MDQ6VXNlcjI2NTYzMA==",
        "avatar_url": "https://avatars0.githubusercontent.com/u/265630?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jgehrcke",
        "html_url": "https://github.com/jgehrcke",
        "followers_url": "https://api.github.com/users/jgehrcke/followers",
        "following_url": "https://api.github.com/users/jgehrcke/following{/other_user}",
        "gists_url": "https://api.github.com/users/jgehrcke/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/jgehrcke/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jgehrcke/subscriptions",
        "organizations_url": "https://api.github.com/users/jgehrcke/orgs",
        "repos_url": "https://api.github.com/users/jgehrcke/repos",
        "events_url": "https://api.github.com/users/jgehrcke/events{/privacy}",
        "received_events_url": "https://api.github.com/users/jgehrcke/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": true,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 8,
    "created_at": "2014-09-16T15:18:51Z",
    "updated_at": "2014-10-19T22:35:40Z",
    "closed_at": "2014-10-19T22:35:40Z",
    "author_association": "NONE",
    "body": "Consider `jsonify()`cation of a dictionary contained in a list:\n\n``` python\nprint flask.__version__\nprint repr(flask.jsonify([{\"a\": 1, \"b\": 2}]).data)\n```\n\nWith the following output:\n\n``` python\n0.10.1\n'{\\n  \"a\": \"b\"\\n}'\n```\n\n`jsonify()` has -- without complaining -- mangled the data into something really not useful: The original dictionary values are gone, and the `\"b\"` key suddenly is a value.\n\nI appreciate that top-level array elements are not allowed to be created in Flask's `jsonify()` implementation (http://flask.pocoo.org/docs/0.10/security/#json-security). Also, there are for sure straight-forward strategies for solving this in application code, for example by wrapping the list in a dictionary: `jsonify({\"items\": collection})`.\n\nHowever, in the Python world we do not find it very often that an entity accepts invalid input and produces garbled output without complaining. Also, it looks like `jsonify()` once raised an exception when provided a list (at least in 2011 it did raise a `TypeError`: https://github.com/mitsuhiko/flask/issues/170).\n\nShould we raise an exception again or is the current behavior carefully designed with a focus on performance? I mean, it is unlikely that this data mangling ends up in a production environment (a developer really should realize that `jsonify()` produces garbage in this case , like I did).\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/55761871",
            "html_url": "https://github.com/pallets/flask/issues/1177#issuecomment-55761871",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1177",
            "id": 55761871,
            "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzYxODcx",
            "user": {
                "login": "danielchatfield",
                "id": 1058676,
                "node_id": "MDQ6VXNlcjEwNTg2NzY=",
                "avatar_url": "https://avatars3.githubusercontent.com/u/1058676?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/danielchatfield",
                "html_url": "https://github.com/danielchatfield",
                "followers_url": "https://api.github.com/users/danielchatfield/followers",
                "following_url": "https://api.github.com/users/danielchatfield/following{/other_user}",
                "gists_url": "https://api.github.com/users/danielchatfield/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/danielchatfield/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/danielchatfield/subscriptions",
                "organizations_url": "https://api.github.com/users/danielchatfield/orgs",
                "repos_url": "https://api.github.com/users/danielchatfield/repos",
                "events_url": "https://api.github.com/users/danielchatfield/events{/privacy}",
                "received_events_url": "https://api.github.com/users/danielchatfield/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-09-16T15:34:27Z",
            "updated_at": "2014-09-16T15:34:27Z",
            "author_association": "NONE",
            "body": "https://github.com/mitsuhiko/flask/issues/673\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/55762253",
            "html_url": "https://github.com/pallets/flask/issues/1177#issuecomment-55762253",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1177",
            "id": 55762253,
            "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzYyMjUz",
            "user": {
                "login": "danielchatfield",
                "id": 1058676,
                "node_id": "MDQ6VXNlcjEwNTg2NzY=",
                "avatar_url": "https://avatars3.githubusercontent.com/u/1058676?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/danielchatfield",
                "html_url": "https://github.com/danielchatfield",
                "followers_url": "https://api.github.com/users/danielchatfield/followers",
                "following_url": "https://api.github.com/users/danielchatfield/following{/other_user}",
                "gists_url": "https://api.github.com/users/danielchatfield/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/danielchatfield/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/danielchatfield/subscriptions",
                "organizations_url": "https://api.github.com/users/danielchatfield/orgs",
                "repos_url": "https://api.github.com/users/danielchatfield/repos",
                "events_url": "https://api.github.com/users/danielchatfield/events{/privacy}",
                "received_events_url": "https://api.github.com/users/danielchatfield/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-09-16T15:36:43Z",
            "updated_at": "2014-09-16T15:36:43Z",
            "author_association": "NONE",
            "body": "As I stated in above issue I'm all for removing this restriction - the browsers affected by the security bug are now really really old (IE5, firefox 2 etc.) and all have unfixed remote code execution bugs anyway.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/58563037",
            "html_url": "https://github.com/pallets/flask/issues/1177#issuecomment-58563037",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1177",
            "id": 58563037,
            "node_id": "MDEyOklzc3VlQ29tbWVudDU4NTYzMDM3",
            "user": {
                "login": "hockeybuggy",
                "id": 607279,
                "node_id": "MDQ6VXNlcjYwNzI3OQ==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/607279?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/hockeybuggy",
                "html_url": "https://github.com/hockeybuggy",
                "followers_url": "https://api.github.com/users/hockeybuggy/followers",
                "following_url": "https://api.github.com/users/hockeybuggy/following{/other_user}",
                "gists_url": "https://api.github.com/users/hockeybuggy/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/hockeybuggy/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/hockeybuggy/subscriptions",
                "organizations_url": "https://api.github.com/users/hockeybuggy/orgs",
                "repos_url": "https://api.github.com/users/hockeybuggy/repos",
                "events_url": "https://api.github.com/users/hockeybuggy/events{/privacy}",
                "received_events_url": "https://api.github.com/users/hockeybuggy/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-10-09T19:21:02Z",
            "updated_at": "2014-10-09T19:23:23Z",
            "author_association": "NONE",
            "body": "Using flask 0.10.1 I was able to raise the same `TypeError` as #170. So it still has the same behaveior as 2011.\n\n```\nTypeError: cannot convert dictionary update sequence element #0 to a sequence\n```\n\nTo add garbleing behavior of `jsonify`:\n\n```\na1 = [{\"a\":1}]\na2 = [{\"a\":1, \"b\":2}]\na3 = [{\"a\":1, \"b\":2, \"c\":3}]\n```\n\nonly `a2` produces the garbled you describe when passed to `jsonify` (regardless of the key value). `a1` and `a3` throw the same `TypeError` as above.\n\nIn the context of allowing top-level lists to `jsonify` I currently have no opinion.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/59657832",
            "html_url": "https://github.com/pallets/flask/issues/1177#issuecomment-59657832",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1177",
            "id": 59657832,
            "node_id": "MDEyOklzc3VlQ29tbWVudDU5NjU3ODMy",
            "user": {
                "login": "duaneking",
                "id": 569341,
                "node_id": "MDQ6VXNlcjU2OTM0MQ==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/569341?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/duaneking",
                "html_url": "https://github.com/duaneking",
                "followers_url": "https://api.github.com/users/duaneking/followers",
                "following_url": "https://api.github.com/users/duaneking/following{/other_user}",
                "gists_url": "https://api.github.com/users/duaneking/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/duaneking/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/duaneking/subscriptions",
                "organizations_url": "https://api.github.com/users/duaneking/orgs",
                "repos_url": "https://api.github.com/users/duaneking/repos",
                "events_url": "https://api.github.com/users/duaneking/events{/privacy}",
                "received_events_url": "https://api.github.com/users/duaneking/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-10-19T17:47:16Z",
            "updated_at": "2014-10-19T17:47:16Z",
            "author_association": "NONE",
            "body": "If I submit a patch that removes this restriction and allows the developer to be productive by accepting lists, will it be accepted?\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/59658017",
            "html_url": "https://github.com/pallets/flask/issues/1177#issuecomment-59658017",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1177",
            "id": 59658017,
            "node_id": "MDEyOklzc3VlQ29tbWVudDU5NjU4MDE3",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-10-19T17:52:03Z",
            "updated_at": "2014-10-19T17:52:03Z",
            "author_association": "MEMBER",
            "body": "@duaneking sure\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/59658450",
            "html_url": "https://github.com/pallets/flask/issues/1177#issuecomment-59658450",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1177",
            "id": 59658450,
            "node_id": "MDEyOklzc3VlQ29tbWVudDU5NjU4NDUw",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-10-19T18:03:42Z",
            "updated_at": "2014-10-19T18:03:42Z",
            "author_association": "MEMBER",
            "body": "Actually, i need to expand on this and paddle back: as mentioned in #673, any patches for improving the error message are always welcomed and will be merged. I think we agreed in that issue that we should remove the restriction, however, since @mitsuhiko introduced that restriction, i think you should negotiate this with him if this is going to land in 1.0\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/59659078",
            "html_url": "https://github.com/pallets/flask/issues/1177#issuecomment-59659078",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1177",
            "id": 59659078,
            "node_id": "MDEyOklzc3VlQ29tbWVudDU5NjU5MDc4",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-10-19T18:19:42Z",
            "updated_at": "2014-10-19T18:19:42Z",
            "author_association": "MEMBER",
            "body": "Hah, actually this seems to be a duplicate of #248.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/59668689",
            "html_url": "https://github.com/pallets/flask/issues/1177#issuecomment-59668689",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1177",
            "id": 59668689,
            "node_id": "MDEyOklzc3VlQ29tbWVudDU5NjY4Njg5",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-10-19T22:35:40Z",
            "updated_at": "2014-10-19T22:35:40Z",
            "author_association": "MEMBER",
            "body": "Closing this in favor of #248, please continue discussion there.\n"
        }
    ]
}