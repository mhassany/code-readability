{
    "url": "https://api.github.com/repos/pallets/flask/issues/1591",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/1591/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/1591/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/1591/events",
    "html_url": "https://github.com/pallets/flask/issues/1591",
    "id": 112725695,
    "node_id": "MDU6SXNzdWUxMTI3MjU2OTU=",
    "number": 1591,
    "title": "Example code leaked when running test",
    "user": {
        "login": "shulhi",
        "id": 913103,
        "node_id": "MDQ6VXNlcjkxMzEwMw==",
        "avatar_url": "https://avatars1.githubusercontent.com/u/913103?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/shulhi",
        "html_url": "https://github.com/shulhi",
        "followers_url": "https://api.github.com/users/shulhi/followers",
        "following_url": "https://api.github.com/users/shulhi/following{/other_user}",
        "gists_url": "https://api.github.com/users/shulhi/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/shulhi/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/shulhi/subscriptions",
        "organizations_url": "https://api.github.com/users/shulhi/orgs",
        "repos_url": "https://api.github.com/users/shulhi/repos",
        "events_url": "https://api.github.com/users/shulhi/events{/privacy}",
        "received_events_url": "https://api.github.com/users/shulhi/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": {
        "login": "mitsuhiko",
        "id": 7396,
        "node_id": "MDQ6VXNlcjczOTY=",
        "avatar_url": "https://avatars1.githubusercontent.com/u/7396?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mitsuhiko",
        "html_url": "https://github.com/mitsuhiko",
        "followers_url": "https://api.github.com/users/mitsuhiko/followers",
        "following_url": "https://api.github.com/users/mitsuhiko/following{/other_user}",
        "gists_url": "https://api.github.com/users/mitsuhiko/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/mitsuhiko/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/mitsuhiko/subscriptions",
        "organizations_url": "https://api.github.com/users/mitsuhiko/orgs",
        "repos_url": "https://api.github.com/users/mitsuhiko/repos",
        "events_url": "https://api.github.com/users/mitsuhiko/events{/privacy}",
        "received_events_url": "https://api.github.com/users/mitsuhiko/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "mitsuhiko",
            "id": 7396,
            "node_id": "MDQ6VXNlcjczOTY=",
            "avatar_url": "https://avatars1.githubusercontent.com/u/7396?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/mitsuhiko",
            "html_url": "https://github.com/mitsuhiko",
            "followers_url": "https://api.github.com/users/mitsuhiko/followers",
            "following_url": "https://api.github.com/users/mitsuhiko/following{/other_user}",
            "gists_url": "https://api.github.com/users/mitsuhiko/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/mitsuhiko/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/mitsuhiko/subscriptions",
            "organizations_url": "https://api.github.com/users/mitsuhiko/orgs",
            "repos_url": "https://api.github.com/users/mitsuhiko/repos",
            "events_url": "https://api.github.com/users/mitsuhiko/events{/privacy}",
            "received_events_url": "https://api.github.com/users/mitsuhiko/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 9,
    "created_at": "2015-10-22T03:45:14Z",
    "updated_at": "2016-05-22T13:06:41Z",
    "closed_at": "2016-05-22T10:21:32Z",
    "author_association": "NONE",
    "body": "Running `py.test` leads to \n\n```\ntests/test_regression.py:72:\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <test_regression.assert_no_leak object at 0x104105550>, exc_type = None, exc_value = None, tb = None\n\n    def __exit__(self, exc_type, exc_value, tb):\n        if not hasattr(sys, 'getrefcount'):\n            gc.collect()\n        new_objects = len(gc.get_objects())\n        if new_objects > self.old_objects:\n>           pytest.fail('Example code leaked')\nE           Failed: Example code leaked\n```\n\nI think this is an old issue (#452). I run the test on both CPython 2.7.8 and 3.5.0, and it failed on both occasions.\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/152865288",
            "html_url": "https://github.com/pallets/flask/issues/1591#issuecomment-152865288",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1591",
            "id": 152865288,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE1Mjg2NTI4OA==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-11-01T21:30:03Z",
            "updated_at": "2015-11-01T21:30:03Z",
            "author_association": "MEMBER",
            "body": "This seems to fail if the `redbaron` package isn't installed.  If you run the full test suite with `tox`, or install the required libraries before running `py.test`, this doesn't happen.  I have no idea why though, nothing that test does uses that library.  Ping @mitsuhiko.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/152877977",
            "html_url": "https://github.com/pallets/flask/issues/1591#issuecomment-152877977",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1591",
            "id": 152877977,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE1Mjg3Nzk3Nw==",
            "user": {
                "login": "shulhi",
                "id": 913103,
                "node_id": "MDQ6VXNlcjkxMzEwMw==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/913103?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/shulhi",
                "html_url": "https://github.com/shulhi",
                "followers_url": "https://api.github.com/users/shulhi/followers",
                "following_url": "https://api.github.com/users/shulhi/following{/other_user}",
                "gists_url": "https://api.github.com/users/shulhi/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/shulhi/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shulhi/subscriptions",
                "organizations_url": "https://api.github.com/users/shulhi/orgs",
                "repos_url": "https://api.github.com/users/shulhi/repos",
                "events_url": "https://api.github.com/users/shulhi/events{/privacy}",
                "received_events_url": "https://api.github.com/users/shulhi/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-11-01T23:44:54Z",
            "updated_at": "2015-11-01T23:44:54Z",
            "author_association": "NONE",
            "body": "@davidism I have `redbaron` installed though.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/152901145",
            "html_url": "https://github.com/pallets/flask/issues/1591#issuecomment-152901145",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1591",
            "id": 152901145,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE1MjkwMTE0NQ==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-11-02T03:18:25Z",
            "updated_at": "2015-11-02T03:18:25Z",
            "author_association": "MEMBER",
            "body": "Running `tox` still fails for you?  Everything passes for me, and it seems like recent Travis builds are passing as well.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/152999464",
            "html_url": "https://github.com/pallets/flask/issues/1591#issuecomment-152999464",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1591",
            "id": 152999464,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE1Mjk5OTQ2NA==",
            "user": {
                "login": "shulhi",
                "id": 913103,
                "node_id": "MDQ6VXNlcjkxMzEwMw==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/913103?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/shulhi",
                "html_url": "https://github.com/shulhi",
                "followers_url": "https://api.github.com/users/shulhi/followers",
                "following_url": "https://api.github.com/users/shulhi/following{/other_user}",
                "gists_url": "https://api.github.com/users/shulhi/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/shulhi/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/shulhi/subscriptions",
                "organizations_url": "https://api.github.com/users/shulhi/orgs",
                "repos_url": "https://api.github.com/users/shulhi/repos",
                "events_url": "https://api.github.com/users/shulhi/events{/privacy}",
                "received_events_url": "https://api.github.com/users/shulhi/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-11-02T12:06:27Z",
            "updated_at": "2015-11-02T12:06:27Z",
            "author_association": "NONE",
            "body": "Running with `tox` passes all the tests. Weird though.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/153022251",
            "html_url": "https://github.com/pallets/flask/issues/1591#issuecomment-153022251",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1591",
            "id": 153022251,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE1MzAyMjI1MQ==",
            "user": {
                "login": "mitsuhiko",
                "id": 7396,
                "node_id": "MDQ6VXNlcjczOTY=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/7396?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/mitsuhiko",
                "html_url": "https://github.com/mitsuhiko",
                "followers_url": "https://api.github.com/users/mitsuhiko/followers",
                "following_url": "https://api.github.com/users/mitsuhiko/following{/other_user}",
                "gists_url": "https://api.github.com/users/mitsuhiko/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/mitsuhiko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mitsuhiko/subscriptions",
                "organizations_url": "https://api.github.com/users/mitsuhiko/orgs",
                "repos_url": "https://api.github.com/users/mitsuhiko/repos",
                "events_url": "https://api.github.com/users/mitsuhiko/events{/privacy}",
                "received_events_url": "https://api.github.com/users/mitsuhiko/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-11-02T13:51:19Z",
            "updated_at": "2015-11-02T13:51:19Z",
            "author_association": "MEMBER",
            "body": "I really just want to remove this test.  It's so unreliable.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/159998434",
            "html_url": "https://github.com/pallets/flask/issues/1591#issuecomment-159998434",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1591",
            "id": 159998434,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE1OTk5ODQzNA==",
            "user": {
                "login": "redian",
                "id": 816941,
                "node_id": "MDQ6VXNlcjgxNjk0MQ==",
                "avatar_url": "https://avatars2.githubusercontent.com/u/816941?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/redian",
                "html_url": "https://github.com/redian",
                "followers_url": "https://api.github.com/users/redian/followers",
                "following_url": "https://api.github.com/users/redian/following{/other_user}",
                "gists_url": "https://api.github.com/users/redian/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/redian/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/redian/subscriptions",
                "organizations_url": "https://api.github.com/users/redian/orgs",
                "repos_url": "https://api.github.com/users/redian/repos",
                "events_url": "https://api.github.com/users/redian/events{/privacy}",
                "received_events_url": "https://api.github.com/users/redian/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-11-26T22:04:52Z",
            "updated_at": "2015-11-26T22:04:52Z",
            "author_association": "CONTRIBUTOR",
            "body": "This test fails for me too: \n\n```\nself = <test_regression.assert_no_leak object at 0x1041a3630>, exc_type = None, exc_value = None, tb = None\n\n    def __exit__(self, exc_type, exc_value, tb):\n        if not hasattr(sys, 'getrefcount'):\n            gc.collect()\n        new_objects = len(gc.get_objects())\n        if new_objects > self.old_objects:\n>           pytest.fail('Example code leaked')\nE           Failed: Example code leaked\n\ntests/test_regression.py:46: Failed\n```\n\nHere are my virtual environment packages installed:\n\n```\nconda list\n# packages in environment at /Users/redian/miniconda3/envs/flask:\n#\nappdirs                   1.4.0                     <pip>\nbaron                     0.6.1                     <pip>\nclick                     6.0                       <pip>\nflask                     0.10.1                    <pip>\nitsdangerous              0.24                      <pip>\njinja2                    2.8                       <pip>\nmarkupsafe                0.23                      <pip>\nopenssl                   1.0.2d                        0  \npip                       7.1.2                    py34_0  \npy                        1.4.30                    <pip>\npygments                  2.0.2                     <pip>\npytest                    2.8.3                     <pip>\npython                    3.4.3                         2  \nreadline                  6.2                           2  \nrply                      0.7.4                     <pip>\nsetuptools                18.5                     py34_0  \nsqlite                    3.8.4.1                       1  \ntk                        8.5.18                        0  \nwerkzeug                  0.11.2                    <pip>\nwheel                     0.26.0                   py34_1  \nxz                        5.0.5                         0  \nzlib                      1.2.8                         0  \n```\n\nCan we do something about this.\n\nI read the comment on like 67 mentioning that this test works only on python 2.7 \n\n```\n    # This test only works on CPython 2.7.\n    if sys.version_info >= (2, 7) and \\\n            not hasattr(sys, 'pypy_translation_info'):\n        with assert_no_leak():\n            for x in range(10):\n                fire()\n```\n\ncan we change the `>=` operator to `==` instead ?\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/160047796",
            "html_url": "https://github.com/pallets/flask/issues/1591#issuecomment-160047796",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1591",
            "id": 160047796,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE2MDA0Nzc5Ng==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-11-27T05:38:56Z",
            "updated_at": "2015-11-27T05:38:56Z",
            "author_association": "MEMBER",
            "body": "As I indicated above, this test works for me on versions greater than 2.7, but is unreliable depending on the environment.  We could put this test behind a [pytest option](http://pytest.org/latest/example/simple.html#control-skipping-of-tests-according-to-command-line-option), or as @mitsuhiko suggested just remove it.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/220824860",
            "html_url": "https://github.com/pallets/flask/issues/1591#issuecomment-220824860",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1591",
            "id": 220824860,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIyMDgyNDg2MA==",
            "user": {
                "login": "mitsuhiko",
                "id": 7396,
                "node_id": "MDQ6VXNlcjczOTY=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/7396?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/mitsuhiko",
                "html_url": "https://github.com/mitsuhiko",
                "followers_url": "https://api.github.com/users/mitsuhiko/followers",
                "following_url": "https://api.github.com/users/mitsuhiko/following{/other_user}",
                "gists_url": "https://api.github.com/users/mitsuhiko/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/mitsuhiko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mitsuhiko/subscriptions",
                "organizations_url": "https://api.github.com/users/mitsuhiko/orgs",
                "repos_url": "https://api.github.com/users/mitsuhiko/repos",
                "events_url": "https://api.github.com/users/mitsuhiko/events{/privacy}",
                "received_events_url": "https://api.github.com/users/mitsuhiko/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-05-22T10:21:32Z",
            "updated_at": "2016-05-22T10:21:32Z",
            "author_association": "MEMBER",
            "body": "I force the garbage collection for that test now. This should solve this anyways.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/220831452",
            "html_url": "https://github.com/pallets/flask/issues/1591#issuecomment-220831452",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1591",
            "id": 220831452,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIyMDgzMTQ1Mg==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-05-22T13:06:41Z",
            "updated_at": "2016-05-22T13:06:41Z",
            "author_association": "MEMBER",
            "body": "883cb7cedcc23efbb7e73f8884df8f406e452541\n"
        }
    ]
}