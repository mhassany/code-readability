{
    "url": "https://api.github.com/repos/pallets/flask/issues/2428",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/2428/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/2428/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/2428/events",
    "html_url": "https://github.com/pallets/flask/issues/2428",
    "id": 245898779,
    "node_id": "MDU6SXNzdWUyNDU4OTg3Nzk=",
    "number": 2428,
    "title": "Werid behaviour of BuildError",
    "user": {
        "login": "greyli",
        "id": 12967000,
        "node_id": "MDQ6VXNlcjEyOTY3MDAw",
        "avatar_url": "https://avatars3.githubusercontent.com/u/12967000?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/greyli",
        "html_url": "https://github.com/greyli",
        "followers_url": "https://api.github.com/users/greyli/followers",
        "following_url": "https://api.github.com/users/greyli/following{/other_user}",
        "gists_url": "https://api.github.com/users/greyli/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/greyli/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/greyli/subscriptions",
        "organizations_url": "https://api.github.com/users/greyli/orgs",
        "repos_url": "https://api.github.com/users/greyli/repos",
        "events_url": "https://api.github.com/users/greyli/events{/privacy}",
        "received_events_url": "https://api.github.com/users/greyli/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 2,
    "created_at": "2017-07-27T01:17:36Z",
    "updated_at": "2017-07-27T02:20:55Z",
    "closed_at": "2017-07-27T02:20:54Z",
    "author_association": "MEMBER",
    "body": "### Expected Behaviour\r\n\r\nI register a route to serve avatar image directly on `app`:\r\n```python\r\n@app.route('/avatar/<filename>/<size>')\r\ndef avatar(filename, size='m'):\r\n    path = current_app.config['AVATARS_UPLOAD_PATH']\r\n    filename = '%s_%s.png' % (filename, size)\r\n    return send_from_directory(path, filename)\r\n```\r\nThen I use this in template to get avatar:\r\n```jinja\r\n{{ url_for('avatar', filename=user.avatar, size='l') }}\r\n```\r\n\r\n### Actual Behaviour\r\n\r\nI have four templates use this code, but only one template got the image, others got the error below:\r\n```pytb\r\nBuildError: Could not build url for endpoint 'avatar' with values ['size']. Did you forget to specify values ['filename']?\r\n...\r\nFile \"C:\\Users\\Administrator\\projects\\moments-dev\\moments\\templates\\home\\index.html\", line 16, in block \"page_content\"\r\nsrc=\"{{ url_for('avatar', filename=photo.author.avatar, size='s') }}\">\r\nFile \"c:\\users\\administrator\\projects\\moments-dev\\venv\\lib\\site-packages\\flask\\helpers.py\", line 333, in url_for\r\nreturn appctx.app.handle_url_build_error(error, endpoint, values)\r\nFile \"c:\\users\\administrator\\projects\\moments-dev\\venv\\lib\\site-packages\\flask\\app.py\", line 1805, in handle_url_build_error\r\nreraise(exc_type, exc_value, tb)\r\nFile \"c:\\users\\administrator\\projects\\moments-dev\\venv\\lib\\site-packages\\flask\\helpers.py\", line 323, in url_for\r\nforce_external=external)\r\nFile \"c:\\users\\administrator\\projects\\moments-dev\\venv\\lib\\site-packages\\werkzeug\\routing.py\", line 1768, in build\r\nraise BuildError(endpoint, values, method, self)\r\n```\r\nHowever, I actually did specify the `filename`, you can see it in error output.\r\n\r\nHere is the templates structure:\r\n```\r\ntemplates/\r\n    home/\r\n        - photo.html ---- error\r\n        - index.html ---- error\r\n    user/\r\n        - index.html ---- ok\r\n    macros.html ---- error\r\n```\r\n \r\nI tried to request the URL, such as `http://127.0.0.1:5000/avatar/<filename>/<size>`, it works fine on every size.\r\n### Environment\r\n\r\n* Python version: 2.7\r\n* Flask version: 0.12.2\r\n* Werkzeug version: 0.12.2 \r\n* OS: Windows 7\r\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/318235191",
            "html_url": "https://github.com/pallets/flask/issues/2428#issuecomment-318235191",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2428",
            "id": 318235191,
            "node_id": "MDEyOklzc3VlQ29tbWVudDMxODIzNTE5MQ==",
            "user": {
                "login": "ThiefMaster",
                "id": 179599,
                "node_id": "MDQ6VXNlcjE3OTU5OQ==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/179599?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ThiefMaster",
                "html_url": "https://github.com/ThiefMaster",
                "followers_url": "https://api.github.com/users/ThiefMaster/followers",
                "following_url": "https://api.github.com/users/ThiefMaster/following{/other_user}",
                "gists_url": "https://api.github.com/users/ThiefMaster/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ThiefMaster/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ThiefMaster/subscriptions",
                "organizations_url": "https://api.github.com/users/ThiefMaster/orgs",
                "repos_url": "https://api.github.com/users/ThiefMaster/repos",
                "events_url": "https://api.github.com/users/ThiefMaster/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ThiefMaster/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-07-27T01:52:58Z",
            "updated_at": "2017-07-27T01:52:58Z",
            "author_association": "MEMBER",
            "body": "is `user.avatar` None?"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/318239514",
            "html_url": "https://github.com/pallets/flask/issues/2428#issuecomment-318239514",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2428",
            "id": 318239514,
            "node_id": "MDEyOklzc3VlQ29tbWVudDMxODIzOTUxNA==",
            "user": {
                "login": "greyli",
                "id": 12967000,
                "node_id": "MDQ6VXNlcjEyOTY3MDAw",
                "avatar_url": "https://avatars3.githubusercontent.com/u/12967000?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/greyli",
                "html_url": "https://github.com/greyli",
                "followers_url": "https://api.github.com/users/greyli/followers",
                "following_url": "https://api.github.com/users/greyli/following{/other_user}",
                "gists_url": "https://api.github.com/users/greyli/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/greyli/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/greyli/subscriptions",
                "organizations_url": "https://api.github.com/users/greyli/orgs",
                "repos_url": "https://api.github.com/users/greyli/repos",
                "events_url": "https://api.github.com/users/greyli/events{/privacy}",
                "received_events_url": "https://api.github.com/users/greyli/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-07-27T02:20:54Z",
            "updated_at": "2017-07-27T02:20:54Z",
            "author_association": "MEMBER",
            "body": "Oh, there are some  `user.avatar` on these three templates was None! Thanks!"
        }
    ]
}