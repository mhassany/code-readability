{
    "url": "https://api.github.com/repos/pallets/flask/issues/1968",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/1968/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/1968/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/1968/events",
    "html_url": "https://github.com/pallets/flask/issues/1968",
    "id": 168366611,
    "node_id": "MDU6SXNzdWUxNjgzNjY2MTE=",
    "number": 1968,
    "title": "from flask import current_app appears to have side effects",
    "user": {
        "login": "abendebury",
        "id": 146027,
        "node_id": "MDQ6VXNlcjE0NjAyNw==",
        "avatar_url": "https://avatars1.githubusercontent.com/u/146027?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/abendebury",
        "html_url": "https://github.com/abendebury",
        "followers_url": "https://api.github.com/users/abendebury/followers",
        "following_url": "https://api.github.com/users/abendebury/following{/other_user}",
        "gists_url": "https://api.github.com/users/abendebury/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/abendebury/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/abendebury/subscriptions",
        "organizations_url": "https://api.github.com/users/abendebury/orgs",
        "repos_url": "https://api.github.com/users/abendebury/repos",
        "events_url": "https://api.github.com/users/abendebury/events{/privacy}",
        "received_events_url": "https://api.github.com/users/abendebury/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 5,
    "created_at": "2016-07-29T16:45:39Z",
    "updated_at": "2019-06-08T21:13:03Z",
    "closed_at": "2016-07-30T01:07:39Z",
    "author_association": "NONE",
    "body": "I have been trying to document my project with sphinx, but it seems that when sphinx reads a file that contains `import current_app` it breaks with the following message:\n\n```\n[$]>>> make html\nsphinx-build -b html -d build/doctrees  -W -v source build/html\nRunning Sphinx v1.4.5\nloading pickled environment... not yet created\nbuilding [mo]: targets for 0 po files that are out of date\nbuilding [html]: targets for 5 source files that are out of date\nupdating environment: 5 added, 0 changed, 0 removed\nreading sources... [ 20%] index\nreading sources... [ 40%] modules\nreading sources... [ 60%] quizApp\nTraceback (most recent call last):\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/sphinx/ext/viewcode.py\", line 28, in _get_full_modname\n    return get_full_modname(modname, attribute)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/sphinx/util/__init__.py\", line 300, in get_full_modname\n    __import__(modname)\nTypeError: __import__() argument 1 must be string, not None\nviewcode can't import None, failed with error \"__import__() argument 1 must be string, not None\"\nTraceback (most recent call last):\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/sphinx/ext/viewcode.py\", line 28, in _get_full_modname\n    return get_full_modname(modname, attribute)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/sphinx/util/__init__.py\", line 300, in get_full_modname\n    __import__(modname)\nTypeError: __import__() argument 1 must be string, not None\nviewcode can't import None, failed with error \"__import__() argument 1 must be string, not None\"\nDidn't find ParticipantExperiment.activities in quizApp.models\nDidn't find Question.explantion in quizApp.models\nDidn't find User.name in quizApp.models\nDidn't find User.authenticated in quizApp.models\nreading sources... [ 80%] quizApp.forms\nreading sources... [100%] quizApp.views\n\nTraceback (most recent call last):\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/sphinx/cmdline.py\", line 244, in main\n    app.build(opts.force_all, filenames)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/sphinx/application.py\", line 297, in build\n    self.builder.build_update()\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/sphinx/builders/__init__.py\", line 251, in build_update\n    'out of date' % len(to_build))\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/sphinx/builders/__init__.py\", line 265, in build\n    self.doctreedir, self.app))\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/sphinx/environment.py\", line 569, in update\n    self._read_serial(docnames, app)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/sphinx/environment.py\", line 589, in _read_serial\n    self.read_doc(docname, app)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/sphinx/environment.py\", line 742, in read_doc\n    pub.publish()\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/core.py\", line 217, in publish\n    self.settings)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/sphinx/io.py\", line 49, in read\n    self.parse()\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/readers/__init__.py\", line 78, in parse\n    self.parser.parse(self.input, document)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/parsers/rst/__init__.py\", line 172, in parse\n    self.statemachine.run(inputlines, document, inliner=self.inliner)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/parsers/rst/states.py\", line 170, in run\n    input_source=document['source'])\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/statemachine.py\", line 239, in run\n    context, state, transitions)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/statemachine.py\", line 460, in check_line\n    return method(match, context, next_state)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/parsers/rst/states.py\", line 2726, in underline\n    self.section(title, source, style, lineno - 1, messages)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/parsers/rst/states.py\", line 327, in section\n    self.new_subsection(title, lineno, messages)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/parsers/rst/states.py\", line 395, in new_subsection\n    node=section_node, match_titles=True)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/parsers/rst/states.py\", line 282, in nested_parse\n    node=node, match_titles=match_titles)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/parsers/rst/states.py\", line 195, in run\n    results = StateMachineWS.run(self, input_lines, input_offset)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/statemachine.py\", line 239, in run\n    context, state, transitions)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/statemachine.py\", line 460, in check_line\n    return method(match, context, next_state)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/parsers/rst/states.py\", line 2726, in underline\n    self.section(title, source, style, lineno - 1, messages)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/parsers/rst/states.py\", line 327, in section\n    self.new_subsection(title, lineno, messages)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/parsers/rst/states.py\", line 395, in new_subsection\n    node=section_node, match_titles=True)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/parsers/rst/states.py\", line 282, in nested_parse\n    node=node, match_titles=match_titles)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/parsers/rst/states.py\", line 195, in run\n    results = StateMachineWS.run(self, input_lines, input_offset)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/statemachine.py\", line 239, in run\n    context, state, transitions)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/statemachine.py\", line 460, in check_line\n    return method(match, context, next_state)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/parsers/rst/states.py\", line 2299, in explicit_markup\n    nodelist, blank_finish = self.explicit_construct(match)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/parsers/rst/states.py\", line 2311, in explicit_construct\n    return method(self, expmatch)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/parsers/rst/states.py\", line 2054, in directive\n    directive_class, match, type_name, option_presets)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/docutils/parsers/rst/states.py\", line 2103, in run_directive\n    result = directive_instance.run()\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/sphinx/ext/autodoc.py\", line 1613, in run\n    documenter.generate(more_content=self.content)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/sphinx/ext/autodoc.py\", line 963, in generate\n    self.document_members(all_members)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/sphinx/ext/autodoc.py\", line 855, in document_members\n    if cls.can_document_member(member, mname, isattr, self)]\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/sphinx/ext/autodoc.py\", line 1458, in can_document_member\n    isdatadesc = isdescriptor(member) and not \\\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/sphinx/util/inspect.py\", line 101, in isdescriptor\n    if hasattr(safe_getattr(x, item, None), '__call__'):\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/sphinx/util/inspect.py\", line 113, in safe_getattr\n    if name in obj.__dict__:\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/werkzeug/local.py\", line 343, in __getattr__\n    return getattr(self._get_current_object(), name)\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/werkzeug/local.py\", line 302, in _get_current_object\n    return self.__local()\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/flask/globals.py\", line 37, in _lookup_req_object\n    raise RuntimeError(_request_ctx_err_msg)\nRuntimeError: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request.  Consult the documentation on testing for\ninformation about how to avoid this problem.\n\nException occurred:\n  File \"/home/alyosha/.virtualenvs/quizApp-new/lib/python2.7/site-packages/flask/globals.py\", line 37, in _lookup_req_object\n    raise RuntimeError(_request_ctx_err_msg)\nRuntimeError: Working outside of request context.\n\nThis typically means that you attempted to use functionality that needed\nan active HTTP request.  Consult the documentation on testing for\ninformation about how to avoid this problem.\nThe full traceback has been saved in /tmp/sphinx-err-iI83eY.log, if you want to report the issue to the developers.\nPlease also report this if it was a user error, so that a better error message can be provided next time.\nA bug report can be filed in the tracker at <https://github.com/sphinx-doc/sphinx/issues>. Thanks!\nmake: *** [Makefile:53: html] Error 1\n```\n\nIt looks like something weird is going on at import time with `current_app`. I'm not 100% sure if this is a sphinx error or flask error, but I'm leaning towards flask.\n\nI made the following example to reproduce it.\n\nhttps://github.com/PlasmaSheep/sphinx-error\n\nInstructions for running it are in the `README.md` file.\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/236237680",
            "html_url": "https://github.com/pallets/flask/issues/1968#issuecomment-236237680",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1968",
            "id": 236237680,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjIzNzY4MA==",
            "user": {
                "login": "RonnyPfannschmidt",
                "id": 156838,
                "node_id": "MDQ6VXNlcjE1NjgzOA==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/156838?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/RonnyPfannschmidt",
                "html_url": "https://github.com/RonnyPfannschmidt",
                "followers_url": "https://api.github.com/users/RonnyPfannschmidt/followers",
                "following_url": "https://api.github.com/users/RonnyPfannschmidt/following{/other_user}",
                "gists_url": "https://api.github.com/users/RonnyPfannschmidt/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/RonnyPfannschmidt/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/RonnyPfannschmidt/subscriptions",
                "organizations_url": "https://api.github.com/users/RonnyPfannschmidt/orgs",
                "repos_url": "https://api.github.com/users/RonnyPfannschmidt/repos",
                "events_url": "https://api.github.com/users/RonnyPfannschmidt/events{/privacy}",
                "received_events_url": "https://api.github.com/users/RonnyPfannschmidt/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-07-29T17:10:50Z",
            "updated_at": "2016-07-29T17:10:50Z",
            "author_association": "CONTRIBUTOR",
            "body": "at first glacne it looks like it dies at inspecting current_app, what happens if you tell sphinx to ignore the current_app member of that module?\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/236238767",
            "html_url": "https://github.com/pallets/flask/issues/1968#issuecomment-236238767",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1968",
            "id": 236238767,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjIzODc2Nw==",
            "user": {
                "login": "abendebury",
                "id": 146027,
                "node_id": "MDQ6VXNlcjE0NjAyNw==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/146027?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/abendebury",
                "html_url": "https://github.com/abendebury",
                "followers_url": "https://api.github.com/users/abendebury/followers",
                "following_url": "https://api.github.com/users/abendebury/following{/other_user}",
                "gists_url": "https://api.github.com/users/abendebury/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/abendebury/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/abendebury/subscriptions",
                "organizations_url": "https://api.github.com/users/abendebury/orgs",
                "repos_url": "https://api.github.com/users/abendebury/repos",
                "events_url": "https://api.github.com/users/abendebury/events{/privacy}",
                "received_events_url": "https://api.github.com/users/abendebury/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-07-29T17:15:31Z",
            "updated_at": "2016-07-29T17:15:31Z",
            "author_association": "NONE",
            "body": "It doesn't seem that there is a way to ignore an import in sphinx, see this question:\n\nhttps://stackoverflow.com/questions/15889621/sphinx-how-to-exclude-imports-in-automodule\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/236329329",
            "html_url": "https://github.com/pallets/flask/issues/1968#issuecomment-236329329",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1968",
            "id": 236329329,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIzNjMyOTMyOQ==",
            "user": {
                "login": "abendebury",
                "id": 146027,
                "node_id": "MDQ6VXNlcjE0NjAyNw==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/146027?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/abendebury",
                "html_url": "https://github.com/abendebury",
                "followers_url": "https://api.github.com/users/abendebury/followers",
                "following_url": "https://api.github.com/users/abendebury/following{/other_user}",
                "gists_url": "https://api.github.com/users/abendebury/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/abendebury/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/abendebury/subscriptions",
                "organizations_url": "https://api.github.com/users/abendebury/orgs",
                "repos_url": "https://api.github.com/users/abendebury/repos",
                "events_url": "https://api.github.com/users/abendebury/events{/privacy}",
                "received_events_url": "https://api.github.com/users/abendebury/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-07-30T01:07:39Z",
            "updated_at": "2016-07-30T01:07:39Z",
            "author_association": "NONE",
            "body": "After some testing, it seems that this is a sphinx bug. In fact, this has been fixed in git, but not yet pushed to pypi (to be exact, sphinx 1.4.5 has the bug). I'm going to mark this closed.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/238416145",
            "html_url": "https://github.com/pallets/flask/issues/1968#issuecomment-238416145",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1968",
            "id": 238416145,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIzODQxNjE0NQ==",
            "user": {
                "login": "ghost",
                "id": 10137,
                "node_id": "MDQ6VXNlcjEwMTM3",
                "avatar_url": "https://avatars3.githubusercontent.com/u/10137?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ghost",
                "html_url": "https://github.com/ghost",
                "followers_url": "https://api.github.com/users/ghost/followers",
                "following_url": "https://api.github.com/users/ghost/following{/other_user}",
                "gists_url": "https://api.github.com/users/ghost/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ghost/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ghost/subscriptions",
                "organizations_url": "https://api.github.com/users/ghost/orgs",
                "repos_url": "https://api.github.com/users/ghost/repos",
                "events_url": "https://api.github.com/users/ghost/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ghost/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-08-09T00:12:22Z",
            "updated_at": "2016-08-09T00:15:14Z",
            "author_association": "NONE",
            "body": "@PlasmaSheep: Could you please point me to the Sphinx git commit that fixed this problem? Thank you!\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/239498516",
            "html_url": "https://github.com/pallets/flask/issues/1968#issuecomment-239498516",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1968",
            "id": 239498516,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIzOTQ5ODUxNg==",
            "user": {
                "login": "ZacBlanco",
                "id": 3464508,
                "node_id": "MDQ6VXNlcjM0NjQ1MDg=",
                "avatar_url": "https://avatars2.githubusercontent.com/u/3464508?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ZacBlanco",
                "html_url": "https://github.com/ZacBlanco",
                "followers_url": "https://api.github.com/users/ZacBlanco/followers",
                "following_url": "https://api.github.com/users/ZacBlanco/following{/other_user}",
                "gists_url": "https://api.github.com/users/ZacBlanco/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ZacBlanco/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ZacBlanco/subscriptions",
                "organizations_url": "https://api.github.com/users/ZacBlanco/orgs",
                "repos_url": "https://api.github.com/users/ZacBlanco/repos",
                "events_url": "https://api.github.com/users/ZacBlanco/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ZacBlanco/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-08-12T16:48:45Z",
            "updated_at": "2016-08-12T16:48:45Z",
            "author_association": "NONE",
            "body": "@MartinBorg Funny I just came across this issue today. If you still really need this working my solution was to just install the latest dev-version of sphinx via pip\n\n``` bash\npip install git+https://github.com/sphinx-doc/sphinx@stable\n```\n"
        }
    ]
}