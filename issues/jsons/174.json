{
    "url": "https://api.github.com/repos/pallets/flask/issues/174",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/174/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/174/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/174/events",
    "html_url": "https://github.com/pallets/flask/issues/174",
    "id": 607733,
    "node_id": "MDU6SXNzdWU2MDc3MzM=",
    "number": 174,
    "title": "after_request behavior regarding exceptions",
    "user": {
        "login": "mitsuhiko",
        "id": 7396,
        "node_id": "MDQ6VXNlcjczOTY=",
        "avatar_url": "https://avatars1.githubusercontent.com/u/7396?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mitsuhiko",
        "html_url": "https://github.com/mitsuhiko",
        "followers_url": "https://api.github.com/users/mitsuhiko/followers",
        "following_url": "https://api.github.com/users/mitsuhiko/following{/other_user}",
        "gists_url": "https://api.github.com/users/mitsuhiko/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/mitsuhiko/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/mitsuhiko/subscriptions",
        "organizations_url": "https://api.github.com/users/mitsuhiko/orgs",
        "repos_url": "https://api.github.com/users/mitsuhiko/repos",
        "events_url": "https://api.github.com/users/mitsuhiko/events{/privacy}",
        "received_events_url": "https://api.github.com/users/mitsuhiko/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 5,
    "created_at": "2011-02-17T21:49:45Z",
    "updated_at": "2011-03-14T20:14:11Z",
    "closed_at": "2011-03-14T20:14:11Z",
    "author_association": "MEMBER",
    "body": "after_request is not executed if an exception happens in debug mode. This is annoying for databases because it requires that you restart the server to tear down the connection. Sometimes that's what you want, otherwise not. The original intention was that you want to continue having the transaction in the interactive debugger.\n\nGenerally however we need a separate decorator that always executes after request, even if an exception happened. Signals are one option, if that is what we want we should document it better. I would prefer a separate decorator however.\n\nRelated feedback issues:\n- http://feedback.flask.pocoo.org/message/108\n- http://feedback.flask.pocoo.org/message/76\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/857277",
            "html_url": "https://github.com/pallets/flask/issues/174#issuecomment-857277",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/174",
            "id": 857277,
            "node_id": "MDEyOklzc3VlQ29tbWVudDg1NzI3Nw==",
            "user": {
                "login": "leifkb",
                "id": 13740,
                "node_id": "MDQ6VXNlcjEzNzQw",
                "avatar_url": "https://avatars2.githubusercontent.com/u/13740?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/leifkb",
                "html_url": "https://github.com/leifkb",
                "followers_url": "https://api.github.com/users/leifkb/followers",
                "following_url": "https://api.github.com/users/leifkb/following{/other_user}",
                "gists_url": "https://api.github.com/users/leifkb/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/leifkb/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/leifkb/subscriptions",
                "organizations_url": "https://api.github.com/users/leifkb/orgs",
                "repos_url": "https://api.github.com/users/leifkb/repos",
                "events_url": "https://api.github.com/users/leifkb/events{/privacy}",
                "received_events_url": "https://api.github.com/users/leifkb/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2011-03-10T19:30:28Z",
            "updated_at": "2011-03-10T19:30:28Z",
            "author_association": "NONE",
            "body": "The current behavior leaves uncommitted transactions around, which can then be committed by subsequent requests. That's really confusing and unexpected behavior, at least for me. On the other hand, I do see the value in keeping the transaction around for the debugger.\n\nI'm not too familiar with the deep internals, so this might not make any sense, but would it be possible to remove the thread in which the exception occurred from the thread pool (and replace it with a new one), but keep that thread alive to run the debugger in? That way, you don't have to execute the after_request functions and kill the DB transaction, but the transaction won't randomly pop up in subsequent requests.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/867844",
            "html_url": "https://github.com/pallets/flask/issues/174#issuecomment-867844",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/174",
            "id": 867844,
            "node_id": "MDEyOklzc3VlQ29tbWVudDg2Nzg0NA==",
            "user": {
                "login": "glyphobet",
                "id": 492150,
                "node_id": "MDQ6VXNlcjQ5MjE1MA==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/492150?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/glyphobet",
                "html_url": "https://github.com/glyphobet",
                "followers_url": "https://api.github.com/users/glyphobet/followers",
                "following_url": "https://api.github.com/users/glyphobet/following{/other_user}",
                "gists_url": "https://api.github.com/users/glyphobet/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/glyphobet/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/glyphobet/subscriptions",
                "organizations_url": "https://api.github.com/users/glyphobet/orgs",
                "repos_url": "https://api.github.com/users/glyphobet/repos",
                "events_url": "https://api.github.com/users/glyphobet/events{/privacy}",
                "received_events_url": "https://api.github.com/users/glyphobet/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2011-03-14T05:23:28Z",
            "updated_at": "2011-03-14T05:23:28Z",
            "author_association": "CONTRIBUTOR",
            "body": "brainsik and I are working on this.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/870669",
            "html_url": "https://github.com/pallets/flask/issues/174#issuecomment-870669",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/174",
            "id": 870669,
            "node_id": "MDEyOklzc3VlQ29tbWVudDg3MDY2OQ==",
            "user": {
                "login": "glyphobet",
                "id": 492150,
                "node_id": "MDQ6VXNlcjQ5MjE1MA==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/492150?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/glyphobet",
                "html_url": "https://github.com/glyphobet",
                "followers_url": "https://api.github.com/users/glyphobet/followers",
                "following_url": "https://api.github.com/users/glyphobet/following{/other_user}",
                "gists_url": "https://api.github.com/users/glyphobet/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/glyphobet/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/glyphobet/subscriptions",
                "organizations_url": "https://api.github.com/users/glyphobet/orgs",
                "repos_url": "https://api.github.com/users/glyphobet/repos",
                "events_url": "https://api.github.com/users/glyphobet/events{/privacy}",
                "received_events_url": "https://api.github.com/users/glyphobet/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2011-03-14T19:08:53Z",
            "updated_at": "2011-03-14T19:08:53Z",
            "author_association": "CONTRIBUTOR",
            "body": "fixed in SHA: 04e70bd5c7bd80696eabaea11afd9080d874f859\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/871541",
            "html_url": "https://github.com/pallets/flask/issues/174#issuecomment-871541",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/174",
            "id": 871541,
            "node_id": "MDEyOklzc3VlQ29tbWVudDg3MTU0MQ==",
            "user": {
                "login": "rduplain",
                "id": 36428,
                "node_id": "MDQ6VXNlcjM2NDI4",
                "avatar_url": "https://avatars1.githubusercontent.com/u/36428?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/rduplain",
                "html_url": "https://github.com/rduplain",
                "followers_url": "https://api.github.com/users/rduplain/followers",
                "following_url": "https://api.github.com/users/rduplain/following{/other_user}",
                "gists_url": "https://api.github.com/users/rduplain/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/rduplain/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rduplain/subscriptions",
                "organizations_url": "https://api.github.com/users/rduplain/orgs",
                "repos_url": "https://api.github.com/users/rduplain/repos",
                "events_url": "https://api.github.com/users/rduplain/events{/privacy}",
                "received_events_url": "https://api.github.com/users/rduplain/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2011-03-14T20:13:22Z",
            "updated_at": "2011-03-14T20:13:22Z",
            "author_association": "CONTRIBUTOR",
            "body": "Please close.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/871545",
            "html_url": "https://github.com/pallets/flask/issues/174#issuecomment-871545",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/174",
            "id": 871545,
            "node_id": "MDEyOklzc3VlQ29tbWVudDg3MTU0NQ==",
            "user": {
                "login": "mitsuhiko",
                "id": 7396,
                "node_id": "MDQ6VXNlcjczOTY=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/7396?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/mitsuhiko",
                "html_url": "https://github.com/mitsuhiko",
                "followers_url": "https://api.github.com/users/mitsuhiko/followers",
                "following_url": "https://api.github.com/users/mitsuhiko/following{/other_user}",
                "gists_url": "https://api.github.com/users/mitsuhiko/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/mitsuhiko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mitsuhiko/subscriptions",
                "organizations_url": "https://api.github.com/users/mitsuhiko/orgs",
                "repos_url": "https://api.github.com/users/mitsuhiko/repos",
                "events_url": "https://api.github.com/users/mitsuhiko/events{/privacy}",
                "received_events_url": "https://api.github.com/users/mitsuhiko/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2011-03-14T20:14:11Z",
            "updated_at": "2011-03-14T20:14:11Z",
            "author_association": "MEMBER",
            "body": "Done.\n"
        }
    ]
}