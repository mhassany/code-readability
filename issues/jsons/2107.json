{
    "url": "https://api.github.com/repos/pallets/flask/issues/2107",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/2107/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/2107/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/2107/events",
    "html_url": "https://github.com/pallets/flask/issues/2107",
    "id": 193819867,
    "node_id": "MDU6SXNzdWUxOTM4MTk4Njc=",
    "number": 2107,
    "title": "API exception pattern docs do not mention PROPAGATE_EXCEPTIONS",
    "user": {
        "login": "philmayers",
        "id": 739238,
        "node_id": "MDQ6VXNlcjczOTIzOA==",
        "avatar_url": "https://avatars2.githubusercontent.com/u/739238?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/philmayers",
        "html_url": "https://github.com/philmayers",
        "followers_url": "https://api.github.com/users/philmayers/followers",
        "following_url": "https://api.github.com/users/philmayers/following{/other_user}",
        "gists_url": "https://api.github.com/users/philmayers/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/philmayers/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/philmayers/subscriptions",
        "organizations_url": "https://api.github.com/users/philmayers/orgs",
        "repos_url": "https://api.github.com/users/philmayers/repos",
        "events_url": "https://api.github.com/users/philmayers/events{/privacy}",
        "received_events_url": "https://api.github.com/users/philmayers/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 3,
    "created_at": "2016-12-06T16:33:07Z",
    "updated_at": "2017-05-30T14:00:10Z",
    "closed_at": "2017-05-30T13:59:14Z",
    "author_association": "NONE",
    "body": "http://flask.pocoo.org/docs/0.11/patterns/apierrors/\r\n\r\n...discusses a pattern for defining and catching custom exceptions. However, this pattern does not work unless PROPAGATE_EXCEPTIONS is set, because the exception gets eaten and turned into a 500.\r\n\r\nConfusingly it will work in DEBUG=True mode then break in production.\r\n\r\nCan the docs be updated? Or am I missing something?",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/269242298",
            "html_url": "https://github.com/pallets/flask/issues/2107#issuecomment-269242298",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2107",
            "id": 269242298,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI2OTI0MjI5OA==",
            "user": {
                "login": "r0fls",
                "id": 1858004,
                "node_id": "MDQ6VXNlcjE4NTgwMDQ=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1858004?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/r0fls",
                "html_url": "https://github.com/r0fls",
                "followers_url": "https://api.github.com/users/r0fls/followers",
                "following_url": "https://api.github.com/users/r0fls/following{/other_user}",
                "gists_url": "https://api.github.com/users/r0fls/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/r0fls/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/r0fls/subscriptions",
                "organizations_url": "https://api.github.com/users/r0fls/orgs",
                "repos_url": "https://api.github.com/users/r0fls/repos",
                "events_url": "https://api.github.com/users/r0fls/events{/privacy}",
                "received_events_url": "https://api.github.com/users/r0fls/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-12-26T21:16:00Z",
            "updated_at": "2016-12-26T21:16:00Z",
            "author_association": "CONTRIBUTOR",
            "body": "It sounds like you forgot to register an error handler: http://flask.pocoo.org/docs/0.11/patterns/apierrors/#registering-an-error-handler\r\n\r\n>At that point views can raise that error, but it would immediately result in an internal server error. The reason for this is that there is no handler registered for this error class. \r\n\r\nI just tried with this:\r\n\r\n```python\r\nfrom flask import jsonify\r\nfrom flask import Flask\r\napp = Flask(__name__)\r\n\r\nclass InvalidUsage(Exception):\r\n    status_code = 400\r\n\r\n    def __init__(self, message, status_code=None, payload=None):\r\n        Exception.__init__(self)\r\n        self.message = message\r\n        if status_code is not None:\r\n            self.status_code = status_code\r\n        self.payload = payload\r\n\r\n    def to_dict(self):\r\n        rv = dict(self.payload or ())\r\n        rv['message'] = self.message\r\n        return rv\r\n\r\n@app.errorhandler(InvalidUsage)\r\ndef handle_invalid_usage(error):\r\n    response = jsonify(error.to_dict())\r\n    response.status_code = error.status_code\r\n    return response\r\n\r\n@app.route('/foo')\r\ndef get_foo():\r\n    raise InvalidUsage('This view is gone')\r\n```\r\n\r\nIt works as expected:\r\n\r\n```\r\n$ curl localhost:5000/foo\r\n{\r\n  \"message\": \"This view is gone\"\r\n}\r\n$ curl -I localhost:5000/foo\r\nHTTP/1.0 400 BAD REQUEST\r\nContent-Type: application/json\r\nContent-Length: 37\r\nServer: Werkzeug/0.11.11 Python/2.7.12\r\nDate: Mon, 26 Dec 2016 21:13:35 GMT\r\n```"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/271356831",
            "html_url": "https://github.com/pallets/flask/issues/2107#issuecomment-271356831",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2107",
            "id": 271356831,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTM1NjgzMQ==",
            "user": {
                "login": "philmayers",
                "id": 739238,
                "node_id": "MDQ6VXNlcjczOTIzOA==",
                "avatar_url": "https://avatars2.githubusercontent.com/u/739238?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/philmayers",
                "html_url": "https://github.com/philmayers",
                "followers_url": "https://api.github.com/users/philmayers/followers",
                "following_url": "https://api.github.com/users/philmayers/following{/other_user}",
                "gists_url": "https://api.github.com/users/philmayers/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/philmayers/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/philmayers/subscriptions",
                "organizations_url": "https://api.github.com/users/philmayers/orgs",
                "repos_url": "https://api.github.com/users/philmayers/repos",
                "events_url": "https://api.github.com/users/philmayers/events{/privacy}",
                "received_events_url": "https://api.github.com/users/philmayers/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-01-09T18:00:29Z",
            "updated_at": "2017-01-09T18:00:29Z",
            "author_association": "NONE",
            "body": "No, that's not correct. I have done exactly that, registered an error handler, and it *specifically* doesn't work unless PROPAGATE_EXCEPTIONS is set, which is not clearly documented at the link you cite - which is exactly the same link I gave."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/304887055",
            "html_url": "https://github.com/pallets/flask/issues/2107#issuecomment-304887055",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2107",
            "id": 304887055,
            "node_id": "MDEyOklzc3VlQ29tbWVudDMwNDg4NzA1NQ==",
            "user": {
                "login": "philmayers",
                "id": 739238,
                "node_id": "MDQ6VXNlcjczOTIzOA==",
                "avatar_url": "https://avatars2.githubusercontent.com/u/739238?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/philmayers",
                "html_url": "https://github.com/philmayers",
                "followers_url": "https://api.github.com/users/philmayers/followers",
                "following_url": "https://api.github.com/users/philmayers/following{/other_user}",
                "gists_url": "https://api.github.com/users/philmayers/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/philmayers/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/philmayers/subscriptions",
                "organizations_url": "https://api.github.com/users/philmayers/orgs",
                "repos_url": "https://api.github.com/users/philmayers/repos",
                "events_url": "https://api.github.com/users/philmayers/events{/privacy}",
                "received_events_url": "https://api.github.com/users/philmayers/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-05-30T13:59:31Z",
            "updated_at": "2017-05-30T13:59:31Z",
            "author_association": "NONE",
            "body": "This appears to be something inside flask-restful, not flask itself. I thought I'd located code in flask/werkzeug that was causing it but have retested and proven myself wrong. Sorry for the noise, this can be closed."
        }
    ]
}