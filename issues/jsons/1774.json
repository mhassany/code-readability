{
    "url": "https://api.github.com/repos/pallets/flask/issues/1774",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/1774/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/1774/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/1774/events",
    "html_url": "https://github.com/pallets/flask/issues/1774",
    "id": 146572512,
    "node_id": "MDU6SXNzdWUxNDY1NzI1MTI=",
    "number": 1774,
    "title": "API versioning with blueprints causes colission",
    "user": {
        "login": "alejoar",
        "id": 6714697,
        "node_id": "MDQ6VXNlcjY3MTQ2OTc=",
        "avatar_url": "https://avatars2.githubusercontent.com/u/6714697?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/alejoar",
        "html_url": "https://github.com/alejoar",
        "followers_url": "https://api.github.com/users/alejoar/followers",
        "following_url": "https://api.github.com/users/alejoar/following{/other_user}",
        "gists_url": "https://api.github.com/users/alejoar/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/alejoar/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/alejoar/subscriptions",
        "organizations_url": "https://api.github.com/users/alejoar/orgs",
        "repos_url": "https://api.github.com/users/alejoar/repos",
        "events_url": "https://api.github.com/users/alejoar/events{/privacy}",
        "received_events_url": "https://api.github.com/users/alejoar/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 7,
    "created_at": "2016-04-07T10:19:27Z",
    "updated_at": "2016-04-08T08:24:50Z",
    "closed_at": "2016-04-07T11:18:34Z",
    "author_association": "NONE",
    "body": "The time has come where I need to release a new version for my api and still support the previous one.\n\nI have an app structure that looks like this:\n\n```\n+-- app/\n    +-- api_2_0/\n        +-- __init__.py\n        (...)\n    +-- api_2_1/\n        +-- __init__.py\n        (...)\n   +-- __init__.py\n```\n\nBoth are blueprints which I initialize this way in my `__init__.py` in the `create_app` method (I'm using the [app factory](http://flask.pocoo.org/docs/0.10/patterns/appfactories/) method):\n\n```\n    from .api_2_0 import api as api_2_0_blueprint\n    app.register_blueprint(api_2_0_blueprint, url_prefix='/api/v2.0')\n\n    from .api_2_1 import api as api_2_1_blueprint\n    app.register_blueprint(api_2_1_blueprint, url_prefix='/api/v2.1')\n```\n\nBut this causes: `AssertionError: A blueprint's name collision occurred between <flask.blueprints.Blueprint object at 0x7f8e48e82c10> and <flask.blueprints.Blueprint object at 0x7f8e48ef7150>.  Both share the same name \"api\".  Blueprints that are created on the fly need unique names.`\n\nIt's true that both are called `api` inside their folders but I'm importing them with different names. Having to rename all the calls to `api` to something else for each version would make versioning painful and overall a code spaghetti.\n\nIs there a better way to do this?\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/206802146",
            "html_url": "https://github.com/pallets/flask/issues/1774#issuecomment-206802146",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1774",
            "id": 206802146,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIwNjgwMjE0Ng==",
            "user": {
                "login": "RonnyPfannschmidt",
                "id": 156838,
                "node_id": "MDQ6VXNlcjE1NjgzOA==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/156838?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/RonnyPfannschmidt",
                "html_url": "https://github.com/RonnyPfannschmidt",
                "followers_url": "https://api.github.com/users/RonnyPfannschmidt/followers",
                "following_url": "https://api.github.com/users/RonnyPfannschmidt/following{/other_user}",
                "gists_url": "https://api.github.com/users/RonnyPfannschmidt/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/RonnyPfannschmidt/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/RonnyPfannschmidt/subscriptions",
                "organizations_url": "https://api.github.com/users/RonnyPfannschmidt/orgs",
                "repos_url": "https://api.github.com/users/RonnyPfannschmidt/repos",
                "events_url": "https://api.github.com/users/RonnyPfannschmidt/events{/privacy}",
                "received_events_url": "https://api.github.com/users/RonnyPfannschmidt/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-04-07T10:30:17Z",
            "updated_at": "2016-04-07T10:30:17Z",
            "author_association": "CONTRIBUTOR",
            "body": "no, thats per design - blueprints express reusable parts of an application, each part has a different name\n\nthey are not quite intended for api versioning at all\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/206804520",
            "html_url": "https://github.com/pallets/flask/issues/1774#issuecomment-206804520",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1774",
            "id": 206804520,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIwNjgwNDUyMA==",
            "user": {
                "login": "alejoar",
                "id": 6714697,
                "node_id": "MDQ6VXNlcjY3MTQ2OTc=",
                "avatar_url": "https://avatars2.githubusercontent.com/u/6714697?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/alejoar",
                "html_url": "https://github.com/alejoar",
                "followers_url": "https://api.github.com/users/alejoar/followers",
                "following_url": "https://api.github.com/users/alejoar/following{/other_user}",
                "gists_url": "https://api.github.com/users/alejoar/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/alejoar/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/alejoar/subscriptions",
                "organizations_url": "https://api.github.com/users/alejoar/orgs",
                "repos_url": "https://api.github.com/users/alejoar/repos",
                "events_url": "https://api.github.com/users/alejoar/events{/privacy}",
                "received_events_url": "https://api.github.com/users/alejoar/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-04-07T10:38:35Z",
            "updated_at": "2016-04-07T10:38:35Z",
            "author_association": "NONE",
            "body": "So is there a pain free way to do versioning with flask?\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/206821770",
            "html_url": "https://github.com/pallets/flask/issues/1774#issuecomment-206821770",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1774",
            "id": 206821770,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIwNjgyMTc3MA==",
            "user": {
                "login": "ThiefMaster",
                "id": 179599,
                "node_id": "MDQ6VXNlcjE3OTU5OQ==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/179599?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ThiefMaster",
                "html_url": "https://github.com/ThiefMaster",
                "followers_url": "https://api.github.com/users/ThiefMaster/followers",
                "following_url": "https://api.github.com/users/ThiefMaster/following{/other_user}",
                "gists_url": "https://api.github.com/users/ThiefMaster/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ThiefMaster/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ThiefMaster/subscriptions",
                "organizations_url": "https://api.github.com/users/ThiefMaster/orgs",
                "repos_url": "https://api.github.com/users/ThiefMaster/repos",
                "events_url": "https://api.github.com/users/ThiefMaster/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ThiefMaster/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-04-07T11:16:09Z",
            "updated_at": "2016-04-07T11:16:48Z",
            "author_association": "MEMBER",
            "body": "Why can't you rename the old blueprints? I guess you don't build urls for old api versions using `url_for` anyway, right? And when building urls inside the blueprint (i.e. during requests to an endpoint in the blueprint) you can use `.endpoint` instead of `blueprint.endpoint` to reference the endpoint in the current blueprint.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/206822160",
            "html_url": "https://github.com/pallets/flask/issues/1774#issuecomment-206822160",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1774",
            "id": 206822160,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIwNjgyMjE2MA==",
            "user": {
                "login": "alejoar",
                "id": 6714697,
                "node_id": "MDQ6VXNlcjY3MTQ2OTc=",
                "avatar_url": "https://avatars2.githubusercontent.com/u/6714697?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/alejoar",
                "html_url": "https://github.com/alejoar",
                "followers_url": "https://api.github.com/users/alejoar/followers",
                "following_url": "https://api.github.com/users/alejoar/following{/other_user}",
                "gists_url": "https://api.github.com/users/alejoar/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/alejoar/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/alejoar/subscriptions",
                "organizations_url": "https://api.github.com/users/alejoar/orgs",
                "repos_url": "https://api.github.com/users/alejoar/repos",
                "events_url": "https://api.github.com/users/alejoar/events{/privacy}",
                "received_events_url": "https://api.github.com/users/alejoar/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-04-07T11:18:30Z",
            "updated_at": "2016-04-07T11:26:22Z",
            "author_association": "NONE",
            "body": "Ok so it turns out I only had to change the Blueprint definition.\n\nBefore I had both blueprints defined as `api = Blueprint('api', __name__)` which caused the collision and made me think that I needed to change name of the variable `api`.\n\nTurns out what I really needed to change is just the string `'api'` used in the call to `Blueprint`, so now my blueprints are defined as `api = Blueprint('api_2_0', __name__)` and `api = Blueprint('api_2_1', __name__)`, allowing me to keep the variable `api` the same in both cases and saving me the issue of chaging it everywhere.\n\nI'm closing this issue now, sorry for the silly question.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/206931912",
            "html_url": "https://github.com/pallets/flask/issues/1774#issuecomment-206931912",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1774",
            "id": 206931912,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIwNjkzMTkxMg==",
            "user": {
                "login": "RonnyPfannschmidt",
                "id": 156838,
                "node_id": "MDQ6VXNlcjE1NjgzOA==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/156838?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/RonnyPfannschmidt",
                "html_url": "https://github.com/RonnyPfannschmidt",
                "followers_url": "https://api.github.com/users/RonnyPfannschmidt/followers",
                "following_url": "https://api.github.com/users/RonnyPfannschmidt/following{/other_user}",
                "gists_url": "https://api.github.com/users/RonnyPfannschmidt/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/RonnyPfannschmidt/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/RonnyPfannschmidt/subscriptions",
                "organizations_url": "https://api.github.com/users/RonnyPfannschmidt/orgs",
                "repos_url": "https://api.github.com/users/RonnyPfannschmidt/repos",
                "events_url": "https://api.github.com/users/RonnyPfannschmidt/events{/privacy}",
                "received_events_url": "https://api.github.com/users/RonnyPfannschmidt/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-04-07T14:30:04Z",
            "updated_at": "2016-04-07T14:30:04Z",
            "author_association": "CONTRIBUTOR",
            "body": "@alejoar its not a silly question and we are most pleased the resolving your misconception was relatively painless\n\ni wonder if some documentation additions might help future developers to understand directly\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/207300012",
            "html_url": "https://github.com/pallets/flask/issues/1774#issuecomment-207300012",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1774",
            "id": 207300012,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIwNzMwMDAxMg==",
            "user": {
                "login": "jeffwidman",
                "id": 483314,
                "node_id": "MDQ6VXNlcjQ4MzMxNA==",
                "avatar_url": "https://avatars2.githubusercontent.com/u/483314?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/jeffwidman",
                "html_url": "https://github.com/jeffwidman",
                "followers_url": "https://api.github.com/users/jeffwidman/followers",
                "following_url": "https://api.github.com/users/jeffwidman/following{/other_user}",
                "gists_url": "https://api.github.com/users/jeffwidman/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/jeffwidman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jeffwidman/subscriptions",
                "organizations_url": "https://api.github.com/users/jeffwidman/orgs",
                "repos_url": "https://api.github.com/users/jeffwidman/repos",
                "events_url": "https://api.github.com/users/jeffwidman/events{/privacy}",
                "received_events_url": "https://api.github.com/users/jeffwidman/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-04-08T08:13:17Z",
            "updated_at": "2016-04-08T08:13:17Z",
            "author_association": "MEMBER",
            "body": "This might also be helpful: http://stackoverflow.com/a/28797512/770425\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/207307687",
            "html_url": "https://github.com/pallets/flask/issues/1774#issuecomment-207307687",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1774",
            "id": 207307687,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIwNzMwNzY4Nw==",
            "user": {
                "login": "alejoar",
                "id": 6714697,
                "node_id": "MDQ6VXNlcjY3MTQ2OTc=",
                "avatar_url": "https://avatars2.githubusercontent.com/u/6714697?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/alejoar",
                "html_url": "https://github.com/alejoar",
                "followers_url": "https://api.github.com/users/alejoar/followers",
                "following_url": "https://api.github.com/users/alejoar/following{/other_user}",
                "gists_url": "https://api.github.com/users/alejoar/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/alejoar/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/alejoar/subscriptions",
                "organizations_url": "https://api.github.com/users/alejoar/orgs",
                "repos_url": "https://api.github.com/users/alejoar/repos",
                "events_url": "https://api.github.com/users/alejoar/events{/privacy}",
                "received_events_url": "https://api.github.com/users/alejoar/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-04-08T08:23:03Z",
            "updated_at": "2016-04-08T08:24:50Z",
            "author_association": "NONE",
            "body": "@jeffwidman thank you. I actually [asked a question](http://stackoverflow.com/questions/36474042/api-versioning-with-blueprints-causes-colission) in stackoverflow referencing that answer (I don't have enough rep to comment in other people's answers yet).\n\nLuckily I already solved the issue. The problem is that I named both the variable and the blueprint the same and that misled me on where the collision was happening.\n\nThe AssertionError message is quite clear so it is absolutely my fault.\n"
        }
    ]
}