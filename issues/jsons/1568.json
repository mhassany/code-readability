{
    "url": "https://api.github.com/repos/pallets/flask/issues/1568",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/1568/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/1568/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/1568/events",
    "html_url": "https://github.com/pallets/flask/pull/1568",
    "id": 106263117,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NDQ4ODk0NjI=",
    "number": 1568,
    "title": "Url conflict assert",
    "user": {
        "login": "rawrgulmuffins",
        "id": 1521575,
        "node_id": "MDQ6VXNlcjE1MjE1NzU=",
        "avatar_url": "https://avatars0.githubusercontent.com/u/1521575?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/rawrgulmuffins",
        "html_url": "https://github.com/rawrgulmuffins",
        "followers_url": "https://api.github.com/users/rawrgulmuffins/followers",
        "following_url": "https://api.github.com/users/rawrgulmuffins/following{/other_user}",
        "gists_url": "https://api.github.com/users/rawrgulmuffins/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/rawrgulmuffins/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/rawrgulmuffins/subscriptions",
        "organizations_url": "https://api.github.com/users/rawrgulmuffins/orgs",
        "repos_url": "https://api.github.com/users/rawrgulmuffins/repos",
        "events_url": "https://api.github.com/users/rawrgulmuffins/events{/privacy}",
        "received_events_url": "https://api.github.com/users/rawrgulmuffins/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 8,
    "created_at": "2015-09-14T03:10:59Z",
    "updated_at": "2018-10-23T17:43:40Z",
    "closed_at": "2017-04-25T11:21:23Z",
    "author_association": "NONE",
    "pull_request": {
        "url": "https://api.github.com/repos/pallets/flask/pulls/1568",
        "html_url": "https://github.com/pallets/flask/pull/1568",
        "diff_url": "https://github.com/pallets/flask/pull/1568.diff",
        "patch_url": "https://github.com/pallets/flask/pull/1568.patch"
    },
    "body": "This PR is an attempt to reconcile the fact that you can't have two routes with the same function name but you can create two routes with the same URL.\n\n```\nfrom flask import Flask\napp = Flask(\"the_flask_module\")\n\n@app.route(\"/hello\")\ndef hello_page():\n    return \"I'm a hello page\"\n\n@app.route(\"/different_route\")\ndef hello_page():\n    return \"Different route\"\n```\n\nwill throw an `AssertionError`\n\nbut \n\n```\n@app.route(\"/hello\")\ndef end_point1():\n    return \"I'm a hello page\"\n\n@app.route(\"/hello\")\ndef end_point2():\n    return \"Different route\"\n```\n\nwont. In fact the second route is unreachable. \n\nThis PR checks to see if three conditions are true before raising an assertion. The new rule has to have a `subdomain`, `url_path`, and one `method` that overlap with a current rule in the `self.url_map object`.\n\nThere's a couple of wonky pieces in this pull request that were required to get all of the unit tests to pass.\n\n```\nif prior_rule.rule == \"/static/<path:filename>\":\n    continue\n```\n\nwas required to get blueprints to not throw an assertion since each blueprint registers a `\"/static/<path:filename>\"` rule for each blueprint. I tried to find a way to not have to use a static string but alas I failed. \n\nSecondly \n\n```\n methods_minus_required = ((rule.methods & prior_rule.methods) \n     - required_methods)\n```\n\nis used to check for all explicitly registered methods for a route since there were a bunch of cases where the `OPTIONS` method was implicitly added to rules that shared a url_path.\n\n<!-- Reviewable:start -->\n\n---\n\nThis change is [<img src=\"https://reviewable.io/review_button.svg\" height=\"34\" align=\"absmiddle\" alt=\"Reviewable\"/>](https://reviewable.io/reviews/pallets/flask/1568)\n\n<!-- Reviewable:end -->\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/139972411",
            "html_url": "https://github.com/pallets/flask/pull/1568#issuecomment-139972411",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1568",
            "id": 139972411,
            "node_id": "MDEyOklzc3VlQ29tbWVudDEzOTk3MjQxMQ==",
            "user": {
                "login": "ThiefMaster",
                "id": 179599,
                "node_id": "MDQ6VXNlcjE3OTU5OQ==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/179599?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ThiefMaster",
                "html_url": "https://github.com/ThiefMaster",
                "followers_url": "https://api.github.com/users/ThiefMaster/followers",
                "following_url": "https://api.github.com/users/ThiefMaster/following{/other_user}",
                "gists_url": "https://api.github.com/users/ThiefMaster/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ThiefMaster/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ThiefMaster/subscriptions",
                "organizations_url": "https://api.github.com/users/ThiefMaster/orgs",
                "repos_url": "https://api.github.com/users/ThiefMaster/repos",
                "events_url": "https://api.github.com/users/ThiefMaster/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ThiefMaster/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-09-14T06:13:54Z",
            "updated_at": "2015-09-14T06:13:54Z",
            "author_association": "MEMBER",
            "body": "I think all these commits could be easily squashed into a single one.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/139974133",
            "html_url": "https://github.com/pallets/flask/pull/1568#issuecomment-139974133",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1568",
            "id": 139974133,
            "node_id": "MDEyOklzc3VlQ29tbWVudDEzOTk3NDEzMw==",
            "user": {
                "login": "rawrgulmuffins",
                "id": 1521575,
                "node_id": "MDQ6VXNlcjE1MjE1NzU=",
                "avatar_url": "https://avatars0.githubusercontent.com/u/1521575?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/rawrgulmuffins",
                "html_url": "https://github.com/rawrgulmuffins",
                "followers_url": "https://api.github.com/users/rawrgulmuffins/followers",
                "following_url": "https://api.github.com/users/rawrgulmuffins/following{/other_user}",
                "gists_url": "https://api.github.com/users/rawrgulmuffins/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/rawrgulmuffins/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rawrgulmuffins/subscriptions",
                "organizations_url": "https://api.github.com/users/rawrgulmuffins/orgs",
                "repos_url": "https://api.github.com/users/rawrgulmuffins/repos",
                "events_url": "https://api.github.com/users/rawrgulmuffins/events{/privacy}",
                "received_events_url": "https://api.github.com/users/rawrgulmuffins/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-09-14T06:30:28Z",
            "updated_at": "2015-09-14T06:30:28Z",
            "author_association": "NONE",
            "body": "Done, everything was squashed down to that one commit.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/140001068",
            "html_url": "https://github.com/pallets/flask/pull/1568#issuecomment-140001068",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1568",
            "id": 140001068,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE0MDAwMTA2OA==",
            "user": {
                "login": "ThiefMaster",
                "id": 179599,
                "node_id": "MDQ6VXNlcjE3OTU5OQ==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/179599?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ThiefMaster",
                "html_url": "https://github.com/ThiefMaster",
                "followers_url": "https://api.github.com/users/ThiefMaster/followers",
                "following_url": "https://api.github.com/users/ThiefMaster/following{/other_user}",
                "gists_url": "https://api.github.com/users/ThiefMaster/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ThiefMaster/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ThiefMaster/subscriptions",
                "organizations_url": "https://api.github.com/users/ThiefMaster/orgs",
                "repos_url": "https://api.github.com/users/ThiefMaster/repos",
                "events_url": "https://api.github.com/users/ThiefMaster/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ThiefMaster/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-09-14T08:36:32Z",
            "updated_at": "2015-09-14T08:36:32Z",
            "author_association": "MEMBER",
            "body": "I think you have some leftovers from failed merges with upstream in there. Check the diff and remove anything that's not actually related to your PR (and maybe try to switch to a <=51-char first line in the commit message when committing it again)\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/142237179",
            "html_url": "https://github.com/pallets/flask/pull/1568#issuecomment-142237179",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1568",
            "id": 142237179,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE0MjIzNzE3OQ==",
            "user": {
                "login": "rawrgulmuffins",
                "id": 1521575,
                "node_id": "MDQ6VXNlcjE1MjE1NzU=",
                "avatar_url": "https://avatars0.githubusercontent.com/u/1521575?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/rawrgulmuffins",
                "html_url": "https://github.com/rawrgulmuffins",
                "followers_url": "https://api.github.com/users/rawrgulmuffins/followers",
                "following_url": "https://api.github.com/users/rawrgulmuffins/following{/other_user}",
                "gists_url": "https://api.github.com/users/rawrgulmuffins/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/rawrgulmuffins/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rawrgulmuffins/subscriptions",
                "organizations_url": "https://api.github.com/users/rawrgulmuffins/orgs",
                "repos_url": "https://api.github.com/users/rawrgulmuffins/repos",
                "events_url": "https://api.github.com/users/rawrgulmuffins/events{/privacy}",
                "received_events_url": "https://api.github.com/users/rawrgulmuffins/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-09-22T10:13:37Z",
            "updated_at": "2015-09-22T10:19:25Z",
            "author_association": "NONE",
            "body": "I rebased against master and re-added my changes. Looks like I missed a couple of wonky space changes, in `app.py`. I also changed to a hashing check rather than a iteration check.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/142239623",
            "html_url": "https://github.com/pallets/flask/pull/1568#issuecomment-142239623",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1568",
            "id": 142239623,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE0MjIzOTYyMw==",
            "user": {
                "login": "rawrgulmuffins",
                "id": 1521575,
                "node_id": "MDQ6VXNlcjE1MjE1NzU=",
                "avatar_url": "https://avatars0.githubusercontent.com/u/1521575?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/rawrgulmuffins",
                "html_url": "https://github.com/rawrgulmuffins",
                "followers_url": "https://api.github.com/users/rawrgulmuffins/followers",
                "following_url": "https://api.github.com/users/rawrgulmuffins/following{/other_user}",
                "gists_url": "https://api.github.com/users/rawrgulmuffins/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/rawrgulmuffins/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/rawrgulmuffins/subscriptions",
                "organizations_url": "https://api.github.com/users/rawrgulmuffins/orgs",
                "repos_url": "https://api.github.com/users/rawrgulmuffins/repos",
                "events_url": "https://api.github.com/users/rawrgulmuffins/events{/privacy}",
                "received_events_url": "https://api.github.com/users/rawrgulmuffins/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-09-22T10:19:19Z",
            "updated_at": "2015-09-22T10:19:19Z",
            "author_association": "NONE",
            "body": "The last commit was to add some in-line comments that got dropped when I re-added the changes.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/296999252",
            "html_url": "https://github.com/pallets/flask/pull/1568#issuecomment-296999252",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1568",
            "id": 296999252,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI5Njk5OTI1Mg==",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-04-25T11:20:49Z",
            "updated_at": "2017-04-25T11:20:49Z",
            "author_association": "MEMBER",
            "body": "In principle I support a mechanism that detects and prevents shadowing of other\nURL rules, but this implementation isn't acceptable due to a few reasons:\n\n- The static path is hardcoded for some special casing\n- `prior_rules` will only be updated if the app registers its routes the\n  \"normal\" way. It is possible for those two datastructures to get out of sync\n  when the app dev modifies them directly, which is still practiced sometimes.\n- Unrelated code reformatting, not a minimal diff\n\nOn Mon, Apr 24, 2017 at 10:25:06AM -0700, David Lord wrote:\n> @davidism requested your review on: pallets/flask#1568 Url conflict assert.\n> \n> -- \n> You are receiving this because you were mentioned.\n> Reply to this email directly or view it on GitHub:\n> https://github.com/pallets/flask/pull/1568#event-1055212408\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/296999377",
            "html_url": "https://github.com/pallets/flask/pull/1568#issuecomment-296999377",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1568",
            "id": 296999377,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI5Njk5OTM3Nw==",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-04-25T11:21:23Z",
            "updated_at": "2017-04-25T11:21:23Z",
            "author_association": "MEMBER",
            "body": "I will just close this since it's also unclear to me how a better implementation could look like."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/296999984",
            "html_url": "https://github.com/pallets/flask/pull/1568#issuecomment-296999984",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1568",
            "id": 296999984,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI5Njk5OTk4NA==",
            "user": {
                "login": "ThiefMaster",
                "id": 179599,
                "node_id": "MDQ6VXNlcjE3OTU5OQ==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/179599?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ThiefMaster",
                "html_url": "https://github.com/ThiefMaster",
                "followers_url": "https://api.github.com/users/ThiefMaster/followers",
                "following_url": "https://api.github.com/users/ThiefMaster/following{/other_user}",
                "gists_url": "https://api.github.com/users/ThiefMaster/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ThiefMaster/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ThiefMaster/subscriptions",
                "organizations_url": "https://api.github.com/users/ThiefMaster/orgs",
                "repos_url": "https://api.github.com/users/ThiefMaster/repos",
                "events_url": "https://api.github.com/users/ThiefMaster/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ThiefMaster/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-04-25T11:24:38Z",
            "updated_at": "2017-04-25T11:25:06Z",
            "author_association": "MEMBER",
            "body": "Probably a \"better implementation\" should be in Werkzeug, not in Flask. i.e. fail when adding a conflicting rule to a url map"
        }
    ]
}