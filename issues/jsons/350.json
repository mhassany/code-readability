{
    "url": "https://api.github.com/repos/pallets/flask/issues/350",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/350/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/350/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/350/events",
    "html_url": "https://github.com/pallets/flask/issues/350",
    "id": 2272367,
    "node_id": "MDU6SXNzdWUyMjcyMzY3",
    "number": 350,
    "title": "Endless redirect loop in flask 0.7.2",
    "user": {
        "login": "jssebastian",
        "id": 1202714,
        "node_id": "MDQ6VXNlcjEyMDI3MTQ=",
        "avatar_url": "https://avatars0.githubusercontent.com/u/1202714?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jssebastian",
        "html_url": "https://github.com/jssebastian",
        "followers_url": "https://api.github.com/users/jssebastian/followers",
        "following_url": "https://api.github.com/users/jssebastian/following{/other_user}",
        "gists_url": "https://api.github.com/users/jssebastian/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/jssebastian/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jssebastian/subscriptions",
        "organizations_url": "https://api.github.com/users/jssebastian/orgs",
        "repos_url": "https://api.github.com/users/jssebastian/repos",
        "events_url": "https://api.github.com/users/jssebastian/events{/privacy}",
        "received_events_url": "https://api.github.com/users/jssebastian/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 1,
    "created_at": "2011-11-17T19:02:45Z",
    "updated_at": "2011-11-20T16:05:17Z",
    "closed_at": "2011-11-20T16:05:17Z",
    "author_association": "NONE",
    "body": "Not sure if this is already fixed in the latest release. Seems related to this discussion:\n\nhttp://librelist.com/browser//flask/2011/6/29/psa-routing-redirect-behavior/\n\n..but this was apparently fixed in 0.7.1. \n\nI am getting an endless redirect loop when doing the following:\n\n``` python\n@app.route('/loop', defaults={\"a\":\"Hello\", \"b\":\"World\"})\n@app.route('/loop.<b>', defaults={\"a\":\"Hello\"})\n@app.route('/loop/<a>', defaults={\"b\":\"World\"})\n@app.route('/loop/<a>.<b>')\ndef endless_loop(a, b):\n    return \"%s %s\" % (a, b)\n```\n\n(In case you are interested, in my application b is a file extension that specifies my API's output format)\n\nThis is what happens when you visit /loop:\n\n127.0.0.1 - - [16/Nov/2011 17:16:35] \"GET /loop HTTP/1.1\" 301 -\n127.0.0.1 - - [16/Nov/2011 17:16:35] \"GET /loop.World HTTP/1.1\" 301 -\n127.0.0.1 - - [16/Nov/2011 17:16:35] \"GET /loop HTTP/1.1\" 301 -\n127.0.0.1 - - [16/Nov/2011 17:16:35] \"GET /loop.World HTTP/1.1\" 301 -\n\nA good workaround for my use case was to simply disable the redirection for defaults:\n\n``` python\napp.url_map.redirect_defaults = False\n```\n\nThis is ok in my case since I am developing an API that does not need or want to be indexed by search engines, but for normal websites it would be suboptimal.\n\nThe smallest test case I could produce that triggers the bug is the following:\n\n``` python\n@app.route('/loop2', defaults={\"a\":\"Hello\", \"b\":\"World\"}) \n@app.route('/loop2/<a>', defaults={\"b\":\"World\"})\ndef endless_loop2(a, b):\n    return \"%s %s\" % (a, b)\n```\n\n127.0.0.1 - - [16/Nov/2011 17:15:31] \"GET /loop2 HTTP/1.1\" 301 -\n127.0.0.1 - - [16/Nov/2011 17:15:31] \"GET /loop2/Hello HTTP/1.1\" 301 -\n127.0.0.1 - - [16/Nov/2011 17:15:31] \"GET /loop2 HTTP/1.1\" 301 -\n127.0.0.1 - - [16/Nov/2011 17:15:31] \"GET /loop2/Hello HTTP/1.1\" 301 -\n\nI am running the packaged version of flask from ubuntu oneiric:\n\npython-flask 0.7.2-1\npython-werkzeug 0.6.2-1\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/2804485",
            "html_url": "https://github.com/pallets/flask/issues/350#issuecomment-2804485",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/350",
            "id": 2804485,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI4MDQ0ODU=",
            "user": {
                "login": "mitsuhiko",
                "id": 7396,
                "node_id": "MDQ6VXNlcjczOTY=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/7396?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/mitsuhiko",
                "html_url": "https://github.com/mitsuhiko",
                "followers_url": "https://api.github.com/users/mitsuhiko/followers",
                "following_url": "https://api.github.com/users/mitsuhiko/following{/other_user}",
                "gists_url": "https://api.github.com/users/mitsuhiko/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/mitsuhiko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mitsuhiko/subscriptions",
                "organizations_url": "https://api.github.com/users/mitsuhiko/orgs",
                "repos_url": "https://api.github.com/users/mitsuhiko/repos",
                "events_url": "https://api.github.com/users/mitsuhiko/events{/privacy}",
                "received_events_url": "https://api.github.com/users/mitsuhiko/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2011-11-20T15:58:53Z",
            "updated_at": "2011-11-20T15:58:53Z",
            "author_association": "MEMBER",
            "body": "> ..but this was apparently fixed in 0.7.1. \n\nFlask 0.7.0 had an issue with a change we did in Werkzeug before 0.7. However the problem you're experiencing is one that is not caused by Flask but by Werkzeug and it was fixed in in Werkzeug 0.7. Upgrading should fix the issue.\n"
        }
    ]
}