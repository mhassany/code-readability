{
    "url": "https://api.github.com/repos/pallets/flask/issues/2550",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/2550/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/2550/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/2550/events",
    "html_url": "https://github.com/pallets/flask/issues/2550",
    "id": 281827799,
    "node_id": "MDU6SXNzdWUyODE4Mjc3OTk=",
    "number": 2550,
    "title": "Some of tests fail on running pytest",
    "user": {
        "login": "djmgit",
        "id": 16368427,
        "node_id": "MDQ6VXNlcjE2MzY4NDI3",
        "avatar_url": "https://avatars0.githubusercontent.com/u/16368427?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/djmgit",
        "html_url": "https://github.com/djmgit",
        "followers_url": "https://api.github.com/users/djmgit/followers",
        "following_url": "https://api.github.com/users/djmgit/following{/other_user}",
        "gists_url": "https://api.github.com/users/djmgit/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/djmgit/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/djmgit/subscriptions",
        "organizations_url": "https://api.github.com/users/djmgit/orgs",
        "repos_url": "https://api.github.com/users/djmgit/repos",
        "events_url": "https://api.github.com/users/djmgit/events{/privacy}",
        "received_events_url": "https://api.github.com/users/djmgit/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 10,
    "created_at": "2017-12-13T17:12:09Z",
    "updated_at": "2017-12-14T22:12:34Z",
    "closed_at": "2017-12-14T22:12:34Z",
    "author_association": "NONE",
    "body": "### Expected Behavior\r\n\r\nOn running ```pytest``` all tests should pass.\r\n\r\nTo reproduce please execute ``` pytest ```\r\n### Actual Behavior\r\n\r\n5 tests fail \r\n\r\nHere is the full output of pytest: https://paste.ubuntu.com/26177622/\r\n\r\n### Environment\r\n\r\n* Python version: 3.5.2\r\n\r\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/351458504",
            "html_url": "https://github.com/pallets/flask/issues/2550#issuecomment-351458504",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2550",
            "id": 351458504,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM1MTQ1ODUwNA==",
            "user": {
                "login": "djmgit",
                "id": 16368427,
                "node_id": "MDQ6VXNlcjE2MzY4NDI3",
                "avatar_url": "https://avatars0.githubusercontent.com/u/16368427?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/djmgit",
                "html_url": "https://github.com/djmgit",
                "followers_url": "https://api.github.com/users/djmgit/followers",
                "following_url": "https://api.github.com/users/djmgit/following{/other_user}",
                "gists_url": "https://api.github.com/users/djmgit/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/djmgit/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/djmgit/subscriptions",
                "organizations_url": "https://api.github.com/users/djmgit/orgs",
                "repos_url": "https://api.github.com/users/djmgit/repos",
                "events_url": "https://api.github.com/users/djmgit/events{/privacy}",
                "received_events_url": "https://api.github.com/users/djmgit/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-12-13T17:13:03Z",
            "updated_at": "2017-12-13T17:13:03Z",
            "author_association": "NONE",
            "body": "I would like to work on this, any pointers regarding from where to start would be of great help.\r\nI have build Flask from master branch."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/351460324",
            "html_url": "https://github.com/pallets/flask/issues/2550#issuecomment-351460324",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2550",
            "id": 351460324,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM1MTQ2MDMyNA==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-12-13T17:19:10Z",
            "updated_at": "2017-12-13T17:20:42Z",
            "author_association": "MEMBER",
            "body": "Right, I noticed this too. A recent PyTest update added automatic capture of log messages. To do this, I think they add a handler to the root logger. Flask only adds a handler to its logger if there are no loggers already registered, so it fails to add its default logger that these tests expect.\r\n\r\nThe ideal fix here is to disable logging capture for these tests, although I haven't looked into how PyTest handles this yet.\r\n\r\ncc @RonnyPfannschmidt"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/351598547",
            "html_url": "https://github.com/pallets/flask/issues/2550#issuecomment-351598547",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2550",
            "id": 351598547,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM1MTU5ODU0Nw==",
            "user": {
                "login": "camilojimenez",
                "id": 7208620,
                "node_id": "MDQ6VXNlcjcyMDg2MjA=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/7208620?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/camilojimenez",
                "html_url": "https://github.com/camilojimenez",
                "followers_url": "https://api.github.com/users/camilojimenez/followers",
                "following_url": "https://api.github.com/users/camilojimenez/following{/other_user}",
                "gists_url": "https://api.github.com/users/camilojimenez/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/camilojimenez/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/camilojimenez/subscriptions",
                "organizations_url": "https://api.github.com/users/camilojimenez/orgs",
                "repos_url": "https://api.github.com/users/camilojimenez/repos",
                "events_url": "https://api.github.com/users/camilojimenez/events{/privacy}",
                "received_events_url": "https://api.github.com/users/camilojimenez/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-12-14T03:31:36Z",
            "updated_at": "2017-12-14T03:31:36Z",
            "author_association": "CONTRIBUTOR",
            "body": "I tracked the issue to this release of pytest\r\n\r\nhttps://github.com/pytest-dev/pytest/blob/6cdd85122705393cfcfe08570bae581bf9f2d157/CHANGELOG.rst\r\n\r\nAccording to the changelog:\r\n\r\n- Pytest now captures and displays output from the standard logging module. The user can control the logging level to be captured by specifying options in pytest.ini, the command line and also during individual tests using markers. Also, a caplog fixture is available that enables users to test the captured log during specific tests (similar to capsys for example). For more information, please see the logging docs. This feature was introduced by merging the popular pytest-catchlog plugin, thanks to Thomas Hisch. Be advised that during the merging the backward compatibility interface with the defunct pytest-capturelog has been dropped. (#2794)\r\n\r\nThe actual logging code is here\r\n\r\nhttps://github.com/pytest-dev/pytest/blob/6cdd85122705393cfcfe08570bae581bf9f2d157/_pytest/logging.py#L259\r\n\r\nI skimmed over the logging code and could not find any way to disable logging capture in a documented way.\r\n\r\nWhat are the thoughts about\r\n\r\n- Pinning the pytest version to 3.2.5\r\n- Updating the test to support this\r\n- Write a setup/teardown method to remove any existent loggers\r\n\r\n\r\n\r\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/351598992",
            "html_url": "https://github.com/pallets/flask/issues/2550#issuecomment-351598992",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2550",
            "id": 351598992,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM1MTU5ODk5Mg==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-12-14T03:35:01Z",
            "updated_at": "2017-12-14T03:35:01Z",
            "author_association": "MEMBER",
            "body": "I would go with option three. It should work out similar to some other tests in that module that modify the handlers."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/351610677",
            "html_url": "https://github.com/pallets/flask/issues/2550#issuecomment-351610677",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2550",
            "id": 351610677,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM1MTYxMDY3Nw==",
            "user": {
                "login": "camilojimenez",
                "id": 7208620,
                "node_id": "MDQ6VXNlcjcyMDg2MjA=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/7208620?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/camilojimenez",
                "html_url": "https://github.com/camilojimenez",
                "followers_url": "https://api.github.com/users/camilojimenez/followers",
                "following_url": "https://api.github.com/users/camilojimenez/following{/other_user}",
                "gists_url": "https://api.github.com/users/camilojimenez/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/camilojimenez/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/camilojimenez/subscriptions",
                "organizations_url": "https://api.github.com/users/camilojimenez/orgs",
                "repos_url": "https://api.github.com/users/camilojimenez/repos",
                "events_url": "https://api.github.com/users/camilojimenez/events{/privacy}",
                "received_events_url": "https://api.github.com/users/camilojimenez/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-12-14T05:11:10Z",
            "updated_at": "2017-12-14T05:15:24Z",
            "author_association": "CONTRIBUTOR",
            "body": "The following changes the test to green. Does this seem like an appropriate solution?\r\n\r\n~~~~\r\n@pytest.fixture\r\ndef no_logging_handlers(app):\r\n    logging.root.handlers[:] = []\r\n    app.logger\r\n\r\ndef test_logger(app, no_logging_handlers):\r\n    assert app.logger.name == 'flask.app'\r\n    assert app.logger.level == logging.NOTSET\r\n    assert app.logger.handlers == [default_handler]\r\n~~~~\r\n\r\nI can prepare the PR once approved"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/351615322",
            "html_url": "https://github.com/pallets/flask/issues/2550#issuecomment-351615322",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2550",
            "id": 351615322,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM1MTYxNTMyMg==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-12-14T05:48:13Z",
            "updated_at": "2017-12-14T05:48:13Z",
            "author_association": "MEMBER",
            "body": "Refer to the `reset_logging` fixture. It can probably be changed to clear and restore the root handlers."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/351615641",
            "html_url": "https://github.com/pallets/flask/issues/2550#issuecomment-351615641",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2550",
            "id": 351615641,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM1MTYxNTY0MQ==",
            "user": {
                "login": "camilojimenez",
                "id": 7208620,
                "node_id": "MDQ6VXNlcjcyMDg2MjA=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/7208620?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/camilojimenez",
                "html_url": "https://github.com/camilojimenez",
                "followers_url": "https://api.github.com/users/camilojimenez/followers",
                "following_url": "https://api.github.com/users/camilojimenez/following{/other_user}",
                "gists_url": "https://api.github.com/users/camilojimenez/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/camilojimenez/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/camilojimenez/subscriptions",
                "organizations_url": "https://api.github.com/users/camilojimenez/orgs",
                "repos_url": "https://api.github.com/users/camilojimenez/repos",
                "events_url": "https://api.github.com/users/camilojimenez/events{/privacy}",
                "received_events_url": "https://api.github.com/users/camilojimenez/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-12-14T05:50:48Z",
            "updated_at": "2017-12-14T05:50:48Z",
            "author_association": "CONTRIBUTOR",
            "body": "I thought of doing that, but this would clear and restore the handlers for every test. Is this preferred?"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/351615870",
            "html_url": "https://github.com/pallets/flask/issues/2550#issuecomment-351615870",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2550",
            "id": 351615870,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM1MTYxNTg3MA==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-12-14T05:52:29Z",
            "updated_at": "2017-12-14T05:52:29Z",
            "author_association": "MEMBER",
            "body": "I don't know, I'm not looking into it directly because @djmgit offered to do so, then you started to. Do you want me to write this instead?"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/351616312",
            "html_url": "https://github.com/pallets/flask/issues/2550#issuecomment-351616312",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2550",
            "id": 351616312,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM1MTYxNjMxMg==",
            "user": {
                "login": "camilojimenez",
                "id": 7208620,
                "node_id": "MDQ6VXNlcjcyMDg2MjA=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/7208620?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/camilojimenez",
                "html_url": "https://github.com/camilojimenez",
                "followers_url": "https://api.github.com/users/camilojimenez/followers",
                "following_url": "https://api.github.com/users/camilojimenez/following{/other_user}",
                "gists_url": "https://api.github.com/users/camilojimenez/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/camilojimenez/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/camilojimenez/subscriptions",
                "organizations_url": "https://api.github.com/users/camilojimenez/orgs",
                "repos_url": "https://api.github.com/users/camilojimenez/repos",
                "events_url": "https://api.github.com/users/camilojimenez/events{/privacy}",
                "received_events_url": "https://api.github.com/users/camilojimenez/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-12-14T05:55:58Z",
            "updated_at": "2017-12-14T05:55:58Z",
            "author_association": "CONTRIBUTOR",
            "body": "Also, I need to call app.logger to force logger creation before the pytest logger gets added. That would require changing the signature from \r\n\r\n~~~~\r\ndef reset_logging(monkeypatch)\r\n\r\nto\r\n\r\ndef reset_logging(monkeypatch, app)\r\n~~~~\r\n\r\nI apologize if I am asking too many questions. I'll prepare the PR now"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/351620169",
            "html_url": "https://github.com/pallets/flask/issues/2550#issuecomment-351620169",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2550",
            "id": 351620169,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM1MTYyMDE2OQ==",
            "user": {
                "login": "djmgit",
                "id": 16368427,
                "node_id": "MDQ6VXNlcjE2MzY4NDI3",
                "avatar_url": "https://avatars0.githubusercontent.com/u/16368427?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/djmgit",
                "html_url": "https://github.com/djmgit",
                "followers_url": "https://api.github.com/users/djmgit/followers",
                "following_url": "https://api.github.com/users/djmgit/following{/other_user}",
                "gists_url": "https://api.github.com/users/djmgit/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/djmgit/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/djmgit/subscriptions",
                "organizations_url": "https://api.github.com/users/djmgit/orgs",
                "repos_url": "https://api.github.com/users/djmgit/repos",
                "events_url": "https://api.github.com/users/djmgit/events{/privacy}",
                "received_events_url": "https://api.github.com/users/djmgit/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-12-14T06:23:30Z",
            "updated_at": "2017-12-14T06:23:30Z",
            "author_association": "NONE",
            "body": "@camilojimenez @davidism please go ahead with this issue, I would love collaborating as well.\r\n@camilojimenez I tried your solution, it solves 1 error, still its showing 4 errors."
        }
    ]
}