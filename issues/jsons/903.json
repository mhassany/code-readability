{
    "url": "https://api.github.com/repos/pallets/flask/issues/903",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/903/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/903/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/903/events",
    "html_url": "https://github.com/pallets/flask/issues/903",
    "id": 22066857,
    "node_id": "MDU6SXNzdWUyMjA2Njg1Nw==",
    "number": 903,
    "title": "How to generate a SecureCookie in latest version?",
    "user": {
        "login": "seaders",
        "id": 955114,
        "node_id": "MDQ6VXNlcjk1NTExNA==",
        "avatar_url": "https://avatars3.githubusercontent.com/u/955114?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/seaders",
        "html_url": "https://github.com/seaders",
        "followers_url": "https://api.github.com/users/seaders/followers",
        "following_url": "https://api.github.com/users/seaders/following{/other_user}",
        "gists_url": "https://api.github.com/users/seaders/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/seaders/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/seaders/subscriptions",
        "organizations_url": "https://api.github.com/users/seaders/orgs",
        "repos_url": "https://api.github.com/users/seaders/repos",
        "events_url": "https://api.github.com/users/seaders/events{/privacy}",
        "received_events_url": "https://api.github.com/users/seaders/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 4,
    "created_at": "2013-11-04T17:41:55Z",
    "updated_at": "2013-11-14T19:11:16Z",
    "closed_at": "2013-11-14T19:11:16Z",
    "author_association": "NONE",
    "body": "With Flask 0.9 and Werkzeug 0.8.3 I was able to test many of our functions by creating a SecureCookie with\n\n```\nfrom werkzeug.contrib.securecookie import SecureCookie\nsession = SecureCookie(dict(uid=uid), app.secret_key).serialize()\n```\n\nBut that now gives me an empty session when we get to the request function, even though\n\n```\n    SecureCookie.unserialize(request.cookies['session'], app.config['SECRET_KEY'])\n```\n\ngives the correct dict that was passed through.\n\nI tried to figure it out from the source, but couldn't quite get the gist of it.\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/27826921",
            "html_url": "https://github.com/pallets/flask/issues/903#issuecomment-27826921",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/903",
            "id": 27826921,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI3ODI2OTIx",
            "user": {
                "login": "pengfei-xue",
                "id": 1533151,
                "node_id": "MDQ6VXNlcjE1MzMxNTE=",
                "avatar_url": "https://avatars2.githubusercontent.com/u/1533151?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/pengfei-xue",
                "html_url": "https://github.com/pengfei-xue",
                "followers_url": "https://api.github.com/users/pengfei-xue/followers",
                "following_url": "https://api.github.com/users/pengfei-xue/following{/other_user}",
                "gists_url": "https://api.github.com/users/pengfei-xue/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/pengfei-xue/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/pengfei-xue/subscriptions",
                "organizations_url": "https://api.github.com/users/pengfei-xue/orgs",
                "repos_url": "https://api.github.com/users/pengfei-xue/repos",
                "events_url": "https://api.github.com/users/pengfei-xue/events{/privacy}",
                "received_events_url": "https://api.github.com/users/pengfei-xue/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2013-11-06T00:12:31Z",
            "updated_at": "2013-11-06T00:12:31Z",
            "author_association": "CONTRIBUTOR",
            "body": "you should use session instead of retrieve `session` from `request.cookies`, take a look at this:  [flask session](http://flask.pocoo.org/docs/quickstart/#sessions) . You can get your session by:\n\n```\nss = SecureCookie.unserialize(session['uid'], app.config['SECRET_KEY'])\n```\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/27827754",
            "html_url": "https://github.com/pallets/flask/issues/903#issuecomment-27827754",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/903",
            "id": 27827754,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI3ODI3NzU0",
            "user": {
                "login": "seaders",
                "id": 955114,
                "node_id": "MDQ6VXNlcjk1NTExNA==",
                "avatar_url": "https://avatars3.githubusercontent.com/u/955114?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/seaders",
                "html_url": "https://github.com/seaders",
                "followers_url": "https://api.github.com/users/seaders/followers",
                "following_url": "https://api.github.com/users/seaders/following{/other_user}",
                "gists_url": "https://api.github.com/users/seaders/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/seaders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/seaders/subscriptions",
                "organizations_url": "https://api.github.com/users/seaders/orgs",
                "repos_url": "https://api.github.com/users/seaders/repos",
                "events_url": "https://api.github.com/users/seaders/events{/privacy}",
                "received_events_url": "https://api.github.com/users/seaders/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2013-11-06T00:28:50Z",
            "updated_at": "2013-11-06T00:28:50Z",
            "author_association": "NONE",
            "body": "Thanks for the reply penfei, but that's not what I'm asking.  I _do_ get my session via\n    from flask import session\n\nBut after a call from my testing client (where I create the cookie, and attach it to the http request), that session shows up as empty, but if I unserialise the cookie, using SecureCookie everything is as it should be.\n\nAs I said, this all worked fine with older Flask and Werkzeug, but it's not working now.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/27842842",
            "html_url": "https://github.com/pallets/flask/issues/903#issuecomment-27842842",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/903",
            "id": 27842842,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI3ODQyODQy",
            "user": {
                "login": "pengfei-xue",
                "id": 1533151,
                "node_id": "MDQ6VXNlcjE1MzMxNTE=",
                "avatar_url": "https://avatars2.githubusercontent.com/u/1533151?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/pengfei-xue",
                "html_url": "https://github.com/pengfei-xue",
                "followers_url": "https://api.github.com/users/pengfei-xue/followers",
                "following_url": "https://api.github.com/users/pengfei-xue/following{/other_user}",
                "gists_url": "https://api.github.com/users/pengfei-xue/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/pengfei-xue/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/pengfei-xue/subscriptions",
                "organizations_url": "https://api.github.com/users/pengfei-xue/orgs",
                "repos_url": "https://api.github.com/users/pengfei-xue/repos",
                "events_url": "https://api.github.com/users/pengfei-xue/events{/privacy}",
                "received_events_url": "https://api.github.com/users/pengfei-xue/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2013-11-06T04:46:15Z",
            "updated_at": "2013-11-06T05:16:14Z",
            "author_association": "CONTRIBUTOR",
            "body": "o, i see where is your problem, actually flask will use `itsdangerous` to sign it's session, so if you try to issue a request with cookies `session=xxx`  directly (where xxx is got by `session = SecureCookie(dict(uid=uid), app.secret_key).serialize()`), you will fail.\n\nyou can take a look at `flask.sessions.SecureCookieSessionInterface.open_session`, this method is different between 0.9 and 0.10.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/28035228",
            "html_url": "https://github.com/pallets/flask/issues/903#issuecomment-28035228",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/903",
            "id": 28035228,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI4MDM1MjI4",
            "user": {
                "login": "seaders",
                "id": 955114,
                "node_id": "MDQ6VXNlcjk1NTExNA==",
                "avatar_url": "https://avatars3.githubusercontent.com/u/955114?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/seaders",
                "html_url": "https://github.com/seaders",
                "followers_url": "https://api.github.com/users/seaders/followers",
                "following_url": "https://api.github.com/users/seaders/following{/other_user}",
                "gists_url": "https://api.github.com/users/seaders/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/seaders/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/seaders/subscriptions",
                "organizations_url": "https://api.github.com/users/seaders/orgs",
                "repos_url": "https://api.github.com/users/seaders/repos",
                "events_url": "https://api.github.com/users/seaders/events{/privacy}",
                "received_events_url": "https://api.github.com/users/seaders/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2013-11-08T04:35:58Z",
            "updated_at": "2013-11-08T04:35:58Z",
            "author_association": "NONE",
            "body": "Got it, thanks pengfei!  I didn't use 'open_session' as I'm using my own method of the http requests, so I only wanted the encrypted cookie and used the method below, working perfectly.\n\n```\nclass DummyApp():\n    secret_key = config.SECRET_KEY\n\ns = SecureCookieSessionInterface().get_signing_serializer(DummyApp())\nsession = s.dumps(dict(uid=uid))\n```\n"
        }
    ]
}