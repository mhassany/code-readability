{
    "url": "https://api.github.com/repos/pallets/flask/issues/2391",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/2391/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/2391/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/2391/events",
    "html_url": "https://github.com/pallets/flask/issues/2391",
    "id": 238280198,
    "node_id": "MDU6SXNzdWUyMzgyODAxOTg=",
    "number": 2391,
    "title": "Flask fails silently when it does not have permission to SSL cert/key files",
    "user": {
        "login": "pilliq",
        "id": 484926,
        "node_id": "MDQ6VXNlcjQ4NDkyNg==",
        "avatar_url": "https://avatars3.githubusercontent.com/u/484926?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pilliq",
        "html_url": "https://github.com/pilliq",
        "followers_url": "https://api.github.com/users/pilliq/followers",
        "following_url": "https://api.github.com/users/pilliq/following{/other_user}",
        "gists_url": "https://api.github.com/users/pilliq/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/pilliq/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/pilliq/subscriptions",
        "organizations_url": "https://api.github.com/users/pilliq/orgs",
        "repos_url": "https://api.github.com/users/pilliq/repos",
        "events_url": "https://api.github.com/users/pilliq/events{/privacy}",
        "received_events_url": "https://api.github.com/users/pilliq/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 1,
    "created_at": "2017-06-24T00:17:13Z",
    "updated_at": "2017-06-24T00:37:36Z",
    "closed_at": "2017-06-24T00:37:36Z",
    "author_association": "NONE",
    "body": "Running Flask with an SSL context that uses cert files which the process does not have permission to results in a silent fail on the server.\r\n\r\nAllowing the process to have access to the files fixes this problem.\r\n\r\nServer code used:\r\n```python\r\nfrom flask import Flask\r\n\r\napp = Flask(__name__)\r\n\r\n@app.route('/')\r\ndef hello:\r\n    return 'hi'\r\n\r\nif __name__ == '__main__':\r\n    context = ('/path/to/cert.pem','/path/to/key.pem')\r\n    app.run(debug=True, ssl_context=context)\r\n```\r\n\r\n### Expected Behavior\r\nA stack saying the process cannot access the cert files. Ideally this trace would appear during startup before the first request is made.\r\n\r\nFor example, when using pyopenssl with the same files, the following trace is thrown on startup:\r\n\r\n```pytb\r\nTraceback (most recent call last):\r\n  File \"server.py\", line 20, in <module>\r\n    context.use_privatekey_file('/path/to/private/key.pem')\r\n  File \"/home/user/.virtualenvs/dev/local/lib/python2.7/site-packages/OpenSSL/SSL.py\", line 798, in use_privatekey_file\r\n    self._raise_passphrase_exception()\r\n  File \"/home/user/.virtualenvs/dev/local/lib/python2.7/site-packages/OpenSSL/SSL.py\", line 777, in _raise_passphrase_exception\r\n    _raise_current_error()\r\n  File \"/home/user/.virtualenvs/dev/local/lib/python2.7/site-packages/OpenSSL/_util.py\", line 54, in exception_from_error_queue\r\n    raise exception_type(errors)\r\nOpenSSL.SSL.Error: [('system library', 'fopen', 'Permission denied'), ('BIO routines', 'FILE_CTRL', 'system lib'), ('SSL routines', 'SSL_CTX_use_PrivateKey_file', 'system lib')]\r\n```\r\n\r\n### Actual Behavior\r\n\r\nAfter a request, the server returns a 200 response and disconnects the socket:\r\n\r\n- `curl` clients receive a 200 and then throw errno 35 (Unknown SSL protocol error in connection to [secure site]:443).\r\n\r\n- `nc` clients return a 200 and immediately disconnect.\r\n\r\n- Web browsers report the following error:\r\n<img width=\"645\" alt=\"screenshot 2017-06-24 09 53 44\" src=\"https://user-images.githubusercontent.com/484926/27503820-94e6307c-58c3-11e7-8532-ebf58700fce1.png\">\r\n\r\n\r\nWhat makes this problem worse is that Flask does not acknowledge that an attempted connection was made. Throughout all three of the above requests this is all that Flask printed in debug mode:\r\n\r\n```\r\n * Running on https://0.0.0.0:5000/ (Press CTRL+C to quit)\r\n * Restarting with stat\r\n * Debugger is active!\r\n * Debugger pin code: 000-000-000\r\n```\r\n\r\n### Environment\r\n\r\n* Python version: 2.7.6\r\n* Flask version: 0.12.2 (also tested on 0.10.1)\r\n* Werkzeug version: 0.12.2 (also tested on 0.11.5)\r\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/310801601",
            "html_url": "https://github.com/pallets/flask/issues/2391#issuecomment-310801601",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2391",
            "id": 310801601,
            "node_id": "MDEyOklzc3VlQ29tbWVudDMxMDgwMTYwMQ==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-06-24T00:37:36Z",
            "updated_at": "2017-06-24T00:37:36Z",
            "author_association": "MEMBER",
            "body": "Please report this against Werkzeug."
        }
    ]
}