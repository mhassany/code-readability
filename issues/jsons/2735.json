{
    "url": "https://api.github.com/repos/pallets/flask/issues/2735",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/2735/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/2735/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/2735/events",
    "html_url": "https://github.com/pallets/flask/issues/2735",
    "id": 318458449,
    "node_id": "MDU6SXNzdWUzMTg0NTg0NDk=",
    "number": 2735,
    "title": "flask.abort() behavioral change in debug mode",
    "user": {
        "login": "pypingou",
        "id": 1240038,
        "node_id": "MDQ6VXNlcjEyNDAwMzg=",
        "avatar_url": "https://avatars1.githubusercontent.com/u/1240038?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/pypingou",
        "html_url": "https://github.com/pypingou",
        "followers_url": "https://api.github.com/users/pypingou/followers",
        "following_url": "https://api.github.com/users/pypingou/following{/other_user}",
        "gists_url": "https://api.github.com/users/pypingou/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/pypingou/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/pypingou/subscriptions",
        "organizations_url": "https://api.github.com/users/pypingou/orgs",
        "repos_url": "https://api.github.com/users/pypingou/repos",
        "events_url": "https://api.github.com/users/pypingou/events{/privacy}",
        "received_events_url": "https://api.github.com/users/pypingou/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 135583063,
            "node_id": "MDU6TGFiZWwxMzU1ODMwNjM=",
            "url": "https://api.github.com/repos/pallets/flask/labels/bug",
            "name": "bug",
            "color": "d93f0b",
            "default": true,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": {
        "url": "https://api.github.com/repos/pallets/flask/milestones/5",
        "html_url": "https://github.com/pallets/flask/milestone/5",
        "labels_url": "https://api.github.com/repos/pallets/flask/milestones/5/labels",
        "id": 3304290,
        "node_id": "MDk6TWlsZXN0b25lMzMwNDI5MA==",
        "number": 5,
        "title": "1.0.1",
        "description": "",
        "creator": {
            "login": "davidism",
            "id": 1242887,
            "node_id": "MDQ6VXNlcjEyNDI4ODc=",
            "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/davidism",
            "html_url": "https://github.com/davidism",
            "followers_url": "https://api.github.com/users/davidism/followers",
            "following_url": "https://api.github.com/users/davidism/following{/other_user}",
            "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
            "organizations_url": "https://api.github.com/users/davidism/orgs",
            "repos_url": "https://api.github.com/users/davidism/repos",
            "events_url": "https://api.github.com/users/davidism/events{/privacy}",
            "received_events_url": "https://api.github.com/users/davidism/received_events",
            "type": "User",
            "site_admin": false
        },
        "open_issues": 0,
        "closed_issues": 18,
        "state": "closed",
        "created_at": "2018-04-27T13:46:37Z",
        "updated_at": "2018-04-30T01:11:27Z",
        "due_on": null,
        "closed_at": "2018-04-30T01:11:27Z"
    },
    "comments": 4,
    "created_at": "2018-04-27T15:44:05Z",
    "updated_at": "2018-07-24T00:22:27Z",
    "closed_at": "2018-04-28T14:01:55Z",
    "author_association": "NONE",
    "body": "### Expected Behavior\r\n\r\nIn flask 1.0, calling flask.abort(400) returns a 500 error in debug mode\r\n\r\n```python\r\nimport flask\r\nimport werkzeug\r\n\r\nAPP = flask.Flask(__name__)\r\nprint(flask.__version__)\r\nprint(werkzeug.__version__)\r\n\r\n@APP.route('/<arg>')\r\ndef index(arg):\r\n    return flask.abort(400)\r\n\r\nAPP.debug = True\r\nAPP.run()\r\n```\r\n\r\n### Actual Behavior\r\n\r\nWhen ``App.debug = True`` is set:\r\n````\r\n127.0.0.1 - - [27/Apr/2018 17:39:16] \"GET /tes HTTP/1.1\" 500 -\r\nTraceback (most recent call last):\r\n  File \"/home/pingou/.local/share/virtualenvs/pag/lib/python2.7/site-packages/flask/app.py\", line 2301, in __call__\r\n    return self.wsgi_app(environ, start_response)\r\n  File \"/home/pingou/.local/share/virtualenvs/pag/lib/python2.7/site-packages/flask/app.py\", line 2287, in wsgi_app\r\n    response = self.handle_exception(e)\r\n  File \"/home/pingou/.local/share/virtualenvs/pag/lib/python2.7/site-packages/flask/app.py\", line 1733, in handle_exception\r\n    reraise(exc_type, exc_value, tb)\r\n  File \"/home/pingou/.local/share/virtualenvs/pag/lib/python2.7/site-packages/flask/app.py\", line 2284, in wsgi_app\r\n    response = self.full_dispatch_request()\r\n  File \"/home/pingou/.local/share/virtualenvs/pag/lib/python2.7/site-packages/flask/app.py\", line 1807, in full_dispatch_request\r\n    rv = self.handle_user_exception(e)\r\n  File \"/home/pingou/.local/share/virtualenvs/pag/lib/python2.7/site-packages/flask/app.py\", line 1710, in handle_user_exception\r\n    reraise(exc_type, exc_value, tb)\r\n  File \"/home/pingou/.local/share/virtualenvs/pag/lib/python2.7/site-packages/flask/app.py\", line 1805, in full_dispatch_request\r\n    rv = self.dispatch_request()\r\n  File \"/home/pingou/.local/share/virtualenvs/pag/lib/python2.7/site-packages/flask/app.py\", line 1791, in dispatch_request\r\n    return self.view_functions[rule.endpoint](**req.view_args)\r\n  File \"/home/pingou/reproducer.py\", line 12, in index\r\n    return flask.abort(400)\r\n  File \"/home/pingou/.local/share/virtualenvs/pag/lib/python2.7/site-packages/werkzeug/exceptions.py\", line 707, in abort\r\n    return _aborter(status, *args, **kwargs)\r\n  File \"/home/pingou/.local/share/virtualenvs/pag/lib/python2.7/site-packages/werkzeug/exceptions.py\", line 687, in __call__\r\n    raise self.mapping[code](*args, **kwargs)\r\nBadRequest: 400 Bad Request: The browser (or proxy) sent a request that this server could not understand.\r\n````\r\n\r\nCalling the endpoint via requests show:\r\n```\r\n>>> requests.get('http://127.0.0.1:5000/tes')\r\n<Response [500]>\r\n```\r\n\r\nWhen ``App.debug = True`` is commented out, I get the expected behavior:\r\n```\r\n>>> requests.get('http://127.0.0.1:5000/tes')\r\n<Response [400]>\r\n```\r\n\r\n### Environment\r\n\r\n* Python version: in this case 2.7.14\r\n* Flask version: 1.0\r\n* Werkzeug version: 0.14.1\r\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/385013717",
            "html_url": "https://github.com/pallets/flask/issues/2735#issuecomment-385013717",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2735",
            "id": 385013717,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTAxMzcxNw==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-04-27T15:53:48Z",
            "updated_at": "2018-04-27T15:53:48Z",
            "author_association": "MEMBER",
            "body": "Stop setting `app.debug` manually. Not sure if that's related, but don't do it anyway. Use the `FLASK_ENV=development` env var."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/385014411",
            "html_url": "https://github.com/pallets/flask/issues/2735#issuecomment-385014411",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2735",
            "id": 385014411,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTAxNDQxMQ==",
            "user": {
                "login": "lepture",
                "id": 290496,
                "node_id": "MDQ6VXNlcjI5MDQ5Ng==",
                "avatar_url": "https://avatars2.githubusercontent.com/u/290496?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/lepture",
                "html_url": "https://github.com/lepture",
                "followers_url": "https://api.github.com/users/lepture/followers",
                "following_url": "https://api.github.com/users/lepture/following{/other_user}",
                "gists_url": "https://api.github.com/users/lepture/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/lepture/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/lepture/subscriptions",
                "organizations_url": "https://api.github.com/users/lepture/orgs",
                "repos_url": "https://api.github.com/users/lepture/repos",
                "events_url": "https://api.github.com/users/lepture/events{/privacy}",
                "received_events_url": "https://api.github.com/users/lepture/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-04-27T15:56:11Z",
            "updated_at": "2018-04-27T15:56:11Z",
            "author_association": "MEMBER",
            "body": "@davidism It it still reproducible. I think it is a real bug."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/385078547",
            "html_url": "https://github.com/pallets/flask/issues/2735#issuecomment-385078547",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2735",
            "id": 385078547,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTA3ODU0Nw==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-04-27T20:00:10Z",
            "updated_at": "2018-04-27T20:00:10Z",
            "author_association": "MEMBER",
            "body": "This is due to #2348, which started trapping bad requests in debug mode, in order to help debug form data.\r\n\r\nhttps://github.com/pallets/flask/blob/ea316d232a00d6c66a48a13bf36bcb9885326a55/flask/app.py#L1666-L1668\r\n\r\nI should have checked that it's a `BadRequestKeyError` for the default behavior, instead of all `BadRequest` errors.\r\n\r\nFixing this now."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/385246721",
            "html_url": "https://github.com/pallets/flask/issues/2735#issuecomment-385246721",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2735",
            "id": 385246721,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTI0NjcyMQ==",
            "user": {
                "login": "pypingou",
                "id": 1240038,
                "node_id": "MDQ6VXNlcjEyNDAwMzg=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1240038?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/pypingou",
                "html_url": "https://github.com/pypingou",
                "followers_url": "https://api.github.com/users/pypingou/followers",
                "following_url": "https://api.github.com/users/pypingou/following{/other_user}",
                "gists_url": "https://api.github.com/users/pypingou/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/pypingou/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/pypingou/subscriptions",
                "organizations_url": "https://api.github.com/users/pypingou/orgs",
                "repos_url": "https://api.github.com/users/pypingou/repos",
                "events_url": "https://api.github.com/users/pypingou/events{/privacy}",
                "received_events_url": "https://api.github.com/users/pypingou/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-04-29T12:07:29Z",
            "updated_at": "2018-04-29T12:07:29Z",
            "author_association": "NONE",
            "body": "Thanks for the quick fix :)"
        }
    ]
}