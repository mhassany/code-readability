{
    "url": "https://api.github.com/repos/pallets/flask/issues/1906",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/1906/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/1906/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/1906/events",
    "html_url": "https://github.com/pallets/flask/issues/1906",
    "id": 159774720,
    "node_id": "MDU6SXNzdWUxNTk3NzQ3MjA=",
    "number": 1906,
    "title": "SessionInterface shouldn't hard code a fix for localhost when it comes to cookies",
    "user": {
        "login": "nickjj",
        "id": 813219,
        "node_id": "MDQ6VXNlcjgxMzIxOQ==",
        "avatar_url": "https://avatars2.githubusercontent.com/u/813219?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/nickjj",
        "html_url": "https://github.com/nickjj",
        "followers_url": "https://api.github.com/users/nickjj/followers",
        "following_url": "https://api.github.com/users/nickjj/following{/other_user}",
        "gists_url": "https://api.github.com/users/nickjj/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/nickjj/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/nickjj/subscriptions",
        "organizations_url": "https://api.github.com/users/nickjj/orgs",
        "repos_url": "https://api.github.com/users/nickjj/repos",
        "events_url": "https://api.github.com/users/nickjj/events{/privacy}",
        "received_events_url": "https://api.github.com/users/nickjj/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 10,
    "created_at": "2016-06-11T13:58:29Z",
    "updated_at": "2017-05-16T06:02:59Z",
    "closed_at": "2016-09-06T12:36:53Z",
    "author_association": "CONTRIBUTOR",
    "body": "The `get_cookie_domain` function specifically fixes issues with webkit browsers by doing this:\n\n``` python\n# https://github.com/pallets/flask/blob/0.11.1/flask/sessions.py#L198-222\nif rv == '.localhost':\n    rv = None\n```\n\nThe problem is that nowadays many people are using Docker and other techniques (Vagrant, etc.) to create a better development environment so they are no longer running Flask on `localhost`.\n\nIn Docker's case, you'd likely end up with an IP address based host name which means you'd set your `SERVER_NAME` to something like `192.168.99.100`.\n\nAt this point Chrome and other webkit based browsers will freak out by reject setting the cookie which in turn will make your Flask app throw CSRF token related issues when submitting forms.\n\nSince Flask is already hard coding a fix for this, I think you should allow users to configure which domain name gets skipped with a proper config option.\n\nThis could be named something like `SESSION_COOKIE_IGNORE_DOMAIN` (feel free to improve the name :)). It could default to localhost so that it's backwards compatible and nothing changes for most users.\n\nRight now the work around is to modify your `/etc/hosts` file to map an IP address to a FQDN with a TLD if you're stuck using an IP based `SERVER_NAME`. That seems a little lame and preventable at the Flask level.\n\nWhat do you think?\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/225363835",
            "html_url": "https://github.com/pallets/flask/issues/1906#issuecomment-225363835",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1906",
            "id": 225363835,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIyNTM2MzgzNQ==",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-06-11T14:01:40Z",
            "updated_at": "2016-06-11T14:10:20Z",
            "author_association": "MEMBER",
            "body": "workarounds:\n- explicitly set `SESSION_COOKIE_DOMAIN`\n- Subclass `SessionInterface` and set `app.session_interface` to the new subclass\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/225364118",
            "html_url": "https://github.com/pallets/flask/issues/1906#issuecomment-225364118",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1906",
            "id": 225364118,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIyNTM2NDExOA==",
            "user": {
                "login": "nickjj",
                "id": 813219,
                "node_id": "MDQ6VXNlcjgxMzIxOQ==",
                "avatar_url": "https://avatars2.githubusercontent.com/u/813219?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/nickjj",
                "html_url": "https://github.com/nickjj",
                "followers_url": "https://api.github.com/users/nickjj/followers",
                "following_url": "https://api.github.com/users/nickjj/following{/other_user}",
                "gists_url": "https://api.github.com/users/nickjj/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/nickjj/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/nickjj/subscriptions",
                "organizations_url": "https://api.github.com/users/nickjj/orgs",
                "repos_url": "https://api.github.com/users/nickjj/repos",
                "events_url": "https://api.github.com/users/nickjj/events{/privacy}",
                "received_events_url": "https://api.github.com/users/nickjj/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-06-11T14:05:47Z",
            "updated_at": "2016-06-11T14:05:47Z",
            "author_association": "CONTRIBUTOR",
            "body": "If you set `SESSION_COOKIE_DOMAIN` to an IP address wouldn't Chrome still reject it?\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/225364423",
            "html_url": "https://github.com/pallets/flask/issues/1906#issuecomment-225364423",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1906",
            "id": 225364423,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIyNTM2NDQyMw==",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-06-11T14:10:16Z",
            "updated_at": "2016-06-11T14:10:16Z",
            "author_association": "MEMBER",
            "body": "You can set it to `None` though.\n\nI don't think this can be properly worked around at a Flask level. And actually I consider the workaround of assigning your dev server a proper hostname to be a good solution.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/225368259",
            "html_url": "https://github.com/pallets/flask/issues/1906#issuecomment-225368259",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1906",
            "id": 225368259,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIyNTM2ODI1OQ==",
            "user": {
                "login": "nickjj",
                "id": 813219,
                "node_id": "MDQ6VXNlcjgxMzIxOQ==",
                "avatar_url": "https://avatars2.githubusercontent.com/u/813219?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/nickjj",
                "html_url": "https://github.com/nickjj",
                "followers_url": "https://api.github.com/users/nickjj/followers",
                "following_url": "https://api.github.com/users/nickjj/following{/other_user}",
                "gists_url": "https://api.github.com/users/nickjj/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/nickjj/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/nickjj/subscriptions",
                "organizations_url": "https://api.github.com/users/nickjj/orgs",
                "repos_url": "https://api.github.com/users/nickjj/repos",
                "events_url": "https://api.github.com/users/nickjj/events{/privacy}",
                "received_events_url": "https://api.github.com/users/nickjj/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-06-11T15:05:07Z",
            "updated_at": "2016-06-11T15:05:07Z",
            "author_association": "CONTRIBUTOR",
            "body": "Setting it to `None` results in the same issue as not setting it.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/225368634",
            "html_url": "https://github.com/pallets/flask/issues/1906#issuecomment-225368634",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1906",
            "id": 225368634,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIyNTM2ODYzNA==",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-06-11T15:10:31Z",
            "updated_at": "2016-06-11T15:10:31Z",
            "author_association": "MEMBER",
            "body": "Sorry, I misread the code\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/244936716",
            "html_url": "https://github.com/pallets/flask/issues/1906#issuecomment-244936716",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1906",
            "id": 244936716,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI0NDkzNjcxNg==",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-09-06T12:36:53Z",
            "updated_at": "2016-09-06T12:36:53Z",
            "author_association": "MEMBER",
            "body": "Actually, as far as I understand, `SERVER_NAME` does not support IP addresses at all, and setting cookies on IP addresses is not supported at all: https://tools.ietf.org/html/rfc6265#section-5.1.3\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/244984238",
            "html_url": "https://github.com/pallets/flask/issues/1906#issuecomment-244984238",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1906",
            "id": 244984238,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI0NDk4NDIzOA==",
            "user": {
                "login": "nickjj",
                "id": 813219,
                "node_id": "MDQ6VXNlcjgxMzIxOQ==",
                "avatar_url": "https://avatars2.githubusercontent.com/u/813219?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/nickjj",
                "html_url": "https://github.com/nickjj",
                "followers_url": "https://api.github.com/users/nickjj/followers",
                "following_url": "https://api.github.com/users/nickjj/following{/other_user}",
                "gists_url": "https://api.github.com/users/nickjj/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/nickjj/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/nickjj/subscriptions",
                "organizations_url": "https://api.github.com/users/nickjj/orgs",
                "repos_url": "https://api.github.com/users/nickjj/repos",
                "events_url": "https://api.github.com/users/nickjj/events{/privacy}",
                "received_events_url": "https://api.github.com/users/nickjj/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-09-06T15:15:25Z",
            "updated_at": "2016-09-06T15:18:52Z",
            "author_association": "CONTRIBUTOR",
            "body": "I have a bunch of students using an IP based `SERVER_NAME` and cookies are correctly set as long as they don't use a webkit based browser.\n\nA couple of months ago I swear the spec was different. It was written such that IP addresses were valid as long as it was an exact match. For example, read this SO answer: http://stackoverflow.com/a/27276450\n\nIt seems RFC 2109 4.3.2 was changed to disallow that, but there's no mention of the change. It must have been within the last couple of months.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/245040812",
            "html_url": "https://github.com/pallets/flask/issues/1906#issuecomment-245040812",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1906",
            "id": 245040812,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI0NTA0MDgxMg==",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-09-06T18:17:30Z",
            "updated_at": "2016-09-06T18:17:30Z",
            "author_association": "MEMBER",
            "body": "Are you possibly referring to RFC 2616 instead of the set of RFCs that\nsuperseded it?\n\nOn Tue, Sep 06, 2016 at 08:15:36AM -0700, Nick Janetakis wrote:\n\n> I have a bunch of students using an IP based `SERVER_NAME` and cookies are correctly set as long as they don't use a webkit based browser.\n> \n> A couple of months ago I swear the spec was different. It was written such that IP addresses were valid.\n> \n> ## \n> \n> You are receiving this because you modified the open/close state.\n> Reply to this email directly or view it on GitHub:\n> https://github.com/pallets/flask/issues/1906#issuecomment-244984238\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/280644346",
            "html_url": "https://github.com/pallets/flask/issues/1906#issuecomment-280644346",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1906",
            "id": 280644346,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI4MDY0NDM0Ng==",
            "user": {
                "login": "dpalharini",
                "id": 5911360,
                "node_id": "MDQ6VXNlcjU5MTEzNjA=",
                "avatar_url": "https://avatars2.githubusercontent.com/u/5911360?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/dpalharini",
                "html_url": "https://github.com/dpalharini",
                "followers_url": "https://api.github.com/users/dpalharini/followers",
                "following_url": "https://api.github.com/users/dpalharini/following{/other_user}",
                "gists_url": "https://api.github.com/users/dpalharini/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/dpalharini/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/dpalharini/subscriptions",
                "organizations_url": "https://api.github.com/users/dpalharini/orgs",
                "repos_url": "https://api.github.com/users/dpalharini/repos",
                "events_url": "https://api.github.com/users/dpalharini/events{/privacy}",
                "received_events_url": "https://api.github.com/users/dpalharini/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-02-17T13:07:41Z",
            "updated_at": "2017-02-17T13:16:02Z",
            "author_association": "NONE",
            "body": "It is to late do add something in this post?   I hope not. \r\n\r\nI've been fought this problem for a week and find out that is possible to create session in the Chrome browser using IP. \r\n\r\nMy config file has these configurations:\r\n\r\n```\r\n        SERVER_NAME = '192.168.0.6:5000'\r\n        SESSION_COOKIE_NAME = '192.168.0.6:5000'\r\n        SESSION_COOKIE_DOMAIN = '192.168.0.6:5000'\r\n```\r\n\r\nIt allowed me to use a local virtual machine and the cookie worked perfectly on Chrome, without the need o a local FQDN .\r\n\r\n\r\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/301272035",
            "html_url": "https://github.com/pallets/flask/issues/1906#issuecomment-301272035",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1906",
            "id": 301272035,
            "node_id": "MDEyOklzc3VlQ29tbWVudDMwMTI3MjAzNQ==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-05-13T20:13:31Z",
            "updated_at": "2017-05-13T20:13:31Z",
            "author_association": "MEMBER",
            "body": "It doesn't make sense to set `SESSION_COOKIE_NAME` to the IP addres, it can remain as the default, `'session'`. Other than that, yes, it appears Chrome allows IP addresses if they don't look like they're trying to be a match pattern (start with '.')."
        }
    ]
}