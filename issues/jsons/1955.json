{
    "url": "https://api.github.com/repos/pallets/flask/issues/1955",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/1955/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/1955/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/1955/events",
    "html_url": "https://github.com/pallets/flask/issues/1955",
    "id": 165660897,
    "node_id": "MDU6SXNzdWUxNjU2NjA4OTc=",
    "number": 1955,
    "title": "Flask Test Client fails to get on subdomains with explicit port 80",
    "user": {
        "login": "CorneliaXaos",
        "id": 20465581,
        "node_id": "MDQ6VXNlcjIwNDY1NTgx",
        "avatar_url": "https://avatars1.githubusercontent.com/u/20465581?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/CorneliaXaos",
        "html_url": "https://github.com/CorneliaXaos",
        "followers_url": "https://api.github.com/users/CorneliaXaos/followers",
        "following_url": "https://api.github.com/users/CorneliaXaos/following{/other_user}",
        "gists_url": "https://api.github.com/users/CorneliaXaos/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/CorneliaXaos/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/CorneliaXaos/subscriptions",
        "organizations_url": "https://api.github.com/users/CorneliaXaos/orgs",
        "repos_url": "https://api.github.com/users/CorneliaXaos/repos",
        "events_url": "https://api.github.com/users/CorneliaXaos/events{/privacy}",
        "received_events_url": "https://api.github.com/users/CorneliaXaos/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 5,
    "created_at": "2016-07-14T21:16:58Z",
    "updated_at": "2016-09-08T14:33:42Z",
    "closed_at": "2016-09-08T14:33:42Z",
    "author_association": "NONE",
    "body": "When `app.config[\"SERVER_NAME\"]` contains an explicit port of 80 (i.e. `domain.tld:80`) the flask test client fails to process get urls at subdomains.  There are three test cases:\n1. Explicit port 80 in SERVER_NAME: All subdomain requests redirect to 404 in test client.\n2. Implicit port 80 in SERVER_NAME: Subdomain requests work.\n3. Explicit port that is not 80: Subdomain requests work if the port is provided correctly.\n\n[Example gist located here.](https://gist.github.com/CorneliaXaos/9e4fa46f442f72fc5bff07ffedace397)\n\nMore information at [this Stack Overflow post.](http://stackoverflow.com/questions/38363885/)\n\nPython Version: 3.5.1+\nOutput of `pip3 freeze`:\n\n> click==6.6\n> Flask==0.11.1\n> itsdangerous==0.24\n> Jinja2==2.8\n> MarkupSafe==0.23\n> Werkzeug==0.11.10\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/234345382",
            "html_url": "https://github.com/pallets/flask/issues/1955#issuecomment-234345382",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1955",
            "id": 234345382,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIzNDM0NTM4Mg==",
            "user": {
                "login": "wgwz",
                "id": 10120306,
                "node_id": "MDQ6VXNlcjEwMTIwMzA2",
                "avatar_url": "https://avatars2.githubusercontent.com/u/10120306?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/wgwz",
                "html_url": "https://github.com/wgwz",
                "followers_url": "https://api.github.com/users/wgwz/followers",
                "following_url": "https://api.github.com/users/wgwz/following{/other_user}",
                "gists_url": "https://api.github.com/users/wgwz/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/wgwz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/wgwz/subscriptions",
                "organizations_url": "https://api.github.com/users/wgwz/orgs",
                "repos_url": "https://api.github.com/users/wgwz/repos",
                "events_url": "https://api.github.com/users/wgwz/events{/privacy}",
                "received_events_url": "https://api.github.com/users/wgwz/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-07-21T18:41:17Z",
            "updated_at": "2016-07-21T18:41:17Z",
            "author_association": "CONTRIBUTOR",
            "body": "For the 2nd test case in your gist it doesn't seem like you test a sub-domain.\n\n```\napp.config[\"SERVER_NAME\"]] = \"domain.tld\"\nwith app.test_client() as c:\n    c.get(\"/test/\", base_url=\"http://domain.tld:80\") # Will return 200\n    c.get(\"/test/\", base_url=\"http://domain.tld\") # Will return 200)\n```\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/234385038",
            "html_url": "https://github.com/pallets/flask/issues/1955#issuecomment-234385038",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1955",
            "id": 234385038,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIzNDM4NTAzOA==",
            "user": {
                "login": "CorneliaXaos",
                "id": 20465581,
                "node_id": "MDQ6VXNlcjIwNDY1NTgx",
                "avatar_url": "https://avatars1.githubusercontent.com/u/20465581?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/CorneliaXaos",
                "html_url": "https://github.com/CorneliaXaos",
                "followers_url": "https://api.github.com/users/CorneliaXaos/followers",
                "following_url": "https://api.github.com/users/CorneliaXaos/following{/other_user}",
                "gists_url": "https://api.github.com/users/CorneliaXaos/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/CorneliaXaos/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/CorneliaXaos/subscriptions",
                "organizations_url": "https://api.github.com/users/CorneliaXaos/orgs",
                "repos_url": "https://api.github.com/users/CorneliaXaos/repos",
                "events_url": "https://api.github.com/users/CorneliaXaos/events{/privacy}",
                "received_events_url": "https://api.github.com/users/CorneliaXaos/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-07-21T21:10:15Z",
            "updated_at": "2016-07-21T21:10:55Z",
            "author_association": "NONE",
            "body": "@wgwz I tested it correctly in the python interpreter but forgot to attach the subdomains in the gist..  I've updated the gist so that it correctly demonstrates the problem.\nEDIT: Or... more accurately.. what I think is a problem.  For all I know it's a design intention.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/245537541",
            "html_url": "https://github.com/pallets/flask/issues/1955#issuecomment-245537541",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1955",
            "id": 245537541,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI0NTUzNzU0MQ==",
            "user": {
                "login": "mitsuhiko",
                "id": 7396,
                "node_id": "MDQ6VXNlcjczOTY=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/7396?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/mitsuhiko",
                "html_url": "https://github.com/mitsuhiko",
                "followers_url": "https://api.github.com/users/mitsuhiko/followers",
                "following_url": "https://api.github.com/users/mitsuhiko/following{/other_user}",
                "gists_url": "https://api.github.com/users/mitsuhiko/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/mitsuhiko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mitsuhiko/subscriptions",
                "organizations_url": "https://api.github.com/users/mitsuhiko/orgs",
                "repos_url": "https://api.github.com/users/mitsuhiko/repos",
                "events_url": "https://api.github.com/users/mitsuhiko/events{/privacy}",
                "received_events_url": "https://api.github.com/users/mitsuhiko/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-09-08T09:04:01Z",
            "updated_at": "2016-09-08T09:04:01Z",
            "author_association": "MEMBER",
            "body": "For what it's worth we mostly stick to WSGI behavior here. `SERVER_NAME` in WSGI is assumed to not contain the port for well known ones.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/245615578",
            "html_url": "https://github.com/pallets/flask/issues/1955#issuecomment-245615578",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1955",
            "id": 245615578,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI0NTYxNTU3OA==",
            "user": {
                "login": "CorneliaXaos",
                "id": 20465581,
                "node_id": "MDQ6VXNlcjIwNDY1NTgx",
                "avatar_url": "https://avatars1.githubusercontent.com/u/20465581?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/CorneliaXaos",
                "html_url": "https://github.com/CorneliaXaos",
                "followers_url": "https://api.github.com/users/CorneliaXaos/followers",
                "following_url": "https://api.github.com/users/CorneliaXaos/following{/other_user}",
                "gists_url": "https://api.github.com/users/CorneliaXaos/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/CorneliaXaos/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/CorneliaXaos/subscriptions",
                "organizations_url": "https://api.github.com/users/CorneliaXaos/orgs",
                "repos_url": "https://api.github.com/users/CorneliaXaos/repos",
                "events_url": "https://api.github.com/users/CorneliaXaos/events{/privacy}",
                "received_events_url": "https://api.github.com/users/CorneliaXaos/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-09-08T14:28:10Z",
            "updated_at": "2016-09-08T14:28:10Z",
            "author_association": "NONE",
            "body": "Ah. I see... Well it can be confusing for someone coming to flask who has no knowledge of WSGI. Especially since this behavior isn't mentioned in any of the flask documentation I read.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/245617439",
            "html_url": "https://github.com/pallets/flask/issues/1955#issuecomment-245617439",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1955",
            "id": 245617439,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI0NTYxNzQzOQ==",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-09-08T14:33:41Z",
            "updated_at": "2016-09-08T14:33:41Z",
            "author_association": "MEMBER",
            "body": "See https://github.com/pallets/flask/issues/2007, we should validate SERVER_NAME in particular because so many people get it wrong.\n"
        }
    ]
}