{
    "url": "https://api.github.com/repos/pallets/flask/issues/905",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/905/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/905/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/905/events",
    "html_url": "https://github.com/pallets/flask/issues/905",
    "id": 22083471,
    "node_id": "MDU6SXNzdWUyMjA4MzQ3MQ==",
    "number": 905,
    "title": "Allow subdomains to work with no SERVER_NAME",
    "user": {
        "login": "yannk",
        "id": 40152,
        "node_id": "MDQ6VXNlcjQwMTUy",
        "avatar_url": "https://avatars1.githubusercontent.com/u/40152?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/yannk",
        "html_url": "https://github.com/yannk",
        "followers_url": "https://api.github.com/users/yannk/followers",
        "following_url": "https://api.github.com/users/yannk/following{/other_user}",
        "gists_url": "https://api.github.com/users/yannk/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/yannk/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/yannk/subscriptions",
        "organizations_url": "https://api.github.com/users/yannk/orgs",
        "repos_url": "https://api.github.com/users/yannk/repos",
        "events_url": "https://api.github.com/users/yannk/events{/privacy}",
        "received_events_url": "https://api.github.com/users/yannk/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 5,
    "created_at": "2013-11-04T22:07:09Z",
    "updated_at": "2018-02-23T23:56:42Z",
    "closed_at": "2018-02-23T23:56:41Z",
    "author_association": "NONE",
    "body": "Would you be open to a patch allowing the use of subdomain routing with no SERVER_NAME pre-configured?\n\nThe motivation is to allow multiple domains to match a request, just like it does when SERVER_NAME is None, while still benefiting from the nice subdomain matcher. This is particularly useful in DEV to be able to develop on machine.local but also tunnel the instance to a vpn, and use things like xip.io (which all change the host).\n\nThe change would probably be mostly focused on create_url_adapter(). I imagine a configuration variable switching a different logic on for this function: it would look for subdomains and deduce the server_name which is the reverse of what's going on today.\nThe list of subdomains could come from the configuration I suppose, or better be deduced from the compilation of the routes.\n\n1) What do you think of this idea?\n2) If you are opposed to it, what alternative approach do you suggest instead?\n3) If you are not opposed to it, how do you think the implementation should look like?\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/27733935",
            "html_url": "https://github.com/pallets/flask/issues/905#issuecomment-27733935",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/905",
            "id": 27733935,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI3NzMzOTM1",
            "user": {
                "login": "gregorynicholas",
                "id": 407650,
                "node_id": "MDQ6VXNlcjQwNzY1MA==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/407650?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/gregorynicholas",
                "html_url": "https://github.com/gregorynicholas",
                "followers_url": "https://api.github.com/users/gregorynicholas/followers",
                "following_url": "https://api.github.com/users/gregorynicholas/following{/other_user}",
                "gists_url": "https://api.github.com/users/gregorynicholas/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/gregorynicholas/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gregorynicholas/subscriptions",
                "organizations_url": "https://api.github.com/users/gregorynicholas/orgs",
                "repos_url": "https://api.github.com/users/gregorynicholas/repos",
                "events_url": "https://api.github.com/users/gregorynicholas/events{/privacy}",
                "received_events_url": "https://api.github.com/users/gregorynicholas/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2013-11-04T23:31:23Z",
            "updated_at": "2013-11-04T23:31:23Z",
            "author_association": "NONE",
            "body": ":+1:  or at least one could provide detailed documentation on the functionality + configuration for this.  it ended up being a very costly issue for me on my last major flask project due to the amount of time + debugging it took to get an app with subdomains working stably.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/34573492",
            "html_url": "https://github.com/pallets/flask/issues/905#issuecomment-34573492",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/905",
            "id": 34573492,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM0NTczNDky",
            "user": {
                "login": "mitsuhiko",
                "id": 7396,
                "node_id": "MDQ6VXNlcjczOTY=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/7396?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/mitsuhiko",
                "html_url": "https://github.com/mitsuhiko",
                "followers_url": "https://api.github.com/users/mitsuhiko/followers",
                "following_url": "https://api.github.com/users/mitsuhiko/following{/other_user}",
                "gists_url": "https://api.github.com/users/mitsuhiko/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/mitsuhiko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mitsuhiko/subscriptions",
                "organizations_url": "https://api.github.com/users/mitsuhiko/orgs",
                "repos_url": "https://api.github.com/users/mitsuhiko/repos",
                "events_url": "https://api.github.com/users/mitsuhiko/events{/privacy}",
                "received_events_url": "https://api.github.com/users/mitsuhiko/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-02-09T13:17:55Z",
            "updated_at": "2014-02-09T13:17:55Z",
            "author_association": "MEMBER",
            "body": "How would that work?\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/34577547",
            "html_url": "https://github.com/pallets/flask/issues/905#issuecomment-34577547",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/905",
            "id": 34577547,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM0NTc3NTQ3",
            "user": {
                "login": "yannk",
                "id": 40152,
                "node_id": "MDQ6VXNlcjQwMTUy",
                "avatar_url": "https://avatars1.githubusercontent.com/u/40152?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/yannk",
                "html_url": "https://github.com/yannk",
                "followers_url": "https://api.github.com/users/yannk/followers",
                "following_url": "https://api.github.com/users/yannk/following{/other_user}",
                "gists_url": "https://api.github.com/users/yannk/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/yannk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/yannk/subscriptions",
                "organizations_url": "https://api.github.com/users/yannk/orgs",
                "repos_url": "https://api.github.com/users/yannk/repos",
                "events_url": "https://api.github.com/users/yannk/events{/privacy}",
                "received_events_url": "https://api.github.com/users/yannk/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-02-09T16:04:46Z",
            "updated_at": "2014-02-09T16:04:46Z",
            "author_association": "NONE",
            "body": "IIRC (it's been a little while now), SERVER_NAME MUST be defined when subdomains are in use or it silently breaks. A patch would change that so that server_name is set from the request, but the list of configured subdomains would be taken into account so they are stripped from it.\n\nI can work on a patch proposal if you like. The easiest would be to read the list of subdomains from the config, but it would be more elegant if it came from the routes, but I have to dig in the code to figure out how to extract that. What do you think?\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/200671027",
            "html_url": "https://github.com/pallets/flask/issues/905#issuecomment-200671027",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/905",
            "id": 200671027,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIwMDY3MTAyNw==",
            "user": {
                "login": "asciifaceman",
                "id": 1619591,
                "node_id": "MDQ6VXNlcjE2MTk1OTE=",
                "avatar_url": "https://avatars3.githubusercontent.com/u/1619591?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/asciifaceman",
                "html_url": "https://github.com/asciifaceman",
                "followers_url": "https://api.github.com/users/asciifaceman/followers",
                "following_url": "https://api.github.com/users/asciifaceman/following{/other_user}",
                "gists_url": "https://api.github.com/users/asciifaceman/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/asciifaceman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/asciifaceman/subscriptions",
                "organizations_url": "https://api.github.com/users/asciifaceman/orgs",
                "repos_url": "https://api.github.com/users/asciifaceman/repos",
                "events_url": "https://api.github.com/users/asciifaceman/events{/privacy}",
                "received_events_url": "https://api.github.com/users/asciifaceman/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-03-24T05:15:58Z",
            "updated_at": "2016-03-24T05:15:58Z",
            "author_association": "NONE",
            "body": ":+1: \n\nThis led to debating dumping blueprints with my partner\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/368173421",
            "html_url": "https://github.com/pallets/flask/issues/905#issuecomment-368173421",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/905",
            "id": 368173421,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM2ODE3MzQyMQ==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-02-23T23:56:41Z",
            "updated_at": "2018-02-23T23:56:41Z",
            "author_association": "MEMBER",
            "body": "Subdomain routing requires setting the server name. It sounds like you want \"wildcard\" subdomains, where some routes don't care what subdomain they come in on. You can probably get this with some variable rules in the subdomain part, or by redirecting the subdomains to a canonical domain at the web server level. I don't think we should add anything to Flask at this time.\r\n\r\nNote that #2635 allows setting `SERVER_NAME` without forcing subdomain matching, which may be what you were looking for."
        }
    ]
}