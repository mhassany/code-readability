{
    "url": "https://api.github.com/repos/pallets/flask/issues/1676",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/1676/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/1676/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/1676/events",
    "html_url": "https://github.com/pallets/flask/pull/1676",
    "id": 124572361,
    "node_id": "MDExOlB1bGxSZXF1ZXN0NTQ5MDAxNjg=",
    "number": 1676,
    "title": "Refactored method Flask.make_response to improve readability",
    "user": {
        "login": "AvivC",
        "id": 7305419,
        "node_id": "MDQ6VXNlcjczMDU0MTk=",
        "avatar_url": "https://avatars0.githubusercontent.com/u/7305419?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/AvivC",
        "html_url": "https://github.com/AvivC",
        "followers_url": "https://api.github.com/users/AvivC/followers",
        "following_url": "https://api.github.com/users/AvivC/following{/other_user}",
        "gists_url": "https://api.github.com/users/AvivC/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/AvivC/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/AvivC/subscriptions",
        "organizations_url": "https://api.github.com/users/AvivC/orgs",
        "repos_url": "https://api.github.com/users/AvivC/repos",
        "events_url": "https://api.github.com/users/AvivC/events{/privacy}",
        "received_events_url": "https://api.github.com/users/AvivC/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": true,
    "assignee": {
        "login": "davidism",
        "id": 1242887,
        "node_id": "MDQ6VXNlcjEyNDI4ODc=",
        "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/davidism",
        "html_url": "https://github.com/davidism",
        "followers_url": "https://api.github.com/users/davidism/followers",
        "following_url": "https://api.github.com/users/davidism/following{/other_user}",
        "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
        "organizations_url": "https://api.github.com/users/davidism/orgs",
        "repos_url": "https://api.github.com/users/davidism/repos",
        "events_url": "https://api.github.com/users/davidism/events{/privacy}",
        "received_events_url": "https://api.github.com/users/davidism/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "davidism",
            "id": 1242887,
            "node_id": "MDQ6VXNlcjEyNDI4ODc=",
            "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/davidism",
            "html_url": "https://github.com/davidism",
            "followers_url": "https://api.github.com/users/davidism/followers",
            "following_url": "https://api.github.com/users/davidism/following{/other_user}",
            "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
            "organizations_url": "https://api.github.com/users/davidism/orgs",
            "repos_url": "https://api.github.com/users/davidism/repos",
            "events_url": "https://api.github.com/users/davidism/events{/privacy}",
            "received_events_url": "https://api.github.com/users/davidism/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 8,
    "created_at": "2016-01-02T02:58:16Z",
    "updated_at": "2018-10-23T17:43:41Z",
    "closed_at": "2017-04-25T15:46:23Z",
    "author_association": "CONTRIBUTOR",
    "pull_request": {
        "url": "https://api.github.com/repos/pallets/flask/pulls/1676",
        "html_url": "https://github.com/pallets/flask/pull/1676",
        "diff_url": "https://github.com/pallets/flask/pull/1676.diff",
        "patch_url": "https://github.com/pallets/flask/pull/1676.patch"
    },
    "body": "The method now looks at the type of the object returned from the view function, and returns a `self.response_class` object based on that type.\n\nThe docstring for the method has also been improved and contains a more\ndetailed explanation for what can be returned from a view function.\n\nAlso refactored the test for response creation.\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/180326122",
            "html_url": "https://github.com/pallets/flask/pull/1676#issuecomment-180326122",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1676",
            "id": 180326122,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE4MDMyNjEyMg==",
            "user": {
                "login": "AvivC",
                "id": 7305419,
                "node_id": "MDQ6VXNlcjczMDU0MTk=",
                "avatar_url": "https://avatars0.githubusercontent.com/u/7305419?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/AvivC",
                "html_url": "https://github.com/AvivC",
                "followers_url": "https://api.github.com/users/AvivC/followers",
                "following_url": "https://api.github.com/users/AvivC/following{/other_user}",
                "gists_url": "https://api.github.com/users/AvivC/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/AvivC/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/AvivC/subscriptions",
                "organizations_url": "https://api.github.com/users/AvivC/orgs",
                "repos_url": "https://api.github.com/users/AvivC/repos",
                "events_url": "https://api.github.com/users/AvivC/events{/privacy}",
                "received_events_url": "https://api.github.com/users/AvivC/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-02-05T12:17:23Z",
            "updated_at": "2016-02-05T12:18:55Z",
            "author_association": "CONTRIBUTOR",
            "body": "@guyskk \n\n> the origin code rv, status_or_headers, headers = rv + (None,) \\* (3 - len(rv)) is better, shorter and cleaner.\n\nI respectfully disagree. I think using `status_or_headers` makes the code very hard to follow. At any point it may hold different types depending on the input, and It is also used as a sort of flag throughout the function to infer what was passed in from the view function.\n\nReading the function, I felt it was unnecessarily convoluted and it was difficult to follow all of the possible paths in the code.\n\nIMHO my refactoring turns the function into a simple series of `if - elif - else` clauses. The logic is now far clearer.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/180353682",
            "html_url": "https://github.com/pallets/flask/pull/1676#issuecomment-180353682",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1676",
            "id": 180353682,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE4MDM1MzY4Mg==",
            "user": {
                "login": "guyskk",
                "id": 6367792,
                "node_id": "MDQ6VXNlcjYzNjc3OTI=",
                "avatar_url": "https://avatars2.githubusercontent.com/u/6367792?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/guyskk",
                "html_url": "https://github.com/guyskk",
                "followers_url": "https://api.github.com/users/guyskk/followers",
                "following_url": "https://api.github.com/users/guyskk/following{/other_user}",
                "gists_url": "https://api.github.com/users/guyskk/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/guyskk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/guyskk/subscriptions",
                "organizations_url": "https://api.github.com/users/guyskk/orgs",
                "repos_url": "https://api.github.com/users/guyskk/repos",
                "events_url": "https://api.github.com/users/guyskk/events{/privacy}",
                "received_events_url": "https://api.github.com/users/guyskk/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-02-05T13:19:29Z",
            "updated_at": "2016-02-05T13:19:29Z",
            "author_association": "NONE",
            "body": "the origin rv tuple\n\n```\nresponse,\nresponse, status\nresponse, headers\nresponse, status,  headers\n```\n\nafter append None\n\n```\nresponse, None,    None\nresponse, status,  None\nresponse, headers, None\nresponse, status,  headers\n```\n\nso the 3 items is\n `response`, `status_or_headers`,`headers`\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/180374021",
            "html_url": "https://github.com/pallets/flask/pull/1676#issuecomment-180374021",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1676",
            "id": 180374021,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE4MDM3NDAyMQ==",
            "user": {
                "login": "AvivC",
                "id": 7305419,
                "node_id": "MDQ6VXNlcjczMDU0MTk=",
                "avatar_url": "https://avatars0.githubusercontent.com/u/7305419?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/AvivC",
                "html_url": "https://github.com/AvivC",
                "followers_url": "https://api.github.com/users/AvivC/followers",
                "following_url": "https://api.github.com/users/AvivC/following{/other_user}",
                "gists_url": "https://api.github.com/users/AvivC/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/AvivC/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/AvivC/subscriptions",
                "organizations_url": "https://api.github.com/users/AvivC/orgs",
                "repos_url": "https://api.github.com/users/AvivC/repos",
                "events_url": "https://api.github.com/users/AvivC/events{/privacy}",
                "received_events_url": "https://api.github.com/users/AvivC/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-02-05T14:10:33Z",
            "updated_at": "2016-02-05T14:10:33Z",
            "author_association": "CONTRIBUTOR",
            "body": "@guyskk Yes, I understand the idea in `rv, status_or_headers, headers = rv + (None,) * (3 - len(rv))`.\n\nI just think the same thing can be achieved with a little more code and far better readability. As demonstrated in the PR.\n\nIMHO this function could be implemented simply with a series of `elif`s, so I don't see why not :)\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/180696371",
            "html_url": "https://github.com/pallets/flask/pull/1676#issuecomment-180696371",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1676",
            "id": 180696371,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE4MDY5NjM3MQ==",
            "user": {
                "login": "guyskk",
                "id": 6367792,
                "node_id": "MDQ6VXNlcjYzNjc3OTI=",
                "avatar_url": "https://avatars2.githubusercontent.com/u/6367792?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/guyskk",
                "html_url": "https://github.com/guyskk",
                "followers_url": "https://api.github.com/users/guyskk/followers",
                "following_url": "https://api.github.com/users/guyskk/following{/other_user}",
                "gists_url": "https://api.github.com/users/guyskk/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/guyskk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/guyskk/subscriptions",
                "organizations_url": "https://api.github.com/users/guyskk/orgs",
                "repos_url": "https://api.github.com/users/guyskk/repos",
                "events_url": "https://api.github.com/users/guyskk/events{/privacy}",
                "received_events_url": "https://api.github.com/users/guyskk/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-02-06T05:45:53Z",
            "updated_at": "2016-02-06T05:45:53Z",
            "author_association": "NONE",
            "body": "Your implement of _make_response_from_tuple is too verbose, you need not split it into some functions, it just a little bit of code and you make it complicated. \n\nWhat's more, you should not change code and tests in the same commit, can your refactor pass the origin tests?\n\nThe 2th item can be string(status) or int(statuc_code), I wonder you refactor changed this behavior.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/180716381",
            "html_url": "https://github.com/pallets/flask/pull/1676#issuecomment-180716381",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1676",
            "id": 180716381,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE4MDcxNjM4MQ==",
            "user": {
                "login": "ThiefMaster",
                "id": 179599,
                "node_id": "MDQ6VXNlcjE3OTU5OQ==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/179599?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ThiefMaster",
                "html_url": "https://github.com/ThiefMaster",
                "followers_url": "https://api.github.com/users/ThiefMaster/followers",
                "following_url": "https://api.github.com/users/ThiefMaster/following{/other_user}",
                "gists_url": "https://api.github.com/users/ThiefMaster/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ThiefMaster/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ThiefMaster/subscriptions",
                "organizations_url": "https://api.github.com/users/ThiefMaster/orgs",
                "repos_url": "https://api.github.com/users/ThiefMaster/repos",
                "events_url": "https://api.github.com/users/ThiefMaster/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ThiefMaster/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-02-06T07:50:56Z",
            "updated_at": "2016-02-06T07:50:56Z",
            "author_association": "MEMBER",
            "body": "> What's more, you should not change code and tests in the same commit\n\nWhy? By doing so you have working code with passing tests in each commit.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/180718476",
            "html_url": "https://github.com/pallets/flask/pull/1676#issuecomment-180718476",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1676",
            "id": 180718476,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE4MDcxODQ3Ng==",
            "user": {
                "login": "guyskk",
                "id": 6367792,
                "node_id": "MDQ6VXNlcjYzNjc3OTI=",
                "avatar_url": "https://avatars2.githubusercontent.com/u/6367792?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/guyskk",
                "html_url": "https://github.com/guyskk",
                "followers_url": "https://api.github.com/users/guyskk/followers",
                "following_url": "https://api.github.com/users/guyskk/following{/other_user}",
                "gists_url": "https://api.github.com/users/guyskk/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/guyskk/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/guyskk/subscriptions",
                "organizations_url": "https://api.github.com/users/guyskk/orgs",
                "repos_url": "https://api.github.com/users/guyskk/repos",
                "events_url": "https://api.github.com/users/guyskk/events{/privacy}",
                "received_events_url": "https://api.github.com/users/guyskk/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-02-06T08:21:16Z",
            "updated_at": "2016-02-06T08:21:16Z",
            "author_association": "NONE",
            "body": "this is a refactor other than new feature\uff0cso the behavior shouldn't change\uff0cand should pass the origin tests.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/180747122",
            "html_url": "https://github.com/pallets/flask/pull/1676#issuecomment-180747122",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1676",
            "id": 180747122,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE4MDc0NzEyMg==",
            "user": {
                "login": "AvivC",
                "id": 7305419,
                "node_id": "MDQ6VXNlcjczMDU0MTk=",
                "avatar_url": "https://avatars0.githubusercontent.com/u/7305419?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/AvivC",
                "html_url": "https://github.com/AvivC",
                "followers_url": "https://api.github.com/users/AvivC/followers",
                "following_url": "https://api.github.com/users/AvivC/following{/other_user}",
                "gists_url": "https://api.github.com/users/AvivC/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/AvivC/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/AvivC/subscriptions",
                "organizations_url": "https://api.github.com/users/AvivC/orgs",
                "repos_url": "https://api.github.com/users/AvivC/repos",
                "events_url": "https://api.github.com/users/AvivC/events{/privacy}",
                "received_events_url": "https://api.github.com/users/AvivC/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-02-06T12:10:17Z",
            "updated_at": "2016-02-06T12:34:15Z",
            "author_association": "CONTRIBUTOR",
            "body": "@guyskk I agree, I might have refactored into too many sub-functions.\n\nOther than that, IMHO the refactoring is good because it gives the function a structure of simple `if - elif` statements, instead of the weird structure it had before.\n\nThe 'rules' governing the behavior of the function are now visible to the eye, as opposed to the way the original is structured.\n\nHowever as I said, I think you are right that I refactored into too many function levels.\n\n@ThiefMaster I am updating the PR to split into less sub-functions.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/297073698",
            "html_url": "https://github.com/pallets/flask/pull/1676#issuecomment-297073698",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1676",
            "id": 297073698,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI5NzA3MzY5OA==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-04-25T15:45:44Z",
            "updated_at": "2017-04-25T15:45:44Z",
            "author_association": "MEMBER",
            "body": "Thanks for looking into this. I agree that it was hard to follow. However, this introduced a bug where `None` was accepted as a response in a tuple, and the response in the tuple couldn't be a WSGI callable (although that's probably beyond rare).\r\n\r\nI expanded on your idea by breaking out the tuple unpacking, adding more error messages, improving the documentation, and adding more tests. See #2256."
        }
    ]
}