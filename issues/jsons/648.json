{
    "url": "https://api.github.com/repos/pallets/flask/issues/648",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/648/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/648/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/648/events",
    "html_url": "https://github.com/pallets/flask/issues/648",
    "id": 9183583,
    "node_id": "MDU6SXNzdWU5MTgzNTgz",
    "number": 648,
    "title": "Problem with non-escaped chars in URL.",
    "user": {
        "login": "gabrielpjordao",
        "id": 937010,
        "node_id": "MDQ6VXNlcjkzNzAxMA==",
        "avatar_url": "https://avatars0.githubusercontent.com/u/937010?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gabrielpjordao",
        "html_url": "https://github.com/gabrielpjordao",
        "followers_url": "https://api.github.com/users/gabrielpjordao/followers",
        "following_url": "https://api.github.com/users/gabrielpjordao/following{/other_user}",
        "gists_url": "https://api.github.com/users/gabrielpjordao/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/gabrielpjordao/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/gabrielpjordao/subscriptions",
        "organizations_url": "https://api.github.com/users/gabrielpjordao/orgs",
        "repos_url": "https://api.github.com/users/gabrielpjordao/repos",
        "events_url": "https://api.github.com/users/gabrielpjordao/events{/privacy}",
        "received_events_url": "https://api.github.com/users/gabrielpjordao/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 7,
    "created_at": "2012-12-11T15:46:39Z",
    "updated_at": "2013-01-27T01:00:38Z",
    "closed_at": "2013-01-27T00:59:49Z",
    "author_association": "NONE",
    "body": "Is it a project's decision or a bug?  Please, check it out:\n\nGist:\nhttps://gist.github.com/4259170\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/11274964",
            "html_url": "https://github.com/pallets/flask/issues/648#issuecomment-11274964",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/648",
            "id": 11274964,
            "node_id": "MDEyOklzc3VlQ29tbWVudDExMjc0OTY0",
            "user": {
                "login": "soulseekah",
                "id": 685880,
                "node_id": "MDQ6VXNlcjY4NTg4MA==",
                "avatar_url": "https://avatars2.githubusercontent.com/u/685880?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/soulseekah",
                "html_url": "https://github.com/soulseekah",
                "followers_url": "https://api.github.com/users/soulseekah/followers",
                "following_url": "https://api.github.com/users/soulseekah/following{/other_user}",
                "gists_url": "https://api.github.com/users/soulseekah/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/soulseekah/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/soulseekah/subscriptions",
                "organizations_url": "https://api.github.com/users/soulseekah/orgs",
                "repos_url": "https://api.github.com/users/soulseekah/repos",
                "events_url": "https://api.github.com/users/soulseekah/events{/privacy}",
                "received_events_url": "https://api.github.com/users/soulseekah/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2012-12-12T03:06:14Z",
            "updated_at": "2012-12-12T04:30:11Z",
            "author_association": "CONTRIBUTOR",
            "body": "``` python\nfrom jinja2 import Environment\n\nt = Environment().from_string( '{{ s }}' )\nprint t.render( s='tes\u00e9t' )\n```\n\n> UnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 3: ordinal not in range(128)\n\nSee [Unicode in Jinja2](http://jinja.pocoo.org/docs/api/#unicode).\n\n``` python\nprint t.render( s='tes\u00e9t'.decode( 'utf8' ) )\n```\n\nor\n\n``` python\nprint t.render( s=u'tes\u00e9t' )\n```\n\nwill work. Question is: should `flask.request.url` be a unicode string?\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/11276268",
            "html_url": "https://github.com/pallets/flask/issues/648#issuecomment-11276268",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/648",
            "id": 11276268,
            "node_id": "MDEyOklzc3VlQ29tbWVudDExMjc2MjY4",
            "user": {
                "login": "boris317",
                "id": 339231,
                "node_id": "MDQ6VXNlcjMzOTIzMQ==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/339231?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/boris317",
                "html_url": "https://github.com/boris317",
                "followers_url": "https://api.github.com/users/boris317/followers",
                "following_url": "https://api.github.com/users/boris317/following{/other_user}",
                "gists_url": "https://api.github.com/users/boris317/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/boris317/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/boris317/subscriptions",
                "organizations_url": "https://api.github.com/users/boris317/orgs",
                "repos_url": "https://api.github.com/users/boris317/repos",
                "events_url": "https://api.github.com/users/boris317/events{/privacy}",
                "received_events_url": "https://api.github.com/users/boris317/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2012-12-12T04:22:38Z",
            "updated_at": "2012-12-12T04:22:38Z",
            "author_association": "NONE",
            "body": "Per [RFC1738](http://tools.ietf.org/html/rfc1738) characters in a URL must be ASCII or else encoded with \"%\". Even if request.url was a unicode string, would that not just move the point of failure to the place where request.url is decoded to unicode?\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/11276487",
            "html_url": "https://github.com/pallets/flask/issues/648#issuecomment-11276487",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/648",
            "id": 11276487,
            "node_id": "MDEyOklzc3VlQ29tbWVudDExMjc2NDg3",
            "user": {
                "login": "soulseekah",
                "id": 685880,
                "node_id": "MDQ6VXNlcjY4NTg4MA==",
                "avatar_url": "https://avatars2.githubusercontent.com/u/685880?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/soulseekah",
                "html_url": "https://github.com/soulseekah",
                "followers_url": "https://api.github.com/users/soulseekah/followers",
                "following_url": "https://api.github.com/users/soulseekah/following{/other_user}",
                "gists_url": "https://api.github.com/users/soulseekah/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/soulseekah/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/soulseekah/subscriptions",
                "organizations_url": "https://api.github.com/users/soulseekah/orgs",
                "repos_url": "https://api.github.com/users/soulseekah/repos",
                "events_url": "https://api.github.com/users/soulseekah/events{/privacy}",
                "received_events_url": "https://api.github.com/users/soulseekah/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2012-12-12T04:36:19Z",
            "updated_at": "2012-12-12T04:58:04Z",
            "author_association": "CONTRIBUTOR",
            "body": "The client (IE) is not conforming to the RFC. Werkzeug has to encode, which I think it does in latest trunk using [`iri_to_uri`](https://github.com/mitsuhiko/werkzeug/blob/master/werkzeug/urls.py#L109), inside of here it seems https://github.com/mitsuhiko/werkzeug/blob/master/werkzeug/wrappers.py#L980 so the request is coming in without any issues; `request.url` is not a unicode string.\n\n`request.url` comes from [here](https://github.com/mitsuhiko/werkzeug/blob/master/werkzeug/wrappers.py#L447), so perhaps something [inside of here](https://github.com/mitsuhiko/werkzeug/blob/master/werkzeug/wsgi.py#L40) has to be thought over. So would we like to force the current URL returned to be a unicode IRI or an ascii URL? And remember the values are supplied by the actual webserver via the `environ` that it passes through to Werkzeug wrappers.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/11276954",
            "html_url": "https://github.com/pallets/flask/issues/648#issuecomment-11276954",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/648",
            "id": 11276954,
            "node_id": "MDEyOklzc3VlQ29tbWVudDExMjc2OTU0",
            "user": {
                "login": "boris317",
                "id": 339231,
                "node_id": "MDQ6VXNlcjMzOTIzMQ==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/339231?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/boris317",
                "html_url": "https://github.com/boris317",
                "followers_url": "https://api.github.com/users/boris317/followers",
                "following_url": "https://api.github.com/users/boris317/following{/other_user}",
                "gists_url": "https://api.github.com/users/boris317/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/boris317/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/boris317/subscriptions",
                "organizations_url": "https://api.github.com/users/boris317/orgs",
                "repos_url": "https://api.github.com/users/boris317/repos",
                "events_url": "https://api.github.com/users/boris317/events{/privacy}",
                "received_events_url": "https://api.github.com/users/boris317/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2012-12-12T05:09:37Z",
            "updated_at": "2012-12-12T05:09:37Z",
            "author_association": "NONE",
            "body": "I think I like the idea of werkzeug trying to take my naughty url and turn it into a properly escaped ascii url. Should the resulting `request.url` value be unicode string though, I do not know.  \n\nNow if we do receive a non ascii URL we can only take a best guess as to what the actual encoding is. UTF-8 is probably the best guess. The code responsible for decoding the URL would need to do it in a manner similar to [_decode_unicode](https://github.com/mitsuhiko/werkzeug/blob/master/werkzeug/_internal.py#L196).  Though I think raising a `HTTPUnicodeError` if it fails is probably better than just replacing the offending characters.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/11289525",
            "html_url": "https://github.com/pallets/flask/issues/648#issuecomment-11289525",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/648",
            "id": 11289525,
            "node_id": "MDEyOklzc3VlQ29tbWVudDExMjg5NTI1",
            "user": {
                "login": "gabrielpjordao",
                "id": 937010,
                "node_id": "MDQ6VXNlcjkzNzAxMA==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/937010?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/gabrielpjordao",
                "html_url": "https://github.com/gabrielpjordao",
                "followers_url": "https://api.github.com/users/gabrielpjordao/followers",
                "following_url": "https://api.github.com/users/gabrielpjordao/following{/other_user}",
                "gists_url": "https://api.github.com/users/gabrielpjordao/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/gabrielpjordao/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gabrielpjordao/subscriptions",
                "organizations_url": "https://api.github.com/users/gabrielpjordao/orgs",
                "repos_url": "https://api.github.com/users/gabrielpjordao/repos",
                "events_url": "https://api.github.com/users/gabrielpjordao/events{/privacy}",
                "received_events_url": "https://api.github.com/users/gabrielpjordao/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2012-12-12T13:58:32Z",
            "updated_at": "2012-12-12T14:30:59Z",
            "author_association": "NONE",
            "body": "Thanks for replying the issue so fast :+1: \n\nYou should decide what's better for flask, but I really like the idea of having it treated internally.\n\nIndependently of who sends the URL (IE, CURL, Whatever), I think that this is something that the end-user of flask should not have to worry about, as flask is intended to be \"simple\".\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/12745584",
            "html_url": "https://github.com/pallets/flask/issues/648#issuecomment-12745584",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/648",
            "id": 12745584,
            "node_id": "MDEyOklzc3VlQ29tbWVudDEyNzQ1NTg0",
            "user": {
                "login": "mitsuhiko",
                "id": 7396,
                "node_id": "MDQ6VXNlcjczOTY=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/7396?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/mitsuhiko",
                "html_url": "https://github.com/mitsuhiko",
                "followers_url": "https://api.github.com/users/mitsuhiko/followers",
                "following_url": "https://api.github.com/users/mitsuhiko/following{/other_user}",
                "gists_url": "https://api.github.com/users/mitsuhiko/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/mitsuhiko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mitsuhiko/subscriptions",
                "organizations_url": "https://api.github.com/users/mitsuhiko/orgs",
                "repos_url": "https://api.github.com/users/mitsuhiko/repos",
                "events_url": "https://api.github.com/users/mitsuhiko/events{/privacy}",
                "received_events_url": "https://api.github.com/users/mitsuhiko/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2013-01-27T00:59:49Z",
            "updated_at": "2013-01-27T00:59:49Z",
            "author_association": "MEMBER",
            "body": "At the moment request.url is indeed not a unicode string.  This might change in the future.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/12745590",
            "html_url": "https://github.com/pallets/flask/issues/648#issuecomment-12745590",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/648",
            "id": 12745590,
            "node_id": "MDEyOklzc3VlQ29tbWVudDEyNzQ1NTkw",
            "user": {
                "login": "mitsuhiko",
                "id": 7396,
                "node_id": "MDQ6VXNlcjczOTY=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/7396?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/mitsuhiko",
                "html_url": "https://github.com/mitsuhiko",
                "followers_url": "https://api.github.com/users/mitsuhiko/followers",
                "following_url": "https://api.github.com/users/mitsuhiko/following{/other_user}",
                "gists_url": "https://api.github.com/users/mitsuhiko/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/mitsuhiko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mitsuhiko/subscriptions",
                "organizations_url": "https://api.github.com/users/mitsuhiko/orgs",
                "repos_url": "https://api.github.com/users/mitsuhiko/repos",
                "events_url": "https://api.github.com/users/mitsuhiko/events{/privacy}",
                "received_events_url": "https://api.github.com/users/mitsuhiko/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2013-01-27T01:00:38Z",
            "updated_at": "2013-01-27T01:00:38Z",
            "author_association": "MEMBER",
            "body": "Actually, since that will only affect the QUERY_STRING i could fix that.  Might do in a new werkzeug release.\n"
        }
    ]
}