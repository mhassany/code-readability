{
    "url": "https://api.github.com/repos/pallets/flask/issues/2268",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/2268/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/2268/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/2268/events",
    "html_url": "https://github.com/pallets/flask/issues/2268",
    "id": 225672407,
    "node_id": "MDU6SXNzdWUyMjU2NzI0MDc=",
    "number": 2268,
    "title": "Catch-all errorhandler does not catch BadRequestKeyError",
    "user": {
        "login": "sampeka",
        "id": 7493006,
        "node_id": "MDQ6VXNlcjc0OTMwMDY=",
        "avatar_url": "https://avatars2.githubusercontent.com/u/7493006?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sampeka",
        "html_url": "https://github.com/sampeka",
        "followers_url": "https://api.github.com/users/sampeka/followers",
        "following_url": "https://api.github.com/users/sampeka/following{/other_user}",
        "gists_url": "https://api.github.com/users/sampeka/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/sampeka/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/sampeka/subscriptions",
        "organizations_url": "https://api.github.com/users/sampeka/orgs",
        "repos_url": "https://api.github.com/users/sampeka/repos",
        "events_url": "https://api.github.com/users/sampeka/events{/privacy}",
        "received_events_url": "https://api.github.com/users/sampeka/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 10,
    "created_at": "2017-05-02T11:52:39Z",
    "updated_at": "2017-05-30T16:57:38Z",
    "closed_at": "2017-05-30T16:57:37Z",
    "author_association": "NONE",
    "body": "## Versions\r\n\r\nPython 3.6.1\r\nFlask 0.12.1\r\nWerkzeug 0.12.1\r\n\r\n## Issue\r\n\r\nA catch-all error handler (one that catches`Exception`), does not catch `werkzeug.exceptions.BadRequestKeyError`. Here's a very quick illustration of the issue:\r\n\r\nhttps://github.com/sampeka/flask-issue\r\n\r\nSteps to repoduce:\r\n1. Clone the repo above, install requirements etc\r\n2. Run `python ./example.py`\r\n3. Navigate to `/good`, see that the error handler is correctly called \r\n4. Navigate to `/bad`, see that the error handler is not called \r\n\r\nIf I define an error handler specifically for `BadRequestKeyError` it will be called, as expected.\r\n\r\nEdit: If you downgrade to `Flask==0.10.1`, this example will work.",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/298615876",
            "html_url": "https://github.com/pallets/flask/issues/2268#issuecomment-298615876",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2268",
            "id": 298615876,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI5ODYxNTg3Ng==",
            "user": {
                "login": "sampeka",
                "id": 7493006,
                "node_id": "MDQ6VXNlcjc0OTMwMDY=",
                "avatar_url": "https://avatars2.githubusercontent.com/u/7493006?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/sampeka",
                "html_url": "https://github.com/sampeka",
                "followers_url": "https://api.github.com/users/sampeka/followers",
                "following_url": "https://api.github.com/users/sampeka/following{/other_user}",
                "gists_url": "https://api.github.com/users/sampeka/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/sampeka/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/sampeka/subscriptions",
                "organizations_url": "https://api.github.com/users/sampeka/orgs",
                "repos_url": "https://api.github.com/users/sampeka/repos",
                "events_url": "https://api.github.com/users/sampeka/events{/privacy}",
                "received_events_url": "https://api.github.com/users/sampeka/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-05-02T12:02:09Z",
            "updated_at": "2017-05-02T12:02:57Z",
            "author_association": "NONE",
            "body": "Closing since this has the same issue: https://github.com/pallets/flask/issues/2267.\r\n\r\nWe have a handler in another project for `werkeug.exception.HTTPException` which isn't called for `BadRequestKeyError`, despite it being a subclass."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/298615959",
            "html_url": "https://github.com/pallets/flask/issues/2268#issuecomment-298615959",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2268",
            "id": 298615959,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI5ODYxNTk1OQ==",
            "user": {
                "login": "ThiefMaster",
                "id": 179599,
                "node_id": "MDQ6VXNlcjE3OTU5OQ==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/179599?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ThiefMaster",
                "html_url": "https://github.com/ThiefMaster",
                "followers_url": "https://api.github.com/users/ThiefMaster/followers",
                "following_url": "https://api.github.com/users/ThiefMaster/following{/other_user}",
                "gists_url": "https://api.github.com/users/ThiefMaster/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ThiefMaster/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ThiefMaster/subscriptions",
                "organizations_url": "https://api.github.com/users/ThiefMaster/orgs",
                "repos_url": "https://api.github.com/users/ThiefMaster/repos",
                "events_url": "https://api.github.com/users/ThiefMaster/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ThiefMaster/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-05-02T12:02:33Z",
            "updated_at": "2017-05-02T12:02:33Z",
            "author_association": "MEMBER",
            "body": "Does enabling the `TRAP_BAD_REQUEST_ERRORS` option help"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/298617045",
            "html_url": "https://github.com/pallets/flask/issues/2268#issuecomment-298617045",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2268",
            "id": 298617045,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI5ODYxNzA0NQ==",
            "user": {
                "login": "sampeka",
                "id": 7493006,
                "node_id": "MDQ6VXNlcjc0OTMwMDY=",
                "avatar_url": "https://avatars2.githubusercontent.com/u/7493006?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/sampeka",
                "html_url": "https://github.com/sampeka",
                "followers_url": "https://api.github.com/users/sampeka/followers",
                "following_url": "https://api.github.com/users/sampeka/following{/other_user}",
                "gists_url": "https://api.github.com/users/sampeka/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/sampeka/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/sampeka/subscriptions",
                "organizations_url": "https://api.github.com/users/sampeka/orgs",
                "repos_url": "https://api.github.com/users/sampeka/repos",
                "events_url": "https://api.github.com/users/sampeka/events{/privacy}",
                "received_events_url": "https://api.github.com/users/sampeka/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-05-02T12:08:25Z",
            "updated_at": "2017-05-02T12:08:25Z",
            "author_association": "NONE",
            "body": "@ThiefMaster no, still same issue"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/298620312",
            "html_url": "https://github.com/pallets/flask/issues/2268#issuecomment-298620312",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2268",
            "id": 298620312,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI5ODYyMDMxMg==",
            "user": {
                "login": "sampeka",
                "id": 7493006,
                "node_id": "MDQ6VXNlcjc0OTMwMDY=",
                "avatar_url": "https://avatars2.githubusercontent.com/u/7493006?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/sampeka",
                "html_url": "https://github.com/sampeka",
                "followers_url": "https://api.github.com/users/sampeka/followers",
                "following_url": "https://api.github.com/users/sampeka/following{/other_user}",
                "gists_url": "https://api.github.com/users/sampeka/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/sampeka/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/sampeka/subscriptions",
                "organizations_url": "https://api.github.com/users/sampeka/orgs",
                "repos_url": "https://api.github.com/users/sampeka/repos",
                "events_url": "https://api.github.com/users/sampeka/events{/privacy}",
                "received_events_url": "https://api.github.com/users/sampeka/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-05-02T12:24:14Z",
            "updated_at": "2017-05-02T12:24:14Z",
            "author_association": "NONE",
            "body": "Actually, turns out the issue is with other `werkzeug` exceptions as well. Not sure if it's the same issue as the one I linked above, so reopening."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/298995064",
            "html_url": "https://github.com/pallets/flask/issues/2268#issuecomment-298995064",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2268",
            "id": 298995064,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI5ODk5NTA2NA==",
            "user": {
                "login": "ngaya-ll",
                "id": 11203134,
                "node_id": "MDQ6VXNlcjExMjAzMTM0",
                "avatar_url": "https://avatars3.githubusercontent.com/u/11203134?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ngaya-ll",
                "html_url": "https://github.com/ngaya-ll",
                "followers_url": "https://api.github.com/users/ngaya-ll/followers",
                "following_url": "https://api.github.com/users/ngaya-ll/following{/other_user}",
                "gists_url": "https://api.github.com/users/ngaya-ll/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ngaya-ll/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ngaya-ll/subscriptions",
                "organizations_url": "https://api.github.com/users/ngaya-ll/orgs",
                "repos_url": "https://api.github.com/users/ngaya-ll/repos",
                "events_url": "https://api.github.com/users/ngaya-ll/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ngaya-ll/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-05-03T18:24:58Z",
            "updated_at": "2017-05-03T18:26:35Z",
            "author_association": "NONE",
            "body": "This is more similar to #941.  This issue here is that `HTTPException`s are treated differently from other exceptions in the error handling code.  Each HTTP status code gets its own handler map.  So in order to catch `BadRequestKeyError` you would need to register a handler for the `404` code."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/300828574",
            "html_url": "https://github.com/pallets/flask/issues/2268#issuecomment-300828574",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2268",
            "id": 300828574,
            "node_id": "MDEyOklzc3VlQ29tbWVudDMwMDgyODU3NA==",
            "user": {
                "login": "Jane85",
                "id": 451046,
                "node_id": "MDQ6VXNlcjQ1MTA0Ng==",
                "avatar_url": "https://avatars2.githubusercontent.com/u/451046?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/Jane85",
                "html_url": "https://github.com/Jane85",
                "followers_url": "https://api.github.com/users/Jane85/followers",
                "following_url": "https://api.github.com/users/Jane85/following{/other_user}",
                "gists_url": "https://api.github.com/users/Jane85/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/Jane85/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Jane85/subscriptions",
                "organizations_url": "https://api.github.com/users/Jane85/orgs",
                "repos_url": "https://api.github.com/users/Jane85/repos",
                "events_url": "https://api.github.com/users/Jane85/events{/privacy}",
                "received_events_url": "https://api.github.com/users/Jane85/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-05-11T15:36:55Z",
            "updated_at": "2017-05-11T15:36:55Z",
            "author_association": "NONE",
            "body": "Is there still a way now to catch all HTTPExceptions? I believe that this is a good feature as we might use third party libraries and it is not always clear what kind of exceptions are thrown by the third party library. "
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/300865488",
            "html_url": "https://github.com/pallets/flask/issues/2268#issuecomment-300865488",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2268",
            "id": 300865488,
            "node_id": "MDEyOklzc3VlQ29tbWVudDMwMDg2NTQ4OA==",
            "user": {
                "login": "ngaya-ll",
                "id": 11203134,
                "node_id": "MDQ6VXNlcjExMjAzMTM0",
                "avatar_url": "https://avatars3.githubusercontent.com/u/11203134?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ngaya-ll",
                "html_url": "https://github.com/ngaya-ll",
                "followers_url": "https://api.github.com/users/ngaya-ll/followers",
                "following_url": "https://api.github.com/users/ngaya-ll/following{/other_user}",
                "gists_url": "https://api.github.com/users/ngaya-ll/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ngaya-ll/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ngaya-ll/subscriptions",
                "organizations_url": "https://api.github.com/users/ngaya-ll/orgs",
                "repos_url": "https://api.github.com/users/ngaya-ll/repos",
                "events_url": "https://api.github.com/users/ngaya-ll/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ngaya-ll/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-05-11T17:46:58Z",
            "updated_at": "2017-05-11T17:50:23Z",
            "author_association": "NONE",
            "body": "You can catch standard `HTTPException`s by iterating over werkzeug's standard error codes and registering a handler for each of them (can be the same handler):\r\n```\r\nfrom werkzeug.exceptions import default_exceptions\r\nfor code in default_exceptions:\r\n    app.errorhandler(code)(handler)\r\n```\r\n\r\nThis will work for most real-life cases.  However, there are several bugs/caveats:\r\n* If an `HTTPException` is raised with a `code` attribute of `None`, it bypasses exception handling\r\n* Error handlers registered for integer codes will only catch `HTTPException`s with that code if the exception class inherits from werkzeug's default exception class for that code.\r\n* Custom `HTTPException`s with non-standard codes will not be caught.\r\n\r\nYou can change http exception handling by setting the `TRAP_HTTP_EXCEPTIONS` config parameter to `True`.  With this configuration:\r\n* `HTTPException`s with a `code` of `None` will be handled like regular exceptions\r\n* `HTTPException`s with other `code` values are handled the same as usual (i.e. per-code error handler lookup), except that if no handler is found the exception will be re-raised instead of generating a default error page."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/300994990",
            "html_url": "https://github.com/pallets/flask/issues/2268#issuecomment-300994990",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2268",
            "id": 300994990,
            "node_id": "MDEyOklzc3VlQ29tbWVudDMwMDk5NDk5MA==",
            "user": {
                "login": "Jane85",
                "id": 451046,
                "node_id": "MDQ6VXNlcjQ1MTA0Ng==",
                "avatar_url": "https://avatars2.githubusercontent.com/u/451046?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/Jane85",
                "html_url": "https://github.com/Jane85",
                "followers_url": "https://api.github.com/users/Jane85/followers",
                "following_url": "https://api.github.com/users/Jane85/following{/other_user}",
                "gists_url": "https://api.github.com/users/Jane85/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/Jane85/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Jane85/subscriptions",
                "organizations_url": "https://api.github.com/users/Jane85/orgs",
                "repos_url": "https://api.github.com/users/Jane85/repos",
                "events_url": "https://api.github.com/users/Jane85/events{/privacy}",
                "received_events_url": "https://api.github.com/users/Jane85/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-05-12T06:29:41Z",
            "updated_at": "2017-05-12T06:29:41Z",
            "author_association": "NONE",
            "body": "@ngaya-ll Hi, thanks for your quick reply! I tried the code that you suggested, however it does not take any effect. But I am using flask-restplus on top of flask, could it be that they have some conflicts?"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/301143925",
            "html_url": "https://github.com/pallets/flask/issues/2268#issuecomment-301143925",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2268",
            "id": 301143925,
            "node_id": "MDEyOklzc3VlQ29tbWVudDMwMTE0MzkyNQ==",
            "user": {
                "login": "ngaya-ll",
                "id": 11203134,
                "node_id": "MDQ6VXNlcjExMjAzMTM0",
                "avatar_url": "https://avatars3.githubusercontent.com/u/11203134?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ngaya-ll",
                "html_url": "https://github.com/ngaya-ll",
                "followers_url": "https://api.github.com/users/ngaya-ll/followers",
                "following_url": "https://api.github.com/users/ngaya-ll/following{/other_user}",
                "gists_url": "https://api.github.com/users/ngaya-ll/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ngaya-ll/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ngaya-ll/subscriptions",
                "organizations_url": "https://api.github.com/users/ngaya-ll/orgs",
                "repos_url": "https://api.github.com/users/ngaya-ll/repos",
                "events_url": "https://api.github.com/users/ngaya-ll/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ngaya-ll/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-05-12T17:55:25Z",
            "updated_at": "2017-05-12T17:55:25Z",
            "author_association": "NONE",
            "body": "I'm not familiar with flask-restplus but from the [documentation](http://flask-restplus.readthedocs.io/en/stable/errors.html) it appears that that extension modifies the error handling behavior, so my above comment may not apply."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/304941719",
            "html_url": "https://github.com/pallets/flask/issues/2268#issuecomment-304941719",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2268",
            "id": 304941719,
            "node_id": "MDEyOklzc3VlQ29tbWVudDMwNDk0MTcxOQ==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-05-30T16:57:37Z",
            "updated_at": "2017-05-30T16:57:37Z",
            "author_association": "MEMBER",
            "body": "Fixed by #2314."
        }
    ]
}