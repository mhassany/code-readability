{
    "url": "https://api.github.com/repos/pallets/flask/issues/1879",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/1879/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/1879/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/1879/events",
    "html_url": "https://github.com/pallets/flask/issues/1879",
    "id": 158431837,
    "node_id": "MDU6SXNzdWUxNTg0MzE4Mzc=",
    "number": 1879,
    "title": "test_main_module_paths fails on RHEL and Ubuntu when using Amazon EC2",
    "user": {
        "login": "karlw00t",
        "id": 121602,
        "node_id": "MDQ6VXNlcjEyMTYwMg==",
        "avatar_url": "https://avatars3.githubusercontent.com/u/121602?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/karlw00t",
        "html_url": "https://github.com/karlw00t",
        "followers_url": "https://api.github.com/users/karlw00t/followers",
        "following_url": "https://api.github.com/users/karlw00t/following{/other_user}",
        "gists_url": "https://api.github.com/users/karlw00t/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/karlw00t/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/karlw00t/subscriptions",
        "organizations_url": "https://api.github.com/users/karlw00t/orgs",
        "repos_url": "https://api.github.com/users/karlw00t/repos",
        "events_url": "https://api.github.com/users/karlw00t/events{/privacy}",
        "received_events_url": "https://api.github.com/users/karlw00t/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 384871623,
            "node_id": "MDU6TGFiZWwzODQ4NzE2MjM=",
            "url": "https://api.github.com/repos/pallets/flask/labels/packaging",
            "name": "packaging",
            "color": "006b75",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 8,
    "created_at": "2016-06-03T18:56:38Z",
    "updated_at": "2017-05-11T16:25:03Z",
    "closed_at": "2016-09-21T18:42:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "Running the unit tests against HEAD (e048aa4e19), I'm able to reproduce a single failing unit tests in:\n\n> tests/test_instance_config.py::test_main_module_paths\n\nI'm able to reproduce the bug on Amazon Linux 2016.03.1 and RHEL 7.2.  I'm running on a fresh EC2 instance in both cases, and the steps to reproduce are the same, here is my bash history:\n\n> sudo yum install python-virtualenv\n> sudo yum groupinstall 'Development Tools'\n> virtualenv flask\n> cd flask/\n> git clone https://github.com/pallets/flask.git\n> cd flask/\n> source ../bin/activate\n> pip install -e .\n> pip install -r test-requirements.txt \n> py.test tests/test_instance_config.py::test_main_module_paths\n\nfailing output:\n\n> modules_tmpdir = local('/tmp/pytest-of-ec2-user/pytest-0/test_main_module_paths0/modules_tmpdir'), purge_module = <function inner at 0x170c1b8>\n> \n> ```\n> def test_main_module_paths(modules_tmpdir, purge_module):\n>     app = modules_tmpdir.join('main_app.py')\n>     app.write('import flask\\n\\napp = flask.Flask(\"__main__\")')\n>     purge_module('main_app')\n> \n>     from main_app import app\n>     here = os.path.abspath(os.getcwd())\n> ```\n> \n> > ```\n> >   assert app.instance_path == os.path.join(here, 'instance')\n> > ```\n> > \n> > E       assert '/home/ec2-us...r/py-instance' == '/home/ec2-use...lask/instance'\n> > E         - /home/ec2-user/flask/var/py-instance\n> > E         ?                      ^ ^ ---\n> > E         + /home/ec2-user/flask/flask/instance\n> > E         ?                      ^^ ^^\n> \n> tests/test_instance_config.py:33: AssertionError\n\nThis test seems to be passing fine on Travis, and on Debian and OSX.  It appears to be a Redhat/Amazon Linux specific issue.  I ran `git bisect` back to commits on May 26th, 2016 and the test still fails all attempts.\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/223671487",
            "html_url": "https://github.com/pallets/flask/issues/1879#issuecomment-223671487",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1879",
            "id": 223671487,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIyMzY3MTQ4Nw==",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-06-03T19:27:04Z",
            "updated_at": "2016-06-03T19:27:04Z",
            "author_association": "MEMBER",
            "body": "I'm sorry, but what am I supposed to do?\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/223671740",
            "html_url": "https://github.com/pallets/flask/issues/1879#issuecomment-223671740",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1879",
            "id": 223671740,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIyMzY3MTc0MA==",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-06-03T19:27:57Z",
            "updated_at": "2016-06-03T19:27:57Z",
            "author_association": "MEMBER",
            "body": "Are you sure that you installed Flask on both machines the same way? What are the respective setuptools, pip and Python versions?\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/223675365",
            "html_url": "https://github.com/pallets/flask/issues/1879#issuecomment-223675365",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1879",
            "id": 223675365,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIyMzY3NTM2NQ==",
            "user": {
                "login": "jeffwidman",
                "id": 483314,
                "node_id": "MDQ6VXNlcjQ4MzMxNA==",
                "avatar_url": "https://avatars2.githubusercontent.com/u/483314?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/jeffwidman",
                "html_url": "https://github.com/jeffwidman",
                "followers_url": "https://api.github.com/users/jeffwidman/followers",
                "following_url": "https://api.github.com/users/jeffwidman/following{/other_user}",
                "gists_url": "https://api.github.com/users/jeffwidman/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/jeffwidman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jeffwidman/subscriptions",
                "organizations_url": "https://api.github.com/users/jeffwidman/orgs",
                "repos_url": "https://api.github.com/users/jeffwidman/repos",
                "events_url": "https://api.github.com/users/jeffwidman/events{/privacy}",
                "received_events_url": "https://api.github.com/users/jeffwidman/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-06-03T19:42:31Z",
            "updated_at": "2016-06-03T19:53:24Z",
            "author_association": "MEMBER",
            "body": "Sorry, I should have added context. This is a Pycon sprinter who hit this issue and works at Amazon. While the root cause is likely upstream, there is a small chance it's something we can change in a non-hacky way. Since he'd done all the research and had a clearly reproducible test case, I suggested he add it to the tracker so that we can let it float a little and see if anyone else has a suggested fix, especially because if it turns out to be an amazon issue he can push it forward internally. So I'd just let this float for a bit and if no one else hits it we can close it down the road.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/223707825",
            "html_url": "https://github.com/pallets/flask/issues/1879#issuecomment-223707825",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1879",
            "id": 223707825,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIyMzcwNzgyNQ==",
            "user": {
                "login": "karlw00t",
                "id": 121602,
                "node_id": "MDQ6VXNlcjEyMTYwMg==",
                "avatar_url": "https://avatars3.githubusercontent.com/u/121602?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/karlw00t",
                "html_url": "https://github.com/karlw00t",
                "followers_url": "https://api.github.com/users/karlw00t/followers",
                "following_url": "https://api.github.com/users/karlw00t/following{/other_user}",
                "gists_url": "https://api.github.com/users/karlw00t/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/karlw00t/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/karlw00t/subscriptions",
                "organizations_url": "https://api.github.com/users/karlw00t/orgs",
                "repos_url": "https://api.github.com/users/karlw00t/repos",
                "events_url": "https://api.github.com/users/karlw00t/events{/privacy}",
                "received_events_url": "https://api.github.com/users/karlw00t/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-06-03T22:16:29Z",
            "updated_at": "2016-06-03T22:16:29Z",
            "author_association": "CONTRIBUTOR",
            "body": "I ran this on Ubuntu (trusty-14.04) on an EC2 instance as well and was able to reproduce this:\n\n> sudo apt install build-essential\n> sudo apt install python-virtualenv\n> virtualenv flask\n> cd flask/\n> source bin/activate\n> sudo apt install git\n> git clone https://github.com/pallets/flask.git\n> cd flask/\n> pip install -e .\n> pip install -r test-requirements.txt \n> py.test\n\nThe error that I'm getting is in the same function, same line.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/223708705",
            "html_url": "https://github.com/pallets/flask/issues/1879#issuecomment-223708705",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1879",
            "id": 223708705,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIyMzcwODcwNQ==",
            "user": {
                "login": "karlw00t",
                "id": 121602,
                "node_id": "MDQ6VXNlcjEyMTYwMg==",
                "avatar_url": "https://avatars3.githubusercontent.com/u/121602?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/karlw00t",
                "html_url": "https://github.com/karlw00t",
                "followers_url": "https://api.github.com/users/karlw00t/followers",
                "following_url": "https://api.github.com/users/karlw00t/following{/other_user}",
                "gists_url": "https://api.github.com/users/karlw00t/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/karlw00t/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/karlw00t/subscriptions",
                "organizations_url": "https://api.github.com/users/karlw00t/orgs",
                "repos_url": "https://api.github.com/users/karlw00t/repos",
                "events_url": "https://api.github.com/users/karlw00t/events{/privacy}",
                "received_events_url": "https://api.github.com/users/karlw00t/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-06-03T22:21:52Z",
            "updated_at": "2016-06-03T22:21:52Z",
            "author_association": "CONTRIBUTOR",
            "body": "Version numbers from the Ubuntu host:\n\n> (flask)ubuntu@ip-172-31-12-20:~/flask/flask$ pip --version\n> pip 1.5.4 from /home/ubuntu/flask/local/lib/python2.7/site-packages (python 2.7)\n> (flask)ubuntu@ip-172-31-12-20:~/flask/flask$ python --version\n> Python 2.7.6\n> (flask)ubuntu@ip-172-31-12-20:~/flask/flask$ python -m easy_install --version\n> setuptools 2.2\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/248691332",
            "html_url": "https://github.com/pallets/flask/issues/1879#issuecomment-248691332",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1879",
            "id": 248691332,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI0ODY5MTMzMg==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-09-21T17:55:58Z",
            "updated_at": "2016-09-21T18:44:09Z",
            "author_association": "MEMBER",
            "body": "#2035 jogged my memory of and old issue I helped someone debug.  The env should be inside the project, but you've checked out the project inside the env.  This makes Flask think that it's installed rather than running locally.  The test doesn't expect the project to appear to be installed.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/300841290",
            "html_url": "https://github.com/pallets/flask/issues/1879#issuecomment-300841290",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1879",
            "id": 300841290,
            "node_id": "MDEyOklzc3VlQ29tbWVudDMwMDg0MTI5MA==",
            "user": {
                "login": "begueradj",
                "id": 15982164,
                "node_id": "MDQ6VXNlcjE1OTgyMTY0",
                "avatar_url": "https://avatars3.githubusercontent.com/u/15982164?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/begueradj",
                "html_url": "https://github.com/begueradj",
                "followers_url": "https://api.github.com/users/begueradj/followers",
                "following_url": "https://api.github.com/users/begueradj/following{/other_user}",
                "gists_url": "https://api.github.com/users/begueradj/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/begueradj/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/begueradj/subscriptions",
                "organizations_url": "https://api.github.com/users/begueradj/orgs",
                "repos_url": "https://api.github.com/users/begueradj/repos",
                "events_url": "https://api.github.com/users/begueradj/events{/privacy}",
                "received_events_url": "https://api.github.com/users/begueradj/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-05-11T16:19:26Z",
            "updated_at": "2017-05-11T16:19:26Z",
            "author_association": "NONE",
            "body": "I have this same problem (test_instance_config.py:33: AssertionError) with the current Flask version. Environment is:\r\n- Ubuntu 16.04 LTS\r\n- Python 3.5.2 \r\n- pytest version 3.0.7\r\n\r\n`ls` inside the virtual environment outputs this: `ls\r\nbin  flask  include  lib  pip-selfcheck.json\r\n`\r\nHow to fix this?\r\n\r\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/300842507",
            "html_url": "https://github.com/pallets/flask/issues/1879#issuecomment-300842507",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1879",
            "id": 300842507,
            "node_id": "MDEyOklzc3VlQ29tbWVudDMwMDg0MjUwNw==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-05-11T16:23:52Z",
            "updated_at": "2017-05-11T16:25:03Z",
            "author_association": "MEMBER",
            "body": "Don't put the flask dir in your env dir, put your env dir in the flask dir (or completely separate). Actually, that's literally what I said in the previous comment."
        }
    ]
}