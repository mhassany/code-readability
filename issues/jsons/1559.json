{
    "url": "https://api.github.com/repos/pallets/flask/issues/1559",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/1559/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/1559/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/1559/events",
    "html_url": "https://github.com/pallets/flask/issues/1559",
    "id": 102580862,
    "node_id": "MDU6SXNzdWUxMDI1ODA4NjI=",
    "number": 1559,
    "title": "url_for('static', _external=True) gives bogus url with app.url_map.host_matching = True",
    "user": {
        "login": "jab",
        "id": 64992,
        "node_id": "MDQ6VXNlcjY0OTky",
        "avatar_url": "https://avatars1.githubusercontent.com/u/64992?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jab",
        "html_url": "https://github.com/jab",
        "followers_url": "https://api.github.com/users/jab/followers",
        "following_url": "https://api.github.com/users/jab/following{/other_user}",
        "gists_url": "https://api.github.com/users/jab/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/jab/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jab/subscriptions",
        "organizations_url": "https://api.github.com/users/jab/orgs",
        "repos_url": "https://api.github.com/users/jab/repos",
        "events_url": "https://api.github.com/users/jab/events{/privacy}",
        "received_events_url": "https://api.github.com/users/jab/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": {
        "login": "untitaker",
        "id": 837573,
        "node_id": "MDQ6VXNlcjgzNzU3Mw==",
        "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/untitaker",
        "html_url": "https://github.com/untitaker",
        "followers_url": "https://api.github.com/users/untitaker/followers",
        "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
        "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
        "organizations_url": "https://api.github.com/users/untitaker/orgs",
        "repos_url": "https://api.github.com/users/untitaker/repos",
        "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
        "received_events_url": "https://api.github.com/users/untitaker/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "untitaker",
            "id": 837573,
            "node_id": "MDQ6VXNlcjgzNzU3Mw==",
            "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/untitaker",
            "html_url": "https://github.com/untitaker",
            "followers_url": "https://api.github.com/users/untitaker/followers",
            "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
            "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
            "organizations_url": "https://api.github.com/users/untitaker/orgs",
            "repos_url": "https://api.github.com/users/untitaker/repos",
            "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
            "received_events_url": "https://api.github.com/users/untitaker/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 9,
    "created_at": "2015-08-23T02:10:45Z",
    "updated_at": "2017-04-07T14:31:58Z",
    "closed_at": "2017-04-07T14:31:54Z",
    "author_association": "MEMBER",
    "body": "``` python\napp = Flask(__name__)\napp.url_map.host_matching = True\napp.url_map._rules_by_endpoint['static'][0].host = 'mydomain.com'  # XXX better way to do this?\nwith app.test_request_context():\n    print url_for('static', filename='foo', _external=True)\n```\n\n=>\n`'http:///static/foo'`\n\nExpected `'http://mydomain.com/static/foo'`.\n\nAm I missing something, or is this a bug?\n\nThanks for looking and for the great work on Flask.\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/133851970",
            "html_url": "https://github.com/pallets/flask/issues/1559#issuecomment-133851970",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1559",
            "id": 133851970,
            "node_id": "MDEyOklzc3VlQ29tbWVudDEzMzg1MTk3MA==",
            "user": {
                "login": "jab",
                "id": 64992,
                "node_id": "MDQ6VXNlcjY0OTky",
                "avatar_url": "https://avatars1.githubusercontent.com/u/64992?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/jab",
                "html_url": "https://github.com/jab",
                "followers_url": "https://api.github.com/users/jab/followers",
                "following_url": "https://api.github.com/users/jab/following{/other_user}",
                "gists_url": "https://api.github.com/users/jab/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/jab/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jab/subscriptions",
                "organizations_url": "https://api.github.com/users/jab/orgs",
                "repos_url": "https://api.github.com/users/jab/repos",
                "events_url": "https://api.github.com/users/jab/events{/privacy}",
                "received_events_url": "https://api.github.com/users/jab/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-08-23T14:32:26Z",
            "updated_at": "2015-08-23T14:32:26Z",
            "author_association": "MEMBER",
            "body": "Just made a PR that fixes this: #1560 \nHope this helps. Thanks in advance for reviewing, and let me know if you would prefer another approach.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/133878406",
            "html_url": "https://github.com/pallets/flask/issues/1559#issuecomment-133878406",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1559",
            "id": 133878406,
            "node_id": "MDEyOklzc3VlQ29tbWVudDEzMzg3ODQwNg==",
            "user": {
                "login": "jab",
                "id": 64992,
                "node_id": "MDQ6VXNlcjY0OTky",
                "avatar_url": "https://avatars1.githubusercontent.com/u/64992?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/jab",
                "html_url": "https://github.com/jab",
                "followers_url": "https://api.github.com/users/jab/followers",
                "following_url": "https://api.github.com/users/jab/following{/other_user}",
                "gists_url": "https://api.github.com/users/jab/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/jab/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jab/subscriptions",
                "organizations_url": "https://api.github.com/users/jab/orgs",
                "repos_url": "https://api.github.com/users/jab/repos",
                "events_url": "https://api.github.com/users/jab/events{/privacy}",
                "received_events_url": "https://api.github.com/users/jab/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-08-23T16:54:20Z",
            "updated_at": "2015-08-23T16:54:20Z",
            "author_association": "MEMBER",
            "body": "For anyone needing to work around this in the latest stable release (0.10.1), you can remove the static route and re-add it after enabling host_matching:\n\n``` python\napp = Flask(__name__)\n# clear the automatically added route for static\napp.url_map._rules.clear()\napp.url_map._rules_by_endpoint.clear()\n# enable host matching and re-add the static route with the desired host\napp.url_map.host_matching = True\napp.add_url_rule(app.static_url_path + '/<path:filename>',\n                 endpoint='static',\n                 view_func=app.send_static_file,\n                 host=static_host)\n```\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/150331301",
            "html_url": "https://github.com/pallets/flask/issues/1559#issuecomment-150331301",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1559",
            "id": 150331301,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE1MDMzMTMwMQ==",
            "user": {
                "login": "philippe2803",
                "id": 4492530,
                "node_id": "MDQ6VXNlcjQ0OTI1MzA=",
                "avatar_url": "https://avatars0.githubusercontent.com/u/4492530?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/philippe2803",
                "html_url": "https://github.com/philippe2803",
                "followers_url": "https://api.github.com/users/philippe2803/followers",
                "following_url": "https://api.github.com/users/philippe2803/following{/other_user}",
                "gists_url": "https://api.github.com/users/philippe2803/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/philippe2803/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/philippe2803/subscriptions",
                "organizations_url": "https://api.github.com/users/philippe2803/orgs",
                "repos_url": "https://api.github.com/users/philippe2803/repos",
                "events_url": "https://api.github.com/users/philippe2803/events{/privacy}",
                "received_events_url": "https://api.github.com/users/philippe2803/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-10-22T19:33:05Z",
            "updated_at": "2015-10-22T19:33:05Z",
            "author_association": "NONE",
            "body": "@jab \nThis worked for me. That really helped. Thank you.\nYou may encounter a problem with your fonts however. I had the following message:\n\n_Font from origin 'http://statichost.com' has been blocked from loading by Cross-Origin Resource Sharing policy: No 'Access-Control-Allow-Origin' header is present on the requested resource. Origin 'http://domainA.com is therefore not allowed access._\n\nFor NGINX, the trick is to add  **add_header Access-Control-Allow-Origin**  into the static location. It should look as follow:\n\n```\nlocation /static {\n autoindex on;\n alias /path/to/static/folder;\n add_header \"Access-Control-Allow-Origin\" \"*\"; \n}\n```\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/150332677",
            "html_url": "https://github.com/pallets/flask/issues/1559#issuecomment-150332677",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1559",
            "id": 150332677,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE1MDMzMjY3Nw==",
            "user": {
                "login": "jab",
                "id": 64992,
                "node_id": "MDQ6VXNlcjY0OTky",
                "avatar_url": "https://avatars1.githubusercontent.com/u/64992?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/jab",
                "html_url": "https://github.com/jab",
                "followers_url": "https://api.github.com/users/jab/followers",
                "following_url": "https://api.github.com/users/jab/following{/other_user}",
                "gists_url": "https://api.github.com/users/jab/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/jab/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jab/subscriptions",
                "organizations_url": "https://api.github.com/users/jab/orgs",
                "repos_url": "https://api.github.com/users/jab/repos",
                "events_url": "https://api.github.com/users/jab/events{/privacy}",
                "received_events_url": "https://api.github.com/users/jab/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-10-22T19:35:59Z",
            "updated_at": "2015-10-22T19:35:59Z",
            "author_association": "MEMBER",
            "body": "@philippe2803 Glad this helped you. Your fonts issue sounds unrelated fwiw.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/262131697",
            "html_url": "https://github.com/pallets/flask/issues/1559#issuecomment-262131697",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1559",
            "id": 262131697,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI2MjEzMTY5Nw==",
            "user": {
                "login": "blark",
                "id": 1313601,
                "node_id": "MDQ6VXNlcjEzMTM2MDE=",
                "avatar_url": "https://avatars2.githubusercontent.com/u/1313601?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/blark",
                "html_url": "https://github.com/blark",
                "followers_url": "https://api.github.com/users/blark/followers",
                "following_url": "https://api.github.com/users/blark/following{/other_user}",
                "gists_url": "https://api.github.com/users/blark/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/blark/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/blark/subscriptions",
                "organizations_url": "https://api.github.com/users/blark/orgs",
                "repos_url": "https://api.github.com/users/blark/repos",
                "events_url": "https://api.github.com/users/blark/events{/privacy}",
                "received_events_url": "https://api.github.com/users/blark/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-11-22T02:38:29Z",
            "updated_at": "2016-11-22T02:54:58Z",
            "author_association": "NONE",
            "body": "Ugh. This bug just wasted a couple hours of my time. Finally found this issue, thanks for the info.\r\n\r\nDo you know of any way to fix this for Blueprints, so I could have a static folder for each domain that I'm serving? It seems that `host=` support is very half baked at the moment. "
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/262133972",
            "html_url": "https://github.com/pallets/flask/issues/1559#issuecomment-262133972",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1559",
            "id": 262133972,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI2MjEzMzk3Mg==",
            "user": {
                "login": "jab",
                "id": 64992,
                "node_id": "MDQ6VXNlcjY0OTky",
                "avatar_url": "https://avatars1.githubusercontent.com/u/64992?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/jab",
                "html_url": "https://github.com/jab",
                "followers_url": "https://api.github.com/users/jab/followers",
                "following_url": "https://api.github.com/users/jab/following{/other_user}",
                "gists_url": "https://api.github.com/users/jab/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/jab/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jab/subscriptions",
                "organizations_url": "https://api.github.com/users/jab/orgs",
                "repos_url": "https://api.github.com/users/jab/repos",
                "events_url": "https://api.github.com/users/jab/events{/privacy}",
                "received_events_url": "https://api.github.com/users/jab/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-11-22T02:54:52Z",
            "updated_at": "2016-11-22T02:55:30Z",
            "author_association": "MEMBER",
            "body": "Had totally forgotten about this issue! Looks like [I submitted a PR that fixes it](https://github.com/pallets/flask/pull/1560) 15 months ago. It looks like it hasn't been reviewed yet, still merges cleanly, and wouldn't take long to review. Can any maintainers please take a peek, or at least take a minute to chime in? Thanks again for maintaining Flask."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/262135427",
            "html_url": "https://github.com/pallets/flask/issues/1559#issuecomment-262135427",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1559",
            "id": 262135427,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI2MjEzNTQyNw==",
            "user": {
                "login": "jab",
                "id": 64992,
                "node_id": "MDQ6VXNlcjY0OTky",
                "avatar_url": "https://avatars1.githubusercontent.com/u/64992?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/jab",
                "html_url": "https://github.com/jab",
                "followers_url": "https://api.github.com/users/jab/followers",
                "following_url": "https://api.github.com/users/jab/following{/other_user}",
                "gists_url": "https://api.github.com/users/jab/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/jab/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jab/subscriptions",
                "organizations_url": "https://api.github.com/users/jab/orgs",
                "repos_url": "https://api.github.com/users/jab/repos",
                "events_url": "https://api.github.com/users/jab/events{/privacy}",
                "received_events_url": "https://api.github.com/users/jab/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-11-22T03:06:21Z",
            "updated_at": "2017-02-28T17:40:14Z",
            "author_association": "MEMBER",
            "body": "Btw happy to help maintain Flask if it would help. I've gotten [several commits landed in werkzeug](https://github.com/pallets/werkzeug/commits?author=jab) (as well as [urllib3](https://github.com/shazow/urllib3/commits?author=jab), [lxml](https://github.com/lxml/lxml/commits?author=jab), et al. and am also the author of [bidict](https://pypi.python.org/pypi/bidict)), fwiw."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/262142451",
            "html_url": "https://github.com/pallets/flask/issues/1559#issuecomment-262142451",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1559",
            "id": 262142451,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI2MjE0MjQ1MQ==",
            "user": {
                "login": "blark",
                "id": 1313601,
                "node_id": "MDQ6VXNlcjEzMTM2MDE=",
                "avatar_url": "https://avatars2.githubusercontent.com/u/1313601?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/blark",
                "html_url": "https://github.com/blark",
                "followers_url": "https://api.github.com/users/blark/followers",
                "following_url": "https://api.github.com/users/blark/following{/other_user}",
                "gists_url": "https://api.github.com/users/blark/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/blark/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/blark/subscriptions",
                "organizations_url": "https://api.github.com/users/blark/orgs",
                "repos_url": "https://api.github.com/users/blark/repos",
                "events_url": "https://api.github.com/users/blark/events{/privacy}",
                "received_events_url": "https://api.github.com/users/blark/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-11-22T04:07:14Z",
            "updated_at": "2016-11-22T04:54:34Z",
            "author_association": "NONE",
            "body": "Any idea how I can improve my hack for getting Blueprint static files to work? Right now I've got:\r\n\r\n```\r\napp.add_url_rule('/static' + '/<path:filename>', endpoint='foo.static',\r\n                 view_func=app.send_static_file, host='test.foo.com')\r\n```\r\n\r\nBut I really want to serve the static files from a different directory (not the root `/static` dir). Do you know if there is any way I can use `send_from_directory`? Thanks!\r\n\r\n**EDIT** I hacked this together, it works but I can't figure out how to properly tell view_func to pass parameters. I'd rather do something like `view_func=app.send_file(path, filename)` so I can reuse this function for other Blueprints but it doesn't seem to pass the parameters when I do that. \r\n\r\n```\r\ndef send_file(filename, **kwargs):\r\n    return send_from_directory(static_path, filename)\r\n\r\napp.add_url_rule('/static' + '/<path:filename>', endpoint='foo.static',\r\n                 view_func=send_file, host=HOST)\r\n```\r\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/283110421",
            "html_url": "https://github.com/pallets/flask/issues/1559#issuecomment-283110421",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1559",
            "id": 283110421,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI4MzExMDQyMQ==",
            "user": {
                "login": "jab",
                "id": 64992,
                "node_id": "MDQ6VXNlcjY0OTky",
                "avatar_url": "https://avatars1.githubusercontent.com/u/64992?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/jab",
                "html_url": "https://github.com/jab",
                "followers_url": "https://api.github.com/users/jab/followers",
                "following_url": "https://api.github.com/users/jab/following{/other_user}",
                "gists_url": "https://api.github.com/users/jab/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/jab/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/jab/subscriptions",
                "organizations_url": "https://api.github.com/users/jab/orgs",
                "repos_url": "https://api.github.com/users/jab/repos",
                "events_url": "https://api.github.com/users/jab/events{/privacy}",
                "received_events_url": "https://api.github.com/users/jab/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-02-28T17:38:03Z",
            "updated_at": "2017-02-28T17:40:23Z",
            "author_association": "MEMBER",
            "body": "Just looked through [my open pull requests](https://github.com/pulls) and found #1560, opened August 2015 and not yet acknowledged, which fixes this. Can any maintainers either take a look or delegate sometime soonish? As I said a couple comments above, \"happy to help maintain Flask if it would help. I've gotten several commits landed in werkzeug (as well as urllib3, lxml, et al...\""
        }
    ]
}