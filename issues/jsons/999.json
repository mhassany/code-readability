{
    "url": "https://api.github.com/repos/pallets/flask/issues/999",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/999/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/999/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/999/events",
    "html_url": "https://github.com/pallets/flask/issues/999",
    "id": 29353123,
    "node_id": "MDU6SXNzdWUyOTM1MzEyMw==",
    "number": 999,
    "title": "send_file in combination with chrome on android",
    "user": {
        "login": "sander76",
        "id": 1688712,
        "node_id": "MDQ6VXNlcjE2ODg3MTI=",
        "avatar_url": "https://avatars2.githubusercontent.com/u/1688712?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/sander76",
        "html_url": "https://github.com/sander76",
        "followers_url": "https://api.github.com/users/sander76/followers",
        "following_url": "https://api.github.com/users/sander76/following{/other_user}",
        "gists_url": "https://api.github.com/users/sander76/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/sander76/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/sander76/subscriptions",
        "organizations_url": "https://api.github.com/users/sander76/orgs",
        "repos_url": "https://api.github.com/users/sander76/repos",
        "events_url": "https://api.github.com/users/sander76/events{/privacy}",
        "received_events_url": "https://api.github.com/users/sander76/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 6,
    "created_at": "2014-03-13T14:12:13Z",
    "updated_at": "2014-07-27T12:03:43Z",
    "closed_at": "2014-07-27T12:03:43Z",
    "author_association": "NONE",
    "body": "A cStringIO file containing pdf data is uploaded using send_file:\n\n```\n# pdf is the cStringIO instance.\nreturn send_file(pdf, mimetype=\"application/pdf\",\n                         as_attachment=True,\n                         attachment_filename=\"basicreport.pdf\")\n```\n\nthis works on android when using firefox. On chrome the download fails with an \"Untitled\" filename.\n\nWhen manually creating the response manually all works fine..\n\n```\nresponse = make_response(pdf.read())\nresponse.headers['Content-Type'] = 'application/pdf'\nresponse.headers['Content-Disposition'] = 'attachment; filename=basicreport.pdf'\n```\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/37539880",
            "html_url": "https://github.com/pallets/flask/issues/999#issuecomment-37539880",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/999",
            "id": 37539880,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM3NTM5ODgw",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-03-13T14:36:29Z",
            "updated_at": "2014-03-13T14:36:29Z",
            "author_association": "MEMBER",
            "body": "When using send_file, the following headers are additionally sent (compared to your manual creation of the response):\n\n```\nContent-Type: application/pdf\nCache-Control: public, max-age=43200\nExpires: Fri, 14 Mar 2014 02:30:19 GMT\nConnection: close\n```\n\nAnd the following header is only present in your manual creation of the response:\n\n```\nContent-Length: 5\n```\n\nCan you experiment with\n\n1.) Adding the `Content-Length` header after send_file, like this:\n\n```\nr = send_file(...)\nr.headers['Content-Length'] = 5  # the correct value\nreturn r\n```\n\n2.) Removing the additional headers one-by-one after invoking send_file.\n\nIn any case i doubt that this is an issue with Flask or Werkzeug. This is better filed against Chrome.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/37542730",
            "html_url": "https://github.com/pallets/flask/issues/999#issuecomment-37542730",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/999",
            "id": 37542730,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM3NTQyNzMw",
            "user": {
                "login": "sander76",
                "id": 1688712,
                "node_id": "MDQ6VXNlcjE2ODg3MTI=",
                "avatar_url": "https://avatars2.githubusercontent.com/u/1688712?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/sander76",
                "html_url": "https://github.com/sander76",
                "followers_url": "https://api.github.com/users/sander76/followers",
                "following_url": "https://api.github.com/users/sander76/following{/other_user}",
                "gists_url": "https://api.github.com/users/sander76/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/sander76/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/sander76/subscriptions",
                "organizations_url": "https://api.github.com/users/sander76/orgs",
                "repos_url": "https://api.github.com/users/sander76/repos",
                "events_url": "https://api.github.com/users/sander76/events{/privacy}",
                "received_events_url": "https://api.github.com/users/sander76/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-03-13T14:59:06Z",
            "updated_at": "2014-03-13T14:59:06Z",
            "author_association": "NONE",
            "body": "Adding Content-Length seems to do the trick !\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/37543895",
            "html_url": "https://github.com/pallets/flask/issues/999#issuecomment-37543895",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/999",
            "id": 37543895,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM3NTQzODk1",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-03-13T15:08:15Z",
            "updated_at": "2014-03-13T15:08:15Z",
            "author_association": "MEMBER",
            "body": "That's great to hear! Unfortunately\n\n1.) this is really something that should be fixed in Chrome, so this issue should be closed\n2.) Adding Content-Length for all kinds of file objects is impossible, Werkzeug already does something for files actually on disk, maybe it could do something similar to `len(file.getvalue())` for StringIO instances. But i don't think that's worth it, because\n3.) Why even use a StringIO if you can pass its content to make_response directly?\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/37544240",
            "html_url": "https://github.com/pallets/flask/issues/999#issuecomment-37544240",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/999",
            "id": 37544240,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM3NTQ0MjQw",
            "user": {
                "login": "sander76",
                "id": 1688712,
                "node_id": "MDQ6VXNlcjE2ODg3MTI=",
                "avatar_url": "https://avatars2.githubusercontent.com/u/1688712?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/sander76",
                "html_url": "https://github.com/sander76",
                "followers_url": "https://api.github.com/users/sander76/followers",
                "following_url": "https://api.github.com/users/sander76/following{/other_user}",
                "gists_url": "https://api.github.com/users/sander76/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/sander76/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/sander76/subscriptions",
                "organizations_url": "https://api.github.com/users/sander76/orgs",
                "repos_url": "https://api.github.com/users/sander76/repos",
                "events_url": "https://api.github.com/users/sander76/events{/privacy}",
                "received_events_url": "https://api.github.com/users/sander76/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-03-13T15:10:51Z",
            "updated_at": "2014-03-13T15:11:13Z",
            "author_association": "NONE",
            "body": "1. I agree especially as the other browser don't seem to suffer from this.\n2. Possibly because I am not a Python ace ;-). I am generating a pdf with reportlab and reportlab wants a file-like-object to generate the pdf. So I guess there is no other way than to use StringIO.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/37546695",
            "html_url": "https://github.com/pallets/flask/issues/999#issuecomment-37546695",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/999",
            "id": 37546695,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM3NTQ2Njk1",
            "user": {
                "login": "DasIch",
                "id": 182316,
                "node_id": "MDQ6VXNlcjE4MjMxNg==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/182316?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/DasIch",
                "html_url": "https://github.com/DasIch",
                "followers_url": "https://api.github.com/users/DasIch/followers",
                "following_url": "https://api.github.com/users/DasIch/following{/other_user}",
                "gists_url": "https://api.github.com/users/DasIch/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/DasIch/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/DasIch/subscriptions",
                "organizations_url": "https://api.github.com/users/DasIch/orgs",
                "repos_url": "https://api.github.com/users/DasIch/repos",
                "events_url": "https://api.github.com/users/DasIch/events{/privacy}",
                "received_events_url": "https://api.github.com/users/DasIch/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-03-13T15:30:22Z",
            "updated_at": "2014-03-13T15:30:22Z",
            "author_association": "CONTRIBUTOR",
            "body": "This is a bug in Chrome more specifically it seems to be issue [#85549](http://code.google.com/p/chromium/issues/detail?id=85549), which is supposed to be fixed. In the title you mention the issue is with Chrome on Android, could it be the case that your Android/Chrome version is outdated?\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/37546858",
            "html_url": "https://github.com/pallets/flask/issues/999#issuecomment-37546858",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/999",
            "id": 37546858,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM3NTQ2ODU4",
            "user": {
                "login": "sander76",
                "id": 1688712,
                "node_id": "MDQ6VXNlcjE2ODg3MTI=",
                "avatar_url": "https://avatars2.githubusercontent.com/u/1688712?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/sander76",
                "html_url": "https://github.com/sander76",
                "followers_url": "https://api.github.com/users/sander76/followers",
                "following_url": "https://api.github.com/users/sander76/following{/other_user}",
                "gists_url": "https://api.github.com/users/sander76/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/sander76/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/sander76/subscriptions",
                "organizations_url": "https://api.github.com/users/sander76/orgs",
                "repos_url": "https://api.github.com/users/sander76/repos",
                "events_url": "https://api.github.com/users/sander76/events{/privacy}",
                "received_events_url": "https://api.github.com/users/sander76/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-03-13T15:31:34Z",
            "updated_at": "2014-03-13T15:31:34Z",
            "author_association": "NONE",
            "body": "Just checked... All is up to date on my Nexus4\n"
        }
    ]
}