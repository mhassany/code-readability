{
    "url": "https://api.github.com/repos/pallets/flask/issues/1005",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/1005/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/1005/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/1005/events",
    "html_url": "https://github.com/pallets/flask/issues/1005",
    "id": 29773173,
    "node_id": "MDU6SXNzdWUyOTc3MzE3Mw==",
    "number": 1005,
    "title": "Using encodings other than UTF-8 in Response",
    "user": {
        "login": "barosl",
        "id": 573768,
        "node_id": "MDQ6VXNlcjU3Mzc2OA==",
        "avatar_url": "https://avatars3.githubusercontent.com/u/573768?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/barosl",
        "html_url": "https://github.com/barosl",
        "followers_url": "https://api.github.com/users/barosl/followers",
        "following_url": "https://api.github.com/users/barosl/following{/other_user}",
        "gists_url": "https://api.github.com/users/barosl/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/barosl/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/barosl/subscriptions",
        "organizations_url": "https://api.github.com/users/barosl/orgs",
        "repos_url": "https://api.github.com/users/barosl/repos",
        "events_url": "https://api.github.com/users/barosl/events{/privacy}",
        "received_events_url": "https://api.github.com/users/barosl/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 6,
    "created_at": "2014-03-19T21:17:07Z",
    "updated_at": "2017-04-08T17:58:09Z",
    "closed_at": "2017-04-08T17:58:09Z",
    "author_association": "NONE",
    "body": "The Flask documentation states that Flask assumes the encoding of the response to be UTF-8.\n\n```\nthe encoding for text on your website is UTF-8\n\nFrom http://flask.pocoo.org/docs/unicode/\n```\n\nDoes that mean we are discouraged to use the encodings other than UTF-8 in the Flask response? I was unable to find a way to change the intended encoding of neither `flask.wrappers.Response` nor `werkzeug.wrappers.Response` correctly.\n1. I cannot directly pass the text to the constructor, as it calls set_data() with the UTF-8 encoding. That's because the constructor has no `charset` parameter. There is no way to change its behavior. So I should create the response object with no constructor arguments, and then assign 'utf-8' to `response.charset`, and call `response.set_data()`.\n2. But still, as `content_type` is determined in the constructor, it will still be \"text/html; charset=UTF-8\" because the `charset` attribute is always `'utf-8'` during the object creation process. So I'm forced to pass `content_type` to the constructor, which is kinda confusing because my original intention was just changing the encoding, rather than explicitly setting the Content-Type.\n\nDo I understand the process accurately?\n\nIf I'm right, I suggest:\n1. Allow passing `charset` to the `Response` class.\n2. Or, the `content_type` attribute should be updated again when the user manually sets the `charset` attribute.\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/38108210",
            "html_url": "https://github.com/pallets/flask/issues/1005#issuecomment-38108210",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1005",
            "id": 38108210,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM4MTA4MjEw",
            "user": {
                "login": "ThiefMaster",
                "id": 179599,
                "node_id": "MDQ6VXNlcjE3OTU5OQ==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/179599?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ThiefMaster",
                "html_url": "https://github.com/ThiefMaster",
                "followers_url": "https://api.github.com/users/ThiefMaster/followers",
                "following_url": "https://api.github.com/users/ThiefMaster/following{/other_user}",
                "gists_url": "https://api.github.com/users/ThiefMaster/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ThiefMaster/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ThiefMaster/subscriptions",
                "organizations_url": "https://api.github.com/users/ThiefMaster/orgs",
                "repos_url": "https://api.github.com/users/ThiefMaster/repos",
                "events_url": "https://api.github.com/users/ThiefMaster/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ThiefMaster/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-03-19T21:19:19Z",
            "updated_at": "2014-03-19T21:19:19Z",
            "author_association": "MEMBER",
            "body": "Why would you want any other encoding for text?\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/38109264",
            "html_url": "https://github.com/pallets/flask/issues/1005#issuecomment-38109264",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1005",
            "id": 38109264,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM4MTA5MjY0",
            "user": {
                "login": "barosl",
                "id": 573768,
                "node_id": "MDQ6VXNlcjU3Mzc2OA==",
                "avatar_url": "https://avatars3.githubusercontent.com/u/573768?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/barosl",
                "html_url": "https://github.com/barosl",
                "followers_url": "https://api.github.com/users/barosl/followers",
                "following_url": "https://api.github.com/users/barosl/following{/other_user}",
                "gists_url": "https://api.github.com/users/barosl/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/barosl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/barosl/subscriptions",
                "organizations_url": "https://api.github.com/users/barosl/orgs",
                "repos_url": "https://api.github.com/users/barosl/repos",
                "events_url": "https://api.github.com/users/barosl/events{/privacy}",
                "received_events_url": "https://api.github.com/users/barosl/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-03-19T21:29:02Z",
            "updated_at": "2014-03-19T21:30:20Z",
            "author_association": "NONE",
            "body": "@ThiefMaster My original intention was _not_ emitting the charset header at all, cause we have many legacy documents written in the encoding other than UTF-8. So until we convert them to the unified format, I was to let the client choose the encoding by itself.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/38109560",
            "html_url": "https://github.com/pallets/flask/issues/1005#issuecomment-38109560",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1005",
            "id": 38109560,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM4MTA5NTYw",
            "user": {
                "login": "ThiefMaster",
                "id": 179599,
                "node_id": "MDQ6VXNlcjE3OTU5OQ==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/179599?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ThiefMaster",
                "html_url": "https://github.com/ThiefMaster",
                "followers_url": "https://api.github.com/users/ThiefMaster/followers",
                "following_url": "https://api.github.com/users/ThiefMaster/following{/other_user}",
                "gists_url": "https://api.github.com/users/ThiefMaster/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ThiefMaster/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ThiefMaster/subscriptions",
                "organizations_url": "https://api.github.com/users/ThiefMaster/orgs",
                "repos_url": "https://api.github.com/users/ThiefMaster/repos",
                "events_url": "https://api.github.com/users/ThiefMaster/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ThiefMaster/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-03-19T21:31:34Z",
            "updated_at": "2014-03-19T21:31:34Z",
            "author_association": "MEMBER",
            "body": "I think converting them is a better idea. Letting the client choose the charset is a bad idea - chances are good it'll get it wrong and show it as gibberish. I guess all of your documents have the same charset? If yes it shouldn't be too hard to convert them!\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/38110445",
            "html_url": "https://github.com/pallets/flask/issues/1005#issuecomment-38110445",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1005",
            "id": 38110445,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM4MTEwNDQ1",
            "user": {
                "login": "barosl",
                "id": 573768,
                "node_id": "MDQ6VXNlcjU3Mzc2OA==",
                "avatar_url": "https://avatars3.githubusercontent.com/u/573768?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/barosl",
                "html_url": "https://github.com/barosl",
                "followers_url": "https://api.github.com/users/barosl/followers",
                "following_url": "https://api.github.com/users/barosl/following{/other_user}",
                "gists_url": "https://api.github.com/users/barosl/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/barosl/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/barosl/subscriptions",
                "organizations_url": "https://api.github.com/users/barosl/orgs",
                "repos_url": "https://api.github.com/users/barosl/repos",
                "events_url": "https://api.github.com/users/barosl/events{/privacy}",
                "received_events_url": "https://api.github.com/users/barosl/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-03-19T21:40:14Z",
            "updated_at": "2014-03-19T21:40:14Z",
            "author_association": "NONE",
            "body": "@ThiefMaster Currently at least the two encodings(cp949, cp932) are used, which are so similar that I cannot make an automated converter, because the text in one encoding does not cause UnicodeDecodeError when decoded by the other encoding... The only way to determine the encoding is using `chardet`, which is not a 100% solution.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/50972286",
            "html_url": "https://github.com/pallets/flask/issues/1005#issuecomment-50972286",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1005",
            "id": 50972286,
            "node_id": "MDEyOklzc3VlQ29tbWVudDUwOTcyMjg2",
            "user": {
                "login": "remram44",
                "id": 426784,
                "node_id": "MDQ6VXNlcjQyNjc4NA==",
                "avatar_url": "https://avatars3.githubusercontent.com/u/426784?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/remram44",
                "html_url": "https://github.com/remram44",
                "followers_url": "https://api.github.com/users/remram44/followers",
                "following_url": "https://api.github.com/users/remram44/following{/other_user}",
                "gists_url": "https://api.github.com/users/remram44/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/remram44/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/remram44/subscriptions",
                "organizations_url": "https://api.github.com/users/remram44/orgs",
                "repos_url": "https://api.github.com/users/remram44/repos",
                "events_url": "https://api.github.com/users/remram44/events{/privacy}",
                "received_events_url": "https://api.github.com/users/remram44/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2014-08-02T19:41:23Z",
            "updated_at": "2014-08-02T19:41:23Z",
            "author_association": "NONE",
            "body": "To summarize:\n- You can set or remove the charset by returning `Response(b'data', content_type='text/html; charset=whatever')` (but you have to mention the mimetype)\n- You can set the charset by subclassing Response and setting the 'charset' attribute to something else (which will be used for all text/\\* or xml mimetypes) (but `get_content_type()` won't accept None).\n\nMaybe adding a check for `self.charset is None` before calling `get_content_type(mimetype, self.charset)`? ([in werkzeug](https://github.com/mitsuhiko/werkzeug/blob/bb7555e2bdf47ff39c49c07bf9772141afb53248/werkzeug/wrappers.py#L749)) Optionally, accepting it as parameter as well.\n\n(pushed these to [override-response-charset](https://github.com/remram44/werkzeug/compare/override-response-charset))\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/292734889",
            "html_url": "https://github.com/pallets/flask/issues/1005#issuecomment-292734889",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1005",
            "id": 292734889,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI5MjczNDg4OQ==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-04-08T17:58:09Z",
            "updated_at": "2017-04-08T17:58:09Z",
            "author_association": "MEMBER",
            "body": "Going to close this in favor of the options in the previous comment."
        }
    ]
}