{
    "url": "https://api.github.com/repos/pallets/flask/issues/3029",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/3029/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/3029/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/3029/events",
    "html_url": "https://github.com/pallets/flask/issues/3029",
    "id": 390946034,
    "node_id": "MDU6SXNzdWUzOTA5NDYwMzQ=",
    "number": 3029,
    "title": "Execution time not stable",
    "user": {
        "login": "taosean",
        "id": 17960909,
        "node_id": "MDQ6VXNlcjE3OTYwOTA5",
        "avatar_url": "https://avatars2.githubusercontent.com/u/17960909?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/taosean",
        "html_url": "https://github.com/taosean",
        "followers_url": "https://api.github.com/users/taosean/followers",
        "following_url": "https://api.github.com/users/taosean/following{/other_user}",
        "gists_url": "https://api.github.com/users/taosean/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/taosean/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/taosean/subscriptions",
        "organizations_url": "https://api.github.com/users/taosean/orgs",
        "repos_url": "https://api.github.com/users/taosean/repos",
        "events_url": "https://api.github.com/users/taosean/events{/privacy}",
        "received_events_url": "https://api.github.com/users/taosean/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 2,
    "created_at": "2018-12-14T02:58:09Z",
    "updated_at": "2018-12-14T06:43:29Z",
    "closed_at": "2018-12-14T04:11:13Z",
    "author_association": "NONE",
    "body": "Hi guys, I used Flask as a server for my image object detection program, but I found that the execution time of object detection are not stable some times.\r\n\r\nThe main goal of my program is doing object detection on an image with neural network. Since it takes too much time loading the neural netwrok model every time an input image comes, I used Flask as server and the server loads the neural network model once when the server starts up. Then, when the server is running, another program, the clinet, will send a request to the server with the image directory as the parameter. When received the request, the server will read in the specified image, do object detection (executing some functions) and output the detection results in JSON format.\r\n\r\nThis process works fine most of the time and finishes within about 500ms. However, in some rare cases, the process of performing object detection took several seconds, even up to a minute . I looked into my log files and found that they halted at different functions when this case happened.\r\n\r\nI'm wondering if this has something to do with the Flask.\r\n\r\nI'm sorry for this long description and I'm grateful if someone can give any advices.\r\n\r\n---\r\n\r\n### Expected Behavior\r\n\r\n**Execution time should be around 500ms.**\r\n\r\nThe following are normal cases\r\n\r\ncase 1\r\n```\r\n2018-12-12 04:00:03,822:fpn_server.py:_clip_boxes:122:2500:11848:DEBUG:start\r\n2018-12-12 04:00:03,822:fpn_server.py:_clip_boxes:131:2500:11848:DEBUG:end\r\n```\r\n\r\ncase2\r\n```\r\n2018-12-12 17:40:36,674:fpn_server.py:calc_num:225:2500:11848:DEBUG:end\r\n2018-12-12 17:40:36,676:fpn_server.py:detect_and_save:968:2500:11848:INFO:Writing file C:\\Windows\\system32\\config\\systemprofile\\AppData\\Local\\detection_results\\cls_nums_2.pkl\r\n```\r\n\r\n### Actual Behavior\r\n\r\n**Sometimes it takes several seconds or even a minute to finish.**\r\n\r\nThe following are unusual cases.\r\n\r\ncase 1\r\n```\r\n2018-12-12 04:00:04,834:fpn_server.py:_clip_boxes:122:2500:11848:DEBUG:start\r\n2018-12-12 04:00:08,553:fpn_server.py:_clip_boxes:131:2500:11848:DEBUG:end\r\n```\r\n\r\ncase 2\r\n```\r\n2018-12-12 17:40:28,677:fpn_server.py:calc_num:225:2500:11848:DEBUG:end\r\n2018-12-12 17:40:31,210:fpn_server.py:detect_and_save:968:2500:11848:INFO:Writing file C:\\Windows\\system32\\config\\systemprofile\\AppData\\Local\\detection_results\\cls_nums_2.pkl\r\n```\r\n### Environment\r\n\r\n* Python version: 2.7.14\r\n* Flask version: 0.12.2\r\n* Werkzeug version: 0.14.1\r\n\r\nPS: \r\n1. The server can receive the request from client quickly, it was the execution after receving request halts sometimes.\r\n2. I was runing `app.run()` to launch the server since the server and client runs on the same machine.\r\n3. Server runs in single thread is not a problem for me, I just need to process the image one at a time.\r\n4. I'm running on Windows 10.\r\n\r\nThank you!\r\n\r\n \r\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/447207405",
            "html_url": "https://github.com/pallets/flask/issues/3029#issuecomment-447207405",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3029",
            "id": 447207405,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NzIwNzQwNQ==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-12-14T04:11:13Z",
            "updated_at": "2018-12-14T04:11:13Z",
            "author_association": "MEMBER",
            "body": "We cannot help you profile the performance of a complex application like the one you've described. If you feel this is an issue with Flask, please open an issue demonstrating that with a minimal example that does not require a neural network. Also note that the dev server makes no guarantees about stability or performance.\r\n\r\nPlease use Stack Overflow for questions about your own code. This tracker is for issues related to the project itself. Be sure to include a [minimal, complete, and verifiable example](https://stackoverflow.com/help/mcve)."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/447231304",
            "html_url": "https://github.com/pallets/flask/issues/3029#issuecomment-447231304",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3029",
            "id": 447231304,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NzIzMTMwNA==",
            "user": {
                "login": "taosean",
                "id": 17960909,
                "node_id": "MDQ6VXNlcjE3OTYwOTA5",
                "avatar_url": "https://avatars2.githubusercontent.com/u/17960909?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/taosean",
                "html_url": "https://github.com/taosean",
                "followers_url": "https://api.github.com/users/taosean/followers",
                "following_url": "https://api.github.com/users/taosean/following{/other_user}",
                "gists_url": "https://api.github.com/users/taosean/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/taosean/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/taosean/subscriptions",
                "organizations_url": "https://api.github.com/users/taosean/orgs",
                "repos_url": "https://api.github.com/users/taosean/repos",
                "events_url": "https://api.github.com/users/taosean/events{/privacy}",
                "received_events_url": "https://api.github.com/users/taosean/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-12-14T06:43:29Z",
            "updated_at": "2018-12-14T06:43:29Z",
            "author_association": "NONE",
            "body": "@davidism Thank you for your response. I know this is hard to profile. So, currently what I want to know is that is it possible this is caused by `app.run()`? If it's possible, I'm thinking to use production server instead of dev server."
        }
    ]
}