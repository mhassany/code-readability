{
    "url": "https://api.github.com/repos/pallets/flask/issues/3400",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/3400/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/3400/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/3400/events",
    "html_url": "https://github.com/pallets/flask/issues/3400",
    "id": 509093771,
    "node_id": "MDU6SXNzdWU1MDkwOTM3NzE=",
    "number": 3400,
    "title": "How to define a custom command (CLI) with an application factory",
    "user": {
        "login": "gandroz",
        "id": 38106881,
        "node_id": "MDQ6VXNlcjM4MTA2ODgx",
        "avatar_url": "https://avatars2.githubusercontent.com/u/38106881?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/gandroz",
        "html_url": "https://github.com/gandroz",
        "followers_url": "https://api.github.com/users/gandroz/followers",
        "following_url": "https://api.github.com/users/gandroz/following{/other_user}",
        "gists_url": "https://api.github.com/users/gandroz/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/gandroz/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/gandroz/subscriptions",
        "organizations_url": "https://api.github.com/users/gandroz/orgs",
        "repos_url": "https://api.github.com/users/gandroz/repos",
        "events_url": "https://api.github.com/users/gandroz/events{/privacy}",
        "received_events_url": "https://api.github.com/users/gandroz/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 1,
    "created_at": "2019-10-18T13:49:43Z",
    "updated_at": "2019-10-18T14:01:21Z",
    "closed_at": "2019-10-18T14:00:57Z",
    "author_association": "NONE",
    "body": "<!-- **This issue tracker is a tool to address bugs in Flask itself.\r\nPlease use the #pocoo IRC channel on freenode or Stack Overflow for general\r\nquestions about using Flask or issues not related to Flask.** -->\r\n\r\n<!-- If you'd like to report a bug in Flask, fill out the template below. Provide\r\nany extra information that may be useful / related to your problem.\r\nIdeally, create an [MCVE](https://stackoverflow.com/help/mcve), which helps us\r\nunderstand the problem and helps check that it is not caused by something in\r\nyour code. -->\r\n\r\nI can't figure out how to define a custom command with an application factory.\r\n\r\n`app/__init__.py`:\r\n\r\n```\r\nimport click\r\nfrom flask import Flask\r\nfrom flask.cli import with_appcontext\r\nfrom config import config\r\n\r\n\r\ndef create_app():\r\n    app = Flask(__name__)\r\n    app.config.from_object(config)\r\n    app.cli.add_command(seed)\r\n\r\n    with app.app_context():\r\n        from flask_bootstrap import Bootstrap\r\n        from flask_sqlalchemy import SQLAlchemy\r\n        from flask_migrate import Migrate\r\n        from app.models import db\r\n        from app.main import main_blueprint\r\n        from app.api_1_0 import api_blueprint\r\n\r\n        bootstrap = Bootstrap()\r\n        migrate = Migrate()\r\n\r\n        bootstrap.init_app(app)\r\n        db.init_app(app)\r\n        migrate.init_app(app, db)\r\n\r\n        # Register Blueprints\r\n        app.register_blueprint(main_blueprint)\r\n        app.register_blueprint(api_blueprint, url_prefix='/api/v1.0')        \r\n\r\n        return app\r\n\r\n\r\n@click.command()\r\ndef seed():\r\n    from app.seed import seed\r\n    seed()\r\n```\r\n\r\nWhen I run `flask seed` I got the error `No such command \"seed\"`. I used to use flask script but I would like to \"migrate\" to the CLI. Is that even possible without installing the app in dev mode like in #3289 ?\r\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/543761118",
            "html_url": "https://github.com/pallets/flask/issues/3400#issuecomment-543761118",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3400",
            "id": 543761118,
            "node_id": "MDEyOklzc3VlQ29tbWVudDU0Mzc2MTExOA==",
            "user": {
                "login": "gandroz",
                "id": 38106881,
                "node_id": "MDQ6VXNlcjM4MTA2ODgx",
                "avatar_url": "https://avatars2.githubusercontent.com/u/38106881?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/gandroz",
                "html_url": "https://github.com/gandroz",
                "followers_url": "https://api.github.com/users/gandroz/followers",
                "following_url": "https://api.github.com/users/gandroz/following{/other_user}",
                "gists_url": "https://api.github.com/users/gandroz/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/gandroz/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/gandroz/subscriptions",
                "organizations_url": "https://api.github.com/users/gandroz/orgs",
                "repos_url": "https://api.github.com/users/gandroz/repos",
                "events_url": "https://api.github.com/users/gandroz/events{/privacy}",
                "received_events_url": "https://api.github.com/users/gandroz/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-10-18T14:01:21Z",
            "updated_at": "2019-10-18T14:01:21Z",
            "author_association": "NONE",
            "body": "my bad, I was not in the right virtualenv :( "
        }
    ]
}