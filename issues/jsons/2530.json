{
    "url": "https://api.github.com/repos/pallets/flask/issues/2530",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/2530/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/2530/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/2530/events",
    "html_url": "https://github.com/pallets/flask/pull/2530",
    "id": 276708846,
    "node_id": "MDExOlB1bGxSZXF1ZXN0MTU0NjE0NDYz",
    "number": 2530,
    "title": "Improved bad factory error handling",
    "user": {
        "login": "mitsuhiko",
        "id": 7396,
        "node_id": "MDQ6VXNlcjczOTY=",
        "avatar_url": "https://avatars1.githubusercontent.com/u/7396?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/mitsuhiko",
        "html_url": "https://github.com/mitsuhiko",
        "followers_url": "https://api.github.com/users/mitsuhiko/followers",
        "following_url": "https://api.github.com/users/mitsuhiko/following{/other_user}",
        "gists_url": "https://api.github.com/users/mitsuhiko/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/mitsuhiko/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/mitsuhiko/subscriptions",
        "organizations_url": "https://api.github.com/users/mitsuhiko/orgs",
        "repos_url": "https://api.github.com/users/mitsuhiko/repos",
        "events_url": "https://api.github.com/users/mitsuhiko/events{/privacy}",
        "received_events_url": "https://api.github.com/users/mitsuhiko/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 380608249,
            "node_id": "MDU6TGFiZWwzODA2MDgyNDk=",
            "url": "https://api.github.com/repos/pallets/flask/labels/cli",
            "name": "cli",
            "color": "1d76db",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": {
        "login": "davidism",
        "id": 1242887,
        "node_id": "MDQ6VXNlcjEyNDI4ODc=",
        "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/davidism",
        "html_url": "https://github.com/davidism",
        "followers_url": "https://api.github.com/users/davidism/followers",
        "following_url": "https://api.github.com/users/davidism/following{/other_user}",
        "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
        "organizations_url": "https://api.github.com/users/davidism/orgs",
        "repos_url": "https://api.github.com/users/davidism/repos",
        "events_url": "https://api.github.com/users/davidism/events{/privacy}",
        "received_events_url": "https://api.github.com/users/davidism/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "davidism",
            "id": 1242887,
            "node_id": "MDQ6VXNlcjEyNDI4ODc=",
            "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/davidism",
            "html_url": "https://github.com/davidism",
            "followers_url": "https://api.github.com/users/davidism/followers",
            "following_url": "https://api.github.com/users/davidism/following{/other_user}",
            "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
            "organizations_url": "https://api.github.com/users/davidism/orgs",
            "repos_url": "https://api.github.com/users/davidism/repos",
            "events_url": "https://api.github.com/users/davidism/events{/privacy}",
            "received_events_url": "https://api.github.com/users/davidism/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": {
        "url": "https://api.github.com/repos/pallets/flask/milestones/2",
        "html_url": "https://github.com/pallets/flask/milestone/2",
        "labels_url": "https://api.github.com/repos/pallets/flask/milestones/2/labels",
        "id": 795954,
        "node_id": "MDk6TWlsZXN0b25lNzk1OTU0",
        "number": 2,
        "title": "1.0",
        "description": "",
        "creator": {
            "login": "untitaker",
            "id": 837573,
            "node_id": "MDQ6VXNlcjgzNzU3Mw==",
            "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/untitaker",
            "html_url": "https://github.com/untitaker",
            "followers_url": "https://api.github.com/users/untitaker/followers",
            "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
            "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
            "organizations_url": "https://api.github.com/users/untitaker/orgs",
            "repos_url": "https://api.github.com/users/untitaker/repos",
            "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
            "received_events_url": "https://api.github.com/users/untitaker/received_events",
            "type": "User",
            "site_admin": false
        },
        "open_issues": 0,
        "closed_issues": 159,
        "state": "closed",
        "created_at": "2014-09-19T15:47:20Z",
        "updated_at": "2018-04-26T21:07:44Z",
        "due_on": "2018-04-26T07:00:00Z",
        "closed_at": "2018-04-26T21:07:44Z"
    },
    "comments": 9,
    "created_at": "2017-11-24T23:06:26Z",
    "updated_at": "2018-10-23T17:44:19Z",
    "closed_at": "2018-01-28T19:27:07Z",
    "author_association": "MEMBER",
    "pull_request": {
        "url": "https://api.github.com/repos/pallets/flask/pulls/2530",
        "html_url": "https://github.com/pallets/flask/pull/2530",
        "diff_url": "https://github.com/pallets/flask/pull/2530.diff",
        "patch_url": "https://github.com/pallets/flask/pull/2530.patch"
    },
    "body": "This does some bad string parsing to not accidentally silence other errors\n(Probably not ideal but that's the best I can come up with)",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/346906447",
            "html_url": "https://github.com/pallets/flask/pull/2530#issuecomment-346906447",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2530",
            "id": 346906447,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM0NjkwNjQ0Nw==",
            "user": {
                "login": "mitsuhiko",
                "id": 7396,
                "node_id": "MDQ6VXNlcjczOTY=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/7396?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/mitsuhiko",
                "html_url": "https://github.com/mitsuhiko",
                "followers_url": "https://api.github.com/users/mitsuhiko/followers",
                "following_url": "https://api.github.com/users/mitsuhiko/following{/other_user}",
                "gists_url": "https://api.github.com/users/mitsuhiko/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/mitsuhiko/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mitsuhiko/subscriptions",
                "organizations_url": "https://api.github.com/users/mitsuhiko/orgs",
                "repos_url": "https://api.github.com/users/mitsuhiko/repos",
                "events_url": "https://api.github.com/users/mitsuhiko/events{/privacy}",
                "received_events_url": "https://api.github.com/users/mitsuhiko/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-11-24T23:36:15Z",
            "updated_at": "2017-11-24T23:36:15Z",
            "author_association": "MEMBER",
            "body": "I tried to do that now but that's quite ugly for other reasons. I'm not super happy with this code right now but it's not like i have good proposals for how to fix this.\r\n\r\nI leave it as such for now, maybe someone wants to look at if there are nicer ways to do it? Otherwise i will get back to it next week."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/360493956",
            "html_url": "https://github.com/pallets/flask/pull/2530#issuecomment-360493956",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2530",
            "id": 360493956,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM2MDQ5Mzk1Ng==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-01-25T15:08:40Z",
            "updated_at": "2018-01-25T15:08:40Z",
            "author_association": "MEMBER",
            "body": "Debating checking the traceback after calling versus using `signature.bind` to check the arguments before calling."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/360499173",
            "html_url": "https://github.com/pallets/flask/pull/2530#issuecomment-360499173",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2530",
            "id": 360499173,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM2MDQ5OTE3Mw==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-01-25T15:24:40Z",
            "updated_at": "2018-01-25T15:24:40Z",
            "author_association": "MEMBER",
            "body": "`signature` wasn't added until 3.3, and `getcallargs` wasn't added until 2.7. We no longer support 2.6, but I still don't want anything to fail due to that just for the next release. So I'll stick with examining the traceback. Using `getcallargs` would require some extra restructuring anyway."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/360500116",
            "html_url": "https://github.com/pallets/flask/pull/2530#issuecomment-360500116",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2530",
            "id": 360500116,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM2MDUwMDExNg==",
            "user": {
                "login": "ThiefMaster",
                "id": 179599,
                "node_id": "MDQ6VXNlcjE3OTU5OQ==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/179599?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ThiefMaster",
                "html_url": "https://github.com/ThiefMaster",
                "followers_url": "https://api.github.com/users/ThiefMaster/followers",
                "following_url": "https://api.github.com/users/ThiefMaster/following{/other_user}",
                "gists_url": "https://api.github.com/users/ThiefMaster/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ThiefMaster/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ThiefMaster/subscriptions",
                "organizations_url": "https://api.github.com/users/ThiefMaster/orgs",
                "repos_url": "https://api.github.com/users/ThiefMaster/repos",
                "events_url": "https://api.github.com/users/ThiefMaster/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ThiefMaster/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-01-25T15:27:29Z",
            "updated_at": "2018-01-25T15:27:29Z",
            "author_association": "MEMBER",
            "body": "Is it so bad if it fails hard on obsolete Python versions in case there is *already an error*? This is development-time code that only runs in case of an error. No big deal IMO if that blows up on an officially unsupported version."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/360561383",
            "html_url": "https://github.com/pallets/flask/pull/2530#issuecomment-360561383",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2530",
            "id": 360561383,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM2MDU2MTM4Mw==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-01-25T18:46:36Z",
            "updated_at": "2018-01-25T18:46:47Z",
            "author_association": "MEMBER",
            "body": "We handle nested import errors by inspecting the traceback, using the traceback here would at least be consistent."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/360929498",
            "html_url": "https://github.com/pallets/flask/pull/2530#issuecomment-360929498",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2530",
            "id": 360929498,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM2MDkyOTQ5OA==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-01-26T23:05:29Z",
            "updated_at": "2018-01-26T23:05:55Z",
            "author_association": "MEMBER",
            "body": "Current solution that works with most cases I could think of:\r\n\r\n```python\r\n\r\n\r\ndef _called_with_wrong_args(factory, exc_info):\r\n    exc_type, exc_value, tb = exc_info\r\n    while tb is not None:\r\n        if tb.tb_frame.f_code is factory.__code__:\r\n            return False\r\n        tb = tb.tb_next\r\n    return True\r\n```\r\n\r\nTrying to make this (admittedly unlikely) case work:\r\n\r\n```python\r\ndef no_wraps(f):\r\n    def decorated(*args):\r\n        return f(*args)\r\n    return decorated\r\n\r\n@no_wraps\r\ndef create_app(x, y):\r\n    return Flask(__name__)\r\n```"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/361067155",
            "html_url": "https://github.com/pallets/flask/pull/2530#issuecomment-361067155",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2530",
            "id": 361067155,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM2MTA2NzE1NQ==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-01-28T14:29:59Z",
            "updated_at": "2018-01-28T14:31:05Z",
            "author_association": "MEMBER",
            "body": "[A user from SO Python chat](https://chat.stackoverflow.com/transcript/message/40990708#40990708) put in *way* too much time to write a version that handles a bunch of weird cases. I don't plan to get this complicated, but good for a reference anyway: https://gist.github.com/Rawing/3f2731b79eb48d1dbfa5fed7e3b639de"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/361080450",
            "html_url": "https://github.com/pallets/flask/pull/2530#issuecomment-361080450",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2530",
            "id": 361080450,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM2MTA4MDQ1MA==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-01-28T17:36:35Z",
            "updated_at": "2018-01-28T17:36:35Z",
            "author_association": "MEMBER",
            "body": "There's no way around that bad  decorator case because `*args` means the \"factory\" was called with correct args, even though the real function wasn't. On Python 3, we can at least use `inspect.unwrap`  to handle well behaved decorators that use `wraps` or `update_wrapper`."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/361085630",
            "html_url": "https://github.com/pallets/flask/pull/2530#issuecomment-361085630",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2530",
            "id": 361085630,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM2MTA4NTYzMA==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-01-28T18:47:00Z",
            "updated_at": "2018-01-28T18:48:46Z",
            "author_association": "MEMBER",
            "body": "Although, maybe the decorated function *was* called with the correct args, and passed them to the wrapped function incorrectly. In that case, we want the traceback. Who's to say whether the decorator or original args are more correct? I could check the signature and see if it accepts just `*args` and kwargs with defaults.\r\n\r\nI'm just going to ignore decorators, it gets too complicated."
        }
    ]
}