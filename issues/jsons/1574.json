{
    "url": "https://api.github.com/repos/pallets/flask/issues/1574",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/1574/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/1574/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/1574/events",
    "html_url": "https://github.com/pallets/flask/issues/1574",
    "id": 108685230,
    "node_id": "MDU6SXNzdWUxMDg2ODUyMzA=",
    "number": 1574,
    "title": "support for rotating secret keys? ",
    "user": {
        "login": "coreybrett",
        "id": 4440265,
        "node_id": "MDQ6VXNlcjQ0NDAyNjU=",
        "avatar_url": "https://avatars3.githubusercontent.com/u/4440265?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/coreybrett",
        "html_url": "https://github.com/coreybrett",
        "followers_url": "https://api.github.com/users/coreybrett/followers",
        "following_url": "https://api.github.com/users/coreybrett/following{/other_user}",
        "gists_url": "https://api.github.com/users/coreybrett/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/coreybrett/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/coreybrett/subscriptions",
        "organizations_url": "https://api.github.com/users/coreybrett/orgs",
        "repos_url": "https://api.github.com/users/coreybrett/repos",
        "events_url": "https://api.github.com/users/coreybrett/events{/privacy}",
        "received_events_url": "https://api.github.com/users/coreybrett/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": {
        "login": "lepture",
        "id": 290496,
        "node_id": "MDQ6VXNlcjI5MDQ5Ng==",
        "avatar_url": "https://avatars2.githubusercontent.com/u/290496?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/lepture",
        "html_url": "https://github.com/lepture",
        "followers_url": "https://api.github.com/users/lepture/followers",
        "following_url": "https://api.github.com/users/lepture/following{/other_user}",
        "gists_url": "https://api.github.com/users/lepture/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/lepture/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/lepture/subscriptions",
        "organizations_url": "https://api.github.com/users/lepture/orgs",
        "repos_url": "https://api.github.com/users/lepture/repos",
        "events_url": "https://api.github.com/users/lepture/events{/privacy}",
        "received_events_url": "https://api.github.com/users/lepture/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "lepture",
            "id": 290496,
            "node_id": "MDQ6VXNlcjI5MDQ5Ng==",
            "avatar_url": "https://avatars2.githubusercontent.com/u/290496?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/lepture",
            "html_url": "https://github.com/lepture",
            "followers_url": "https://api.github.com/users/lepture/followers",
            "following_url": "https://api.github.com/users/lepture/following{/other_user}",
            "gists_url": "https://api.github.com/users/lepture/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/lepture/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/lepture/subscriptions",
            "organizations_url": "https://api.github.com/users/lepture/orgs",
            "repos_url": "https://api.github.com/users/lepture/repos",
            "events_url": "https://api.github.com/users/lepture/events{/privacy}",
            "received_events_url": "https://api.github.com/users/lepture/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 5,
    "created_at": "2015-09-28T15:37:28Z",
    "updated_at": "2019-09-24T00:10:49Z",
    "closed_at": "2015-11-01T00:53:57Z",
    "author_association": "NONE",
    "body": "Is there any support for rotating secret keys in Flask?\n\nI would like to use http://securekey.heroku.com/ as a source.\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/143781767",
            "html_url": "https://github.com/pallets/flask/issues/1574#issuecomment-143781767",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1574",
            "id": 143781767,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE0Mzc4MTc2Nw==",
            "user": {
                "login": "ThiefMaster",
                "id": 179599,
                "node_id": "MDQ6VXNlcjE3OTU5OQ==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/179599?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ThiefMaster",
                "html_url": "https://github.com/ThiefMaster",
                "followers_url": "https://api.github.com/users/ThiefMaster/followers",
                "following_url": "https://api.github.com/users/ThiefMaster/following{/other_user}",
                "gists_url": "https://api.github.com/users/ThiefMaster/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ThiefMaster/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ThiefMaster/subscriptions",
                "organizations_url": "https://api.github.com/users/ThiefMaster/orgs",
                "repos_url": "https://api.github.com/users/ThiefMaster/repos",
                "events_url": "https://api.github.com/users/ThiefMaster/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ThiefMaster/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-09-28T15:38:43Z",
            "updated_at": "2015-09-28T15:39:27Z",
            "author_association": "MEMBER",
            "body": "You don't want to rotate your secret key unless you are ok with invalidating all sessions (or any other itsdangerous-like signatures based on it) whenever you rotate it.\n\nSo this would require some changes to Flask and possibly itsdangerous (to support multiple secret keys)...\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/143786040",
            "html_url": "https://github.com/pallets/flask/issues/1574#issuecomment-143786040",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1574",
            "id": 143786040,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE0Mzc4NjA0MA==",
            "user": {
                "login": "coreybrett",
                "id": 4440265,
                "node_id": "MDQ6VXNlcjQ0NDAyNjU=",
                "avatar_url": "https://avatars3.githubusercontent.com/u/4440265?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/coreybrett",
                "html_url": "https://github.com/coreybrett",
                "followers_url": "https://api.github.com/users/coreybrett/followers",
                "following_url": "https://api.github.com/users/coreybrett/following{/other_user}",
                "gists_url": "https://api.github.com/users/coreybrett/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/coreybrett/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/coreybrett/subscriptions",
                "organizations_url": "https://api.github.com/users/coreybrett/orgs",
                "repos_url": "https://api.github.com/users/coreybrett/repos",
                "events_url": "https://api.github.com/users/coreybrett/events{/privacy}",
                "received_events_url": "https://api.github.com/users/coreybrett/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-09-28T15:52:12Z",
            "updated_at": "2015-09-28T15:52:12Z",
            "author_association": "NONE",
            "body": "I think the idea with http://securekey.heroku.com/ is that when the keys\nare rotated, the old key sticks around and is available until the next\nrotation.\n\nOn Mon, Sep 28, 2015 at 11:39 AM, Adrian notifications@github.com wrote:\n\n> You don't want to rotate your secret key unless you are ok with\n> invalidating all sessions (or any other itsdangerous-like signatures based\n> on it) whenever you rotate it.\n> \n> \u2014\n> Reply to this email directly or view it on GitHub\n> https://github.com/mitsuhiko/flask/issues/1574#issuecomment-143781767.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/152783974",
            "html_url": "https://github.com/pallets/flask/issues/1574#issuecomment-152783974",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1574",
            "id": 152783974,
            "node_id": "MDEyOklzc3VlQ29tbWVudDE1Mjc4Mzk3NA==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2015-11-01T00:53:57Z",
            "updated_at": "2015-11-01T00:54:47Z",
            "author_association": "MEMBER",
            "body": "I don't see how this could be worked into Flask.  The entire ecosystem assumes the secret key is a single value.  Flask only uses the secret key for the session cookie, so an extension could easily provide a different interface for choosing the old secret key if necessary to update the signature.  The problem would be getting every other third-party thing that grabs the secret key to allow for it returning more than one value.\n\nThere's also no way to choose one key at the start of the request.  Even if we can determine that the session was signed with a given key, we can't know that a token wasn't generated with a different one somewhere else, so the system would _always_ have to read the available keys and try each one and know how to update.\n\nI can't justify the added complexity over making sure your single secret key is sufficiently long and random and not disclosing it.  If you need this, it's something you'll need to implement locally.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/218906991",
            "html_url": "https://github.com/pallets/flask/issues/1574#issuecomment-218906991",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1574",
            "id": 218906991,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIxODkwNjk5MQ==",
            "user": {
                "login": "joshma",
                "id": 64739,
                "node_id": "MDQ6VXNlcjY0NzM5",
                "avatar_url": "https://avatars3.githubusercontent.com/u/64739?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/joshma",
                "html_url": "https://github.com/joshma",
                "followers_url": "https://api.github.com/users/joshma/followers",
                "following_url": "https://api.github.com/users/joshma/following{/other_user}",
                "gists_url": "https://api.github.com/users/joshma/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/joshma/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/joshma/subscriptions",
                "organizations_url": "https://api.github.com/users/joshma/orgs",
                "repos_url": "https://api.github.com/users/joshma/repos",
                "events_url": "https://api.github.com/users/joshma/events{/privacy}",
                "received_events_url": "https://api.github.com/users/joshma/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-05-12T22:44:42Z",
            "updated_at": "2016-05-12T22:44:42Z",
            "author_association": "NONE",
            "body": "Overall, secret key rotation is an industry standard, and I think it's something that is difficult to do without native Flask support. In my opinion, assuming a single key will never be disclosed can be a bad assumption to make - securekey.heroku.com is an example of this being important, and many APIs (e.g. Stripe) will allow you to rotate keys as well.\n\nI think the assumption with key rotation is that the old key is only kept around for a given period of time, and after that period it is acceptable to reject tokens generated with the old one. As far as only session encryption goes, it seems like it'd be pretty simple (in concept at least) to identify which key was used by including a fingerprint, erroring if that key is not available, and otherwise happily using that key to attempt to decrypt/verify. When rotating, the server can respond with a session signed by the new key, and the client will have transparently been switched over. The only issue here is with clients who don't connect after the rotation period is over - this is generally outside the expiration window for sessions anyways, or is at least acceptable in the scenario where a key needs to be updated.\n\nI'm only familiar with Flask as an end user, so there's likely pieces of the ecosystem that I'm very unfamiliar with, but my guess is that it's OK for those usages to break on older versions of the key.\n\n@davidism would love to hear your thoughts on this!\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/218907212",
            "html_url": "https://github.com/pallets/flask/issues/1574#issuecomment-218907212",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1574",
            "id": 218907212,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIxODkwNzIxMg==",
            "user": {
                "login": "joshma",
                "id": 64739,
                "node_id": "MDQ6VXNlcjY0NzM5",
                "avatar_url": "https://avatars3.githubusercontent.com/u/64739?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/joshma",
                "html_url": "https://github.com/joshma",
                "followers_url": "https://api.github.com/users/joshma/followers",
                "following_url": "https://api.github.com/users/joshma/following{/other_user}",
                "gists_url": "https://api.github.com/users/joshma/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/joshma/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/joshma/subscriptions",
                "organizations_url": "https://api.github.com/users/joshma/orgs",
                "repos_url": "https://api.github.com/users/joshma/repos",
                "events_url": "https://api.github.com/users/joshma/events{/privacy}",
                "received_events_url": "https://api.github.com/users/joshma/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-05-12T22:46:06Z",
            "updated_at": "2016-05-12T22:46:06Z",
            "author_association": "NONE",
            "body": "Sorry, I misspoke - I guess it's possible to implement an independent session library that supports key rotation, but it'd feel like re-inventing most of the wheel, and when it comes to security it seems better for it to receive first-class support. Maybe that's just contrary to the Flask way though.\n"
        }
    ]
}