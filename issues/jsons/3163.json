{
    "url": "https://api.github.com/repos/pallets/flask/issues/3163",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/3163/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/3163/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/3163/events",
    "html_url": "https://github.com/pallets/flask/issues/3163",
    "id": 437086788,
    "node_id": "MDU6SXNzdWU0MzcwODY3ODg=",
    "number": 3163,
    "title": "open_resource() does not allow mode='rt'",
    "user": {
        "login": "goodmami",
        "id": 1428419,
        "node_id": "MDQ6VXNlcjE0Mjg0MTk=",
        "avatar_url": "https://avatars1.githubusercontent.com/u/1428419?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/goodmami",
        "html_url": "https://github.com/goodmami",
        "followers_url": "https://api.github.com/users/goodmami/followers",
        "following_url": "https://api.github.com/users/goodmami/following{/other_user}",
        "gists_url": "https://api.github.com/users/goodmami/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/goodmami/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/goodmami/subscriptions",
        "organizations_url": "https://api.github.com/users/goodmami/orgs",
        "repos_url": "https://api.github.com/users/goodmami/repos",
        "events_url": "https://api.github.com/users/goodmami/events{/privacy}",
        "received_events_url": "https://api.github.com/users/goodmami/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": {
        "url": "https://api.github.com/repos/pallets/flask/milestones/3",
        "html_url": "https://github.com/pallets/flask/milestone/3",
        "labels_url": "https://api.github.com/repos/pallets/flask/milestones/3/labels",
        "id": 3093266,
        "node_id": "MDk6TWlsZXN0b25lMzA5MzI2Ng==",
        "number": 3,
        "title": "1.1.0",
        "description": "",
        "creator": {
            "login": "davidism",
            "id": 1242887,
            "node_id": "MDQ6VXNlcjEyNDI4ODc=",
            "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/davidism",
            "html_url": "https://github.com/davidism",
            "followers_url": "https://api.github.com/users/davidism/followers",
            "following_url": "https://api.github.com/users/davidism/following{/other_user}",
            "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
            "organizations_url": "https://api.github.com/users/davidism/orgs",
            "repos_url": "https://api.github.com/users/davidism/repos",
            "events_url": "https://api.github.com/users/davidism/events{/privacy}",
            "received_events_url": "https://api.github.com/users/davidism/received_events",
            "type": "User",
            "site_admin": false
        },
        "open_issues": 0,
        "closed_issues": 48,
        "state": "closed",
        "created_at": "2018-02-06T16:14:43Z",
        "updated_at": "2019-07-06T22:03:23Z",
        "due_on": null,
        "closed_at": "2019-07-06T22:03:23Z"
    },
    "comments": 2,
    "created_at": "2019-04-25T09:04:53Z",
    "updated_at": "2019-05-17T20:32:41Z",
    "closed_at": "2019-05-17T20:32:41Z",
    "author_association": "NONE",
    "body": "In Python 3, `mode='rt'` is synonymous with `mode='r'` but Flask disallows it thinking it is not a valid mode for reading. While this is true in Python 2, Flask could (at least) provide a more meaningful error message, if not just allow it.\r\n\r\nA simple solution might change these lines in `flask/helpers.py`:\r\n\r\n```python\r\n    def open_resource(self, resource, mode='rb'):\r\n        \"\"\"...\"\"\"  # truncated for example\r\n        if mode not in ('r', 'rb'):\r\n            raise ValueError('Resources can only be opened for reading')\r\n        return open(os.path.join(self.root_path, resource), mode)\r\n```\r\n\r\n...to...\r\n\r\n```python\r\n    def open_resource(self, resource, mode='rb'):\r\n        \"\"\"...\"\"\"\r\n        if mode == 'rt':\r\n            mode = 'r'\r\n        if mode not in ('r', 'rb'):\r\n            raise ValueError('Resources can only be opened for reading')\r\n        return open(os.path.join(self.root_path, resource), mode)\r\n```\r\n\r\nA heavier solution might use `io.open()` (and also allow `encoding`, but see #1740):\r\n\r\n```python\r\n    def open_resource(self, resource, mode='rb', encoding=None):\r\n        \"\"\"...\"\"\"\r\n        if mode not in ('r', 'rb', 'rt'):\r\n            raise ValueError('Resources can only be opened for reading')\r\n        return io.open(os.path.join(self.root_path, resource), mode=mode, encoding=encoding)\r\n```\r\n\r\n### Expected Behavior\r\n\r\nCalling `open_resource()` with `mode='rt'` should open a file in text mode (at least in Python 3).\r\n\r\n```python\r\nfrom flask import Flask\r\n\r\napp = Flask(__name__)\r\nwith app.open_resource('README.md', mode='rt') as f:\r\n    print(f.read())\r\n```\r\n\r\n### Actual Behavior\r\n\r\nA misleading exception is raised.\r\n\r\n```pytb\r\nTraceback (most recent call last):\r\n  File \"mwe.py\", line 5, in <module>\r\n    with app.open_resource('README.md', mode='rt') as f:\r\n  File \"/home/goodmami/repos/OMW/py3env/lib/python3.6/site-packages/flask/helpers.py\", line 1002, in open_resource\r\n    raise ValueError('Resources can only be opened for reading')\r\nValueError: Resources can only be opened for reading\r\n```\r\n\r\n### Environment\r\n\r\n* Python version: 3.6.7\r\n* Flask version: 1.0.2\r\n* Werkzeug version: 0.14.1\r\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/489653623",
            "html_url": "https://github.com/pallets/flask/issues/3163#issuecomment-489653623",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3163",
            "id": 489653623,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTY1MzYyMw==",
            "user": {
                "login": "seawolf42",
                "id": 2721922,
                "node_id": "MDQ6VXNlcjI3MjE5MjI=",
                "avatar_url": "https://avatars3.githubusercontent.com/u/2721922?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/seawolf42",
                "html_url": "https://github.com/seawolf42",
                "followers_url": "https://api.github.com/users/seawolf42/followers",
                "following_url": "https://api.github.com/users/seawolf42/following{/other_user}",
                "gists_url": "https://api.github.com/users/seawolf42/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/seawolf42/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/seawolf42/subscriptions",
                "organizations_url": "https://api.github.com/users/seawolf42/orgs",
                "repos_url": "https://api.github.com/users/seawolf42/repos",
                "events_url": "https://api.github.com/users/seawolf42/events{/privacy}",
                "received_events_url": "https://api.github.com/users/seawolf42/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-05-06T15:01:48Z",
            "updated_at": "2019-05-06T15:01:48Z",
            "author_association": "CONTRIBUTOR",
            "body": "Starting work on this now."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/489654532",
            "html_url": "https://github.com/pallets/flask/issues/3163#issuecomment-489654532",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3163",
            "id": 489654532,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTY1NDUzMg==",
            "user": {
                "login": "icreatedanaccount",
                "id": 22645157,
                "node_id": "MDQ6VXNlcjIyNjQ1MTU3",
                "avatar_url": "https://avatars2.githubusercontent.com/u/22645157?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/icreatedanaccount",
                "html_url": "https://github.com/icreatedanaccount",
                "followers_url": "https://api.github.com/users/icreatedanaccount/followers",
                "following_url": "https://api.github.com/users/icreatedanaccount/following{/other_user}",
                "gists_url": "https://api.github.com/users/icreatedanaccount/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/icreatedanaccount/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/icreatedanaccount/subscriptions",
                "organizations_url": "https://api.github.com/users/icreatedanaccount/orgs",
                "repos_url": "https://api.github.com/users/icreatedanaccount/repos",
                "events_url": "https://api.github.com/users/icreatedanaccount/events{/privacy}",
                "received_events_url": "https://api.github.com/users/icreatedanaccount/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-05-06T15:04:24Z",
            "updated_at": "2019-05-06T16:38:43Z",
            "author_association": "CONTRIBUTOR",
            "body": "[PR Created](https://github.com/pallets/flask/pull/3174) #3174 "
        }
    ]
}