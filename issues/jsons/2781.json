{
    "url": "https://api.github.com/repos/pallets/flask/issues/2781",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/2781/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/2781/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/2781/events",
    "html_url": "https://github.com/pallets/flask/pull/2781",
    "id": 322626080,
    "node_id": "MDExOlB1bGxSZXF1ZXN0MTg3Njg5NTY0",
    "number": 2781,
    "title": "route app.run through the cli whenever possible",
    "user": {
        "login": "miguelgrinberg",
        "id": 2715854,
        "node_id": "MDQ6VXNlcjI3MTU4NTQ=",
        "avatar_url": "https://avatars0.githubusercontent.com/u/2715854?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/miguelgrinberg",
        "html_url": "https://github.com/miguelgrinberg",
        "followers_url": "https://api.github.com/users/miguelgrinberg/followers",
        "following_url": "https://api.github.com/users/miguelgrinberg/following{/other_user}",
        "gists_url": "https://api.github.com/users/miguelgrinberg/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/miguelgrinberg/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/miguelgrinberg/subscriptions",
        "organizations_url": "https://api.github.com/users/miguelgrinberg/orgs",
        "repos_url": "https://api.github.com/users/miguelgrinberg/repos",
        "events_url": "https://api.github.com/users/miguelgrinberg/events{/privacy}",
        "received_events_url": "https://api.github.com/users/miguelgrinberg/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "open",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 3,
    "created_at": "2018-05-13T20:49:57Z",
    "updated_at": "2019-08-19T12:46:55Z",
    "closed_at": null,
    "author_association": "MEMBER",
    "pull_request": {
        "url": "https://api.github.com/repos/pallets/flask/pulls/2781",
        "html_url": "https://github.com/pallets/flask/pull/2781",
        "diff_url": "https://github.com/pallets/flask/pull/2781.diff",
        "patch_url": "https://github.com/pallets/flask/pull/2781.patch"
    },
    "body": "This change expands the venerable `app.run()` function with cli support. At this point this is a proof of concept to investigate if this can be done without breaking existing applications. Feedback appreciated!\r\n\r\nGiven an application `myapp.py`, which ends with:\r\n\r\n```python\r\nif __name__ == '__main__':\r\n    app.run()\r\n```\r\n\r\nThe following features are supported:\r\n\r\n- Running `python myapp.py` with no additional arguments is redirected to `flask run` in the cli module. The value of `FLASK_APP` is determined through introspection if not provided. If a value for `FLASK_APP` cannot be determined, then the original `app.run()` function is used.\r\n- Running `python myapp.py` with any arguments redirects to the `flask` command with the same arguments. For example: `python myapp.py --help` is the same as `flask --help`, `python myapp.py shell` starts the shell, and so on. Custom cli commands are also supported.\r\n- If the script passes `host` or `port` arguments in `app.run()`, those are also passed on to the `flask run` command in the cli module.\r\n- If the script calls `app.run(debug=True)` then `FLASK_ENV=development` is added to the environment (only if `FLASK_ENV` is not set).\r\n- If the `app.run()` call specifies any custom settings besides `host`, `port`, and `debug`, then the original logic is used for now. I can go through all the available options to `run_simple()` and see if there are other ones that can be supported through the cli.",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/434621785",
            "html_url": "https://github.com/pallets/flask/pull/2781#issuecomment-434621785",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2781",
            "id": 434621785,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQzNDYyMTc4NQ==",
            "user": {
                "login": "miguelgrinberg",
                "id": 2715854,
                "node_id": "MDQ6VXNlcjI3MTU4NTQ=",
                "avatar_url": "https://avatars0.githubusercontent.com/u/2715854?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/miguelgrinberg",
                "html_url": "https://github.com/miguelgrinberg",
                "followers_url": "https://api.github.com/users/miguelgrinberg/followers",
                "following_url": "https://api.github.com/users/miguelgrinberg/following{/other_user}",
                "gists_url": "https://api.github.com/users/miguelgrinberg/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/miguelgrinberg/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/miguelgrinberg/subscriptions",
                "organizations_url": "https://api.github.com/users/miguelgrinberg/orgs",
                "repos_url": "https://api.github.com/users/miguelgrinberg/repos",
                "events_url": "https://api.github.com/users/miguelgrinberg/events{/privacy}",
                "received_events_url": "https://api.github.com/users/miguelgrinberg/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-10-31T09:40:18Z",
            "updated_at": "2018-10-31T09:40:42Z",
            "author_association": "MEMBER",
            "body": "Guys, this change has been gathering dust since May. Anything I can do to make it more palatable and hopefully get it in?\r\n\r\nThe most important reason I want this (or something similar) in is that it brings parity between the two methods of starting a Flask app. A lot of people prefer and still use the `app.run()` method to start the app, but they are at a disadvantage because they are left out of custom CLI commands, and are also affected by the reloader bugs that originated the CLI in the first place. This change I believe addresses both concerns."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/434696935",
            "html_url": "https://github.com/pallets/flask/pull/2781#issuecomment-434696935",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2781",
            "id": 434696935,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQzNDY5NjkzNQ==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-10-31T13:58:11Z",
            "updated_at": "2018-10-31T13:58:19Z",
            "author_association": "MEMBER",
            "body": "I suppose I approve this, but I don't like how circuitous and duplicated it's becoming (that's not your fault though). I'd really like to investigate how we can actually unify the code of `Flask.run` and `run_command`. Needs docs, tests, and changelog before merge.\r\n\r\nI'm currently focused on other things (in Pallets and in general), so I won't be able to make a release for a while longer unless someone wants to handle more of the process for me (check what's been merged since the last tag, ensure changelog is up to date and links to issues/PRs, decide to merge any other PRs for a feature release, etc.)."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/522557169",
            "html_url": "https://github.com/pallets/flask/pull/2781#issuecomment-522557169",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2781",
            "id": 522557169,
            "node_id": "MDEyOklzc3VlQ29tbWVudDUyMjU1NzE2OQ==",
            "user": {
                "login": "ElPicador",
                "id": 16667,
                "node_id": "MDQ6VXNlcjE2NjY3",
                "avatar_url": "https://avatars1.githubusercontent.com/u/16667?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ElPicador",
                "html_url": "https://github.com/ElPicador",
                "followers_url": "https://api.github.com/users/ElPicador/followers",
                "following_url": "https://api.github.com/users/ElPicador/following{/other_user}",
                "gists_url": "https://api.github.com/users/ElPicador/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ElPicador/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ElPicador/subscriptions",
                "organizations_url": "https://api.github.com/users/ElPicador/orgs",
                "repos_url": "https://api.github.com/users/ElPicador/repos",
                "events_url": "https://api.github.com/users/ElPicador/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ElPicador/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-08-19T12:46:55Z",
            "updated_at": "2019-08-19T12:46:55Z",
            "author_association": "NONE",
            "body": "I know this PR is old, but I think it's useful. Do you plan to merge this one day?\r\n\r\nWe need a custom cli to run flask in dev. For now we do: \r\n\r\n```\r\nos.environ[\"FLASK_RUN_FROM_CLI\"] = \"false\"\r\napp.run(...)\r\n```\r\n\r\nIs there a better way to do this?\r\n"
        }
    ]
}