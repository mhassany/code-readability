{
    "url": "https://api.github.com/repos/pallets/flask/issues/2209",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/2209/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/2209/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/2209/events",
    "html_url": "https://github.com/pallets/flask/pull/2209",
    "id": 214707189,
    "node_id": "MDExOlB1bGxSZXF1ZXN0MTExMDY5NjU2",
    "number": 2209,
    "title": "Print a stacktrace on CLI error (closes #2208)",
    "user": {
        "login": "svenstaro",
        "id": 1664,
        "node_id": "MDQ6VXNlcjE2NjQ=",
        "avatar_url": "https://avatars0.githubusercontent.com/u/1664?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/svenstaro",
        "html_url": "https://github.com/svenstaro",
        "followers_url": "https://api.github.com/users/svenstaro/followers",
        "following_url": "https://api.github.com/users/svenstaro/following{/other_user}",
        "gists_url": "https://api.github.com/users/svenstaro/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/svenstaro/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/svenstaro/subscriptions",
        "organizations_url": "https://api.github.com/users/svenstaro/orgs",
        "repos_url": "https://api.github.com/users/svenstaro/repos",
        "events_url": "https://api.github.com/users/svenstaro/events{/privacy}",
        "received_events_url": "https://api.github.com/users/svenstaro/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 380608249,
            "node_id": "MDU6TGFiZWwzODA2MDgyNDk=",
            "url": "https://api.github.com/repos/pallets/flask/labels/cli",
            "name": "cli",
            "color": "1d76db",
            "default": false,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": {
        "url": "https://api.github.com/repos/pallets/flask/milestones/2",
        "html_url": "https://github.com/pallets/flask/milestone/2",
        "labels_url": "https://api.github.com/repos/pallets/flask/milestones/2/labels",
        "id": 795954,
        "node_id": "MDk6TWlsZXN0b25lNzk1OTU0",
        "number": 2,
        "title": "1.0",
        "description": "",
        "creator": {
            "login": "untitaker",
            "id": 837573,
            "node_id": "MDQ6VXNlcjgzNzU3Mw==",
            "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/untitaker",
            "html_url": "https://github.com/untitaker",
            "followers_url": "https://api.github.com/users/untitaker/followers",
            "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
            "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
            "organizations_url": "https://api.github.com/users/untitaker/orgs",
            "repos_url": "https://api.github.com/users/untitaker/repos",
            "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
            "received_events_url": "https://api.github.com/users/untitaker/received_events",
            "type": "User",
            "site_admin": false
        },
        "open_issues": 0,
        "closed_issues": 159,
        "state": "closed",
        "created_at": "2014-09-19T15:47:20Z",
        "updated_at": "2018-04-26T21:07:44Z",
        "due_on": "2018-04-26T07:00:00Z",
        "closed_at": "2018-04-26T21:07:44Z"
    },
    "comments": 3,
    "created_at": "2017-03-16T13:39:55Z",
    "updated_at": "2018-10-23T17:44:04Z",
    "closed_at": "2017-03-16T20:43:01Z",
    "author_association": "CONTRIBUTOR",
    "pull_request": {
        "url": "https://api.github.com/repos/pallets/flask/pulls/2209",
        "html_url": "https://github.com/pallets/flask/pull/2209",
        "diff_url": "https://github.com/pallets/flask/pull/2209.diff",
        "patch_url": "https://github.com/pallets/flask/pull/2209.patch"
    },
    "body": "I've been bitten by this a few times and I believe silently swallowing errors without any debug output is a bad thing to do. This at least prints the resulting stacktrace.",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/287173117",
            "html_url": "https://github.com/pallets/flask/pull/2209#issuecomment-287173117",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2209",
            "id": 287173117,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI4NzE3MzExNw==",
            "user": {
                "login": "svenstaro",
                "id": 1664,
                "node_id": "MDQ6VXNlcjE2NjQ=",
                "avatar_url": "https://avatars0.githubusercontent.com/u/1664?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/svenstaro",
                "html_url": "https://github.com/svenstaro",
                "followers_url": "https://api.github.com/users/svenstaro/followers",
                "following_url": "https://api.github.com/users/svenstaro/following{/other_user}",
                "gists_url": "https://api.github.com/users/svenstaro/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/svenstaro/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/svenstaro/subscriptions",
                "organizations_url": "https://api.github.com/users/svenstaro/orgs",
                "repos_url": "https://api.github.com/users/svenstaro/repos",
                "events_url": "https://api.github.com/users/svenstaro/events{/privacy}",
                "received_events_url": "https://api.github.com/users/svenstaro/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-03-16T19:56:32Z",
            "updated_at": "2017-03-16T19:56:32Z",
            "author_association": "CONTRIBUTOR",
            "body": "@davidism Done."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/287194981",
            "html_url": "https://github.com/pallets/flask/pull/2209#issuecomment-287194981",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2209",
            "id": 287194981,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI4NzE5NDk4MQ==",
            "user": {
                "login": "untitaker",
                "id": 837573,
                "node_id": "MDQ6VXNlcjgzNzU3Mw==",
                "avatar_url": "https://avatars0.githubusercontent.com/u/837573?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/untitaker",
                "html_url": "https://github.com/untitaker",
                "followers_url": "https://api.github.com/users/untitaker/followers",
                "following_url": "https://api.github.com/users/untitaker/following{/other_user}",
                "gists_url": "https://api.github.com/users/untitaker/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/untitaker/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/untitaker/subscriptions",
                "organizations_url": "https://api.github.com/users/untitaker/orgs",
                "repos_url": "https://api.github.com/users/untitaker/repos",
                "events_url": "https://api.github.com/users/untitaker/events{/privacy}",
                "received_events_url": "https://api.github.com/users/untitaker/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-03-16T21:22:18Z",
            "updated_at": "2017-03-16T21:22:18Z",
            "author_association": "MEMBER",
            "body": "This requires a changelog"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/338401084",
            "html_url": "https://github.com/pallets/flask/pull/2209#issuecomment-338401084",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2209",
            "id": 338401084,
            "node_id": "MDEyOklzc3VlQ29tbWVudDMzODQwMTA4NA==",
            "user": {
                "login": "Kamekameha",
                "id": 8525842,
                "node_id": "MDQ6VXNlcjg1MjU4NDI=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/8525842?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/Kamekameha",
                "html_url": "https://github.com/Kamekameha",
                "followers_url": "https://api.github.com/users/Kamekameha/followers",
                "following_url": "https://api.github.com/users/Kamekameha/following{/other_user}",
                "gists_url": "https://api.github.com/users/Kamekameha/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/Kamekameha/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Kamekameha/subscriptions",
                "organizations_url": "https://api.github.com/users/Kamekameha/orgs",
                "repos_url": "https://api.github.com/users/Kamekameha/repos",
                "events_url": "https://api.github.com/users/Kamekameha/events{/privacy}",
                "received_events_url": "https://api.github.com/users/Kamekameha/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-10-21T14:04:54Z",
            "updated_at": "2017-10-21T14:04:54Z",
            "author_association": "NONE",
            "body": "I know this wasn't completely introduced here but in conjunction with the commit it is trying to fix, fa6eded6f572dd4bc23b030f025156cdd1e63305, as mentioned in #2208. However, a traceback is now always printed for cases where there's no app in the first place. This is pretty much just relevant to the `--help` option on the main `flask` command, since most likely everything else requires an app to properly run.\r\n\r\nIn short, a more appropriate fix would be to special-case `NoAppException` to print no traceback at all, and keep the introduced behavior as is for every other exception.\r\n\r\nBut then we have at least two places where a `NoAppException` is raised because of another exception, of a `TypeError`:\r\n\r\nhttps://github.com/pallets/flask/blob/9291ead32e2fc8b13cef825186c968944e9ff344/flask/cli.py#L77-L85\r\n\r\nAnd:\r\n\r\nhttps://github.com/pallets/flask/blob/9291ead32e2fc8b13cef825186c968944e9ff344/flask/cli.py#L150-L156\r\n\r\nWhich could (unlikely) very well be errors on the script side rather than the call to the `call_factory` function itself, where in such cases we already get kind of misleading error messages (\"kind of\" because in the second case the handled exception message is indeed added to the new one), but moreover, such previously mentioned fix will end up swallowing these `NoAppException`s, losing whatever that could be of use from these exceptions (especially in Python 3 with exception chaining).\r\n\r\nTo handle this more correctly would be to do a stack depth check like in https://github.com/pallets/flask/blob/9291ead32e2fc8b13cef825186c968944e9ff344/flask/cli.py#L207 and re-raise appropriately so that exceptions are handled as expected, if inspecting and validating the whole function signature in `call_factory` is not feasible/desirable. This should actually be done regardless of whether `NoAppException` is special-cased or not in `list_commands` because of the mentioned reasons right above.\r\n\r\nAlternatively to special-casing `NoAppException`, revert the error stack-trace printing since it's actually unexpected and slightly intrusive getting so on a help message that didn't exactly fail, and so testing the app's custom commands goes simply by running it or by similar means, given that users must do so either way and these exceptions will definitely be raised in such scenarios. Of course, that's just my opinion on it."
        }
    ]
}