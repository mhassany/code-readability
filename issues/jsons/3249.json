{
    "url": "https://api.github.com/repos/pallets/flask/issues/3249",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/3249/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/3249/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/3249/events",
    "html_url": "https://github.com/pallets/flask/issues/3249",
    "id": 451554797,
    "node_id": "MDU6SXNzdWU0NTE1NTQ3OTc=",
    "number": 3249,
    "title": "BadRequestKeyError no longer contains the missing key from self.form as of 1.0.3",
    "user": {
        "login": "Roguelazer",
        "id": 263424,
        "node_id": "MDQ6VXNlcjI2MzQyNA==",
        "avatar_url": "https://avatars3.githubusercontent.com/u/263424?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/Roguelazer",
        "html_url": "https://github.com/Roguelazer",
        "followers_url": "https://api.github.com/users/Roguelazer/followers",
        "following_url": "https://api.github.com/users/Roguelazer/following{/other_user}",
        "gists_url": "https://api.github.com/users/Roguelazer/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/Roguelazer/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/Roguelazer/subscriptions",
        "organizations_url": "https://api.github.com/users/Roguelazer/orgs",
        "repos_url": "https://api.github.com/users/Roguelazer/repos",
        "events_url": "https://api.github.com/users/Roguelazer/events{/privacy}",
        "received_events_url": "https://api.github.com/users/Roguelazer/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": {
        "url": "https://api.github.com/repos/pallets/flask/milestones/8",
        "html_url": "https://github.com/pallets/flask/milestone/8",
        "labels_url": "https://api.github.com/repos/pallets/flask/milestones/8/labels",
        "id": 4325528,
        "node_id": "MDk6TWlsZXN0b25lNDMyNTUyOA==",
        "number": 8,
        "title": "1.0.4",
        "description": "",
        "creator": {
            "login": "davidism",
            "id": 1242887,
            "node_id": "MDQ6VXNlcjEyNDI4ODc=",
            "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/davidism",
            "html_url": "https://github.com/davidism",
            "followers_url": "https://api.github.com/users/davidism/followers",
            "following_url": "https://api.github.com/users/davidism/following{/other_user}",
            "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
            "organizations_url": "https://api.github.com/users/davidism/orgs",
            "repos_url": "https://api.github.com/users/davidism/repos",
            "events_url": "https://api.github.com/users/davidism/events{/privacy}",
            "received_events_url": "https://api.github.com/users/davidism/received_events",
            "type": "User",
            "site_admin": false
        },
        "open_issues": 0,
        "closed_issues": 5,
        "state": "closed",
        "created_at": "2019-05-17T17:43:53Z",
        "updated_at": "2019-07-06T22:03:19Z",
        "due_on": null,
        "closed_at": "2019-07-06T22:03:19Z"
    },
    "comments": 7,
    "created_at": "2019-06-03T15:41:36Z",
    "updated_at": "2019-06-26T21:43:44Z",
    "closed_at": "2019-06-26T21:43:44Z",
    "author_association": "NONE",
    "body": "### Expected Behavior\r\n\r\nWhen `self.form` is indexed with a key that isn't present, `BadRequestKeyError` is raised. Under 1.0.2 and below, the `.args` property of this exception contained the actual missing key -- great for lightweight error presentation.\r\n\r\nMinimal demonstration:\r\n\r\n```python\r\nfrom flask import Flask, jsonify, request\r\nfrom werkzeug.exceptions import BadRequestKeyError\r\n\r\napp = Flask('test')\r\n\r\n@app.errorhandler(BadRequestKeyError)\r\ndef bad_key(e):\r\n    return jsonify({'missing key(s)': e.args})\r\n\r\n\r\n@app.route('/')\r\ndef root():\r\n    return request.form['foo']\r\n\r\napp.run()\r\n```\r\n\r\nUnder 1.0.2 and below we see the following behavior:\r\n\r\n```\r\n % curl localhost:5000\r\n{\"missing key(s)\":[\"foo\"]}\r\n```\r\n\r\nUnder 1.0.3:\r\n\r\n```\r\n% curl localhost:5000\r\n{\"missing key(s)\":[]}\r\n```\r\n\r\nThis occurs independent of `$FLASK_DEBUG`\r\n\r\n### Actual Behavior\r\n\r\nThere appears to be no way to get at the missing key from an error handler.\r\n\r\n### Environment\r\n\r\n* Python version: 3.6.6\r\n* Flask version: 1.0.3\r\n* Werkzeug version: 0.15.4\r\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/498345627",
            "html_url": "https://github.com/pallets/flask/issues/3249#issuecomment-498345627",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3249",
            "id": 498345627,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ5ODM0NTYyNw==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-06-03T17:13:48Z",
            "updated_at": "2019-06-03T17:13:48Z",
            "author_association": "MEMBER",
            "body": "I can't reproduce the issue when in debug mode, `e.args[0]` is the key. Out of debug mode, this now fails because we clear the args, since in Werkzeug 0.15 that's what triggers hiding the key, and I didn't think it was good to show the keys and non-standard error messages outside debug mode.\r\n\r\nThen again, this \"only show the key in debug mode\" is a completely made up thing I decided when adding the key to the output, it wasn't ever shown before Flask 1.0. I can just have it show all the time and never remove it?"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/498347684",
            "html_url": "https://github.com/pallets/flask/issues/3249#issuecomment-498347684",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3249",
            "id": 498347684,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ5ODM0NzY4NA==",
            "user": {
                "login": "Roguelazer",
                "id": 263424,
                "node_id": "MDQ6VXNlcjI2MzQyNA==",
                "avatar_url": "https://avatars3.githubusercontent.com/u/263424?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/Roguelazer",
                "html_url": "https://github.com/Roguelazer",
                "followers_url": "https://api.github.com/users/Roguelazer/followers",
                "following_url": "https://api.github.com/users/Roguelazer/following{/other_user}",
                "gists_url": "https://api.github.com/users/Roguelazer/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/Roguelazer/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Roguelazer/subscriptions",
                "organizations_url": "https://api.github.com/users/Roguelazer/orgs",
                "repos_url": "https://api.github.com/users/Roguelazer/repos",
                "events_url": "https://api.github.com/users/Roguelazer/events{/privacy}",
                "received_events_url": "https://api.github.com/users/Roguelazer/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-06-03T17:19:24Z",
            "updated_at": "2019-06-03T17:19:24Z",
            "author_association": "NONE",
            "body": "I don't understand why behavior in a custom errorhandler should ever depend on debug mode...? I agree it's reasonable to hide the keys in the default error response in non-debug mode, but if I'm doing my own error handling (and, say, logging details about the missing key), I should have access to the full args.\n\nAlso, this behavior is with werkzeug 0.15 both on flask 1.0.2 and 1.0.3...\n\nIs there any way to monkey patch around this without enabling debug mode in production? For now I have to pin 1.0.2 in several dozen projects...\n-- \nJames Brown,\ncurrently mobile\n\n> On Jun 3, 2019, at 10:15, David Lord <notifications@github.com> wrote:\n> \n> I can't reproduce the issue when in debug mode, e.args[0] is the key. Out of debug mode, this now fails because we clear the args, since in Werkzeug 0.15 that's what triggers hiding the key, and I didn't think it was good to show the keys and non-standard error messages outside debug mode.\n> \n> Then again, this \"only show the key in debug mode\" is a completely made up thing I decided when adding the key to the output, it wasn't ever shown before Flask 1.0. I can just have it show all the time and never remove it?\n> \n> \u2014\n> You are receiving this because you authored the thread.\n> Reply to this email directly, view it on GitHub, or mute the thread.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/498352169",
            "html_url": "https://github.com/pallets/flask/issues/3249#issuecomment-498352169",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3249",
            "id": 498352169,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ5ODM1MjE2OQ==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-06-03T17:31:30Z",
            "updated_at": "2019-06-03T17:33:05Z",
            "author_association": "MEMBER",
            "body": "It doesn't exactly depend on debug mode, losing the key outside debug mode is an unintended side-effect of the new implementation of the key showing/hiding in Werkzeug 0.15, which gained support in Flask 1.0.\r\n\r\nYou should set `TRAP_BAD_REQUEST_ERRORS = True` in your config, since trapping the `BadRequestKeyError` to handle yourself is what you want. I've confirmed you get the behavior you want in that case."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/498423277",
            "html_url": "https://github.com/pallets/flask/issues/3249#issuecomment-498423277",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3249",
            "id": 498423277,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ5ODQyMzI3Nw==",
            "user": {
                "login": "Roguelazer",
                "id": 263424,
                "node_id": "MDQ6VXNlcjI2MzQyNA==",
                "avatar_url": "https://avatars3.githubusercontent.com/u/263424?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/Roguelazer",
                "html_url": "https://github.com/Roguelazer",
                "followers_url": "https://api.github.com/users/Roguelazer/followers",
                "following_url": "https://api.github.com/users/Roguelazer/following{/other_user}",
                "gists_url": "https://api.github.com/users/Roguelazer/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/Roguelazer/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Roguelazer/subscriptions",
                "organizations_url": "https://api.github.com/users/Roguelazer/orgs",
                "repos_url": "https://api.github.com/users/Roguelazer/repos",
                "events_url": "https://api.github.com/users/Roguelazer/events{/privacy}",
                "received_events_url": "https://api.github.com/users/Roguelazer/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-06-03T20:55:31Z",
            "updated_at": "2019-06-03T20:55:31Z",
            "author_association": "NONE",
            "body": "I can confirm that setting `TRAP_BAD_REQUEST_ERRORS` to True in config fixes this.\r\n\r\nI still am kind of negative on the idea of emptying out `.args` by default in non-debug mode, but at least there's a workaround..."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/498434616",
            "html_url": "https://github.com/pallets/flask/issues/3249#issuecomment-498434616",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3249",
            "id": 498434616,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ5ODQzNDYxNg==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-06-03T21:32:31Z",
            "updated_at": "2019-06-03T21:32:31Z",
            "author_association": "MEMBER",
            "body": "If you have a suggestion for a better way to only output the information in Flask's debug mode, when the feature itself is part of Werkzeug, I'm open to review a PR to Werkzeug!"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/498444201",
            "html_url": "https://github.com/pallets/flask/issues/3249#issuecomment-498444201",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3249",
            "id": 498444201,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ5ODQ0NDIwMQ==",
            "user": {
                "login": "Roguelazer",
                "id": 263424,
                "node_id": "MDQ6VXNlcjI2MzQyNA==",
                "avatar_url": "https://avatars3.githubusercontent.com/u/263424?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/Roguelazer",
                "html_url": "https://github.com/Roguelazer",
                "followers_url": "https://api.github.com/users/Roguelazer/followers",
                "following_url": "https://api.github.com/users/Roguelazer/following{/other_user}",
                "gists_url": "https://api.github.com/users/Roguelazer/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/Roguelazer/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Roguelazer/subscriptions",
                "organizations_url": "https://api.github.com/users/Roguelazer/orgs",
                "repos_url": "https://api.github.com/users/Roguelazer/repos",
                "events_url": "https://api.github.com/users/Roguelazer/events{/privacy}",
                "received_events_url": "https://api.github.com/users/Roguelazer/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-06-03T22:06:36Z",
            "updated_at": "2019-06-03T22:06:36Z",
            "author_association": "NONE",
            "body": "Is `e.args` actually auto-dumped? Would it be sufficient to remove it from `e.description` but just leave `e.args` alone?"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/500428527",
            "html_url": "https://github.com/pallets/flask/issues/3249#issuecomment-500428527",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3249",
            "id": 500428527,
            "node_id": "MDEyOklzc3VlQ29tbWVudDUwMDQyODUyNw==",
            "user": {
                "login": "LuckyDenis",
                "id": 41421345,
                "node_id": "MDQ6VXNlcjQxNDIxMzQ1",
                "avatar_url": "https://avatars2.githubusercontent.com/u/41421345?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/LuckyDenis",
                "html_url": "https://github.com/LuckyDenis",
                "followers_url": "https://api.github.com/users/LuckyDenis/followers",
                "following_url": "https://api.github.com/users/LuckyDenis/following{/other_user}",
                "gists_url": "https://api.github.com/users/LuckyDenis/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/LuckyDenis/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/LuckyDenis/subscriptions",
                "organizations_url": "https://api.github.com/users/LuckyDenis/orgs",
                "repos_url": "https://api.github.com/users/LuckyDenis/repos",
                "events_url": "https://api.github.com/users/LuckyDenis/events{/privacy}",
                "received_events_url": "https://api.github.com/users/LuckyDenis/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-06-10T14:04:22Z",
            "updated_at": "2019-06-24T16:36:30Z",
            "author_association": "NONE",
            "body": "Hello. I can take this problem or it's fix already?"
        }
    ]
}