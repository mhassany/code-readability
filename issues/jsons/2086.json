{
    "url": "https://api.github.com/repos/pallets/flask/issues/2086",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/2086/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/2086/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/2086/events",
    "html_url": "https://github.com/pallets/flask/issues/2086",
    "id": 189762046,
    "node_id": "MDU6SXNzdWUxODk3NjIwNDY=",
    "number": 2086,
    "title": "large file uploads eating up memory",
    "user": {
        "login": "cecemel",
        "id": 2422745,
        "node_id": "MDQ6VXNlcjI0MjI3NDU=",
        "avatar_url": "https://avatars3.githubusercontent.com/u/2422745?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/cecemel",
        "html_url": "https://github.com/cecemel",
        "followers_url": "https://api.github.com/users/cecemel/followers",
        "following_url": "https://api.github.com/users/cecemel/following{/other_user}",
        "gists_url": "https://api.github.com/users/cecemel/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/cecemel/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/cecemel/subscriptions",
        "organizations_url": "https://api.github.com/users/cecemel/orgs",
        "repos_url": "https://api.github.com/users/cecemel/repos",
        "events_url": "https://api.github.com/users/cecemel/events{/privacy}",
        "received_events_url": "https://api.github.com/users/cecemel/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 17,
    "created_at": "2016-11-16T16:35:11Z",
    "updated_at": "2019-08-24T11:08:20Z",
    "closed_at": "2017-06-02T15:00:50Z",
    "author_association": "NONE",
    "body": "Hi, \r\n\r\nwhen handling large file uploads +300MB, the files seem to be cached in memory till the upload is finished. This is not very practical.\r\nThe [doc](http://flask.pocoo.org/docs/0.11/patterns/fileuploads) states: \r\n\r\n>(...) So how exactly does Flask handle uploads? Well it will store them in the webserver\u2019s memory if the files are reasonable small otherwise in a temporary location\r\n\r\nI am unsure on how to interpret this, but as I saw it: cache the data on disk till the file is uploaded, before moving on. :-)\r\n\r\nSo my question is: is storing everything in memory during upload, intended behaviour?\r\n\r\nTo give a little more details on the code: \r\n\r\n```\r\ndef store_upload(project_id):\r\n    file = request.files['file']\r\n    # boiler plate checks ...\r\n    file.save(os.path.join(destination_base, destination))  #save file to decent location\r\n    return _response_stuff()\r\n```\r\nI am using python 3.5, flask 0.11.1. \r\n\r\nPS: I went through #pocoo and github issues here, but couldn't find any answer matching my request\r\n\r\nThanks!\r\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/261198385",
            "html_url": "https://github.com/pallets/flask/issues/2086#issuecomment-261198385",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2086",
            "id": 261198385,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI2MTE5ODM4NQ==",
            "user": {
                "login": "cecemel",
                "id": 2422745,
                "node_id": "MDQ6VXNlcjI0MjI3NDU=",
                "avatar_url": "https://avatars3.githubusercontent.com/u/2422745?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/cecemel",
                "html_url": "https://github.com/cecemel",
                "followers_url": "https://api.github.com/users/cecemel/followers",
                "following_url": "https://api.github.com/users/cecemel/following{/other_user}",
                "gists_url": "https://api.github.com/users/cecemel/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/cecemel/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/cecemel/subscriptions",
                "organizations_url": "https://api.github.com/users/cecemel/orgs",
                "repos_url": "https://api.github.com/users/cecemel/repos",
                "events_url": "https://api.github.com/users/cecemel/events{/privacy}",
                "received_events_url": "https://api.github.com/users/cecemel/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-11-17T09:33:26Z",
            "updated_at": "2016-11-17T09:33:26Z",
            "author_association": "NONE",
            "body": "Looks similar to a werkzeug issue. (which is closed) \n[here](https://github.com/pallets/werkzeug/issues/510)\n\nThe werkzeug version I am using: 0.11.10, so the fix should be applied.\n\nHere someone is experiencing the same issue as I am. [here](https://github.com/codalab/codalab-cli/issues/301)\n\nShall I have a look there?\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/261962321",
            "html_url": "https://github.com/pallets/flask/issues/2086#issuecomment-261962321",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2086",
            "id": 261962321,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI2MTk2MjMyMQ==",
            "user": {
                "login": "lnielsen",
                "id": 1698163,
                "node_id": "MDQ6VXNlcjE2OTgxNjM=",
                "avatar_url": "https://avatars3.githubusercontent.com/u/1698163?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/lnielsen",
                "html_url": "https://github.com/lnielsen",
                "followers_url": "https://api.github.com/users/lnielsen/followers",
                "following_url": "https://api.github.com/users/lnielsen/following{/other_user}",
                "gists_url": "https://api.github.com/users/lnielsen/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/lnielsen/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/lnielsen/subscriptions",
                "organizations_url": "https://api.github.com/users/lnielsen/orgs",
                "repos_url": "https://api.github.com/users/lnielsen/repos",
                "events_url": "https://api.github.com/users/lnielsen/events{/privacy}",
                "received_events_url": "https://api.github.com/users/lnielsen/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-11-21T15:04:54Z",
            "updated_at": "2016-11-21T15:04:54Z",
            "author_association": "NONE",
            "body": "There's two issues you are likely experiencing:\r\n- Werkzeug's multipart form parser is very slow for large files - see pallets/werkzeug#875\r\n- Werkzeug will write a temporary file for anything larger than 500KB: https://github.com/pallets/werkzeug/blob/master/werkzeug/formparser.py#L41\r\n\r\nIf you want to upload large files through Flask I suggest you simply stream them directly in the request body. It's magnitudes faster on both client and server side as there's no encoding/decoding of the file. Basically you just read from ``request.stream``.\r\n\r\nThis is what we've done on zenodo.org and we're having users upload 200GB+ datasets over HTTP with speeds that's only limited by our storage clusters incoming capacity."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/262283986",
            "html_url": "https://github.com/pallets/flask/issues/2086#issuecomment-262283986",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2086",
            "id": 262283986,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI2MjI4Mzk4Ng==",
            "user": {
                "login": "cecemel",
                "id": 2422745,
                "node_id": "MDQ6VXNlcjI0MjI3NDU=",
                "avatar_url": "https://avatars3.githubusercontent.com/u/2422745?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/cecemel",
                "html_url": "https://github.com/cecemel",
                "followers_url": "https://api.github.com/users/cecemel/followers",
                "following_url": "https://api.github.com/users/cecemel/following{/other_user}",
                "gists_url": "https://api.github.com/users/cecemel/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/cecemel/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/cecemel/subscriptions",
                "organizations_url": "https://api.github.com/users/cecemel/orgs",
                "repos_url": "https://api.github.com/users/cecemel/repos",
                "events_url": "https://api.github.com/users/cecemel/events{/privacy}",
                "received_events_url": "https://api.github.com/users/cecemel/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-11-22T16:09:40Z",
            "updated_at": "2016-11-22T16:09:40Z",
            "author_association": "NONE",
            "body": "Thanks for your tip!\r\n However, reading from the stream, does not seem to fix the issue... The memory consumption still grows with the same order as the size of the file it receives...\r\nThe code is basically doing: \r\n```\r\n#(...)\r\n with open(temp_file, 'wb') as f:\r\n        while not request.stream.is_exhausted:\r\n            f.write(request.stream.read(10))\r\n```\r\nAlso using request.stream.read() does not seem to make any difference.\r\nPerhaps I am doing something wrong.\r\n\r\nAll tips (even to better frame the problem) are welcome. \r\nthanks again\r\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/262337738",
            "html_url": "https://github.com/pallets/flask/issues/2086#issuecomment-262337738",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2086",
            "id": 262337738,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI2MjMzNzczOA==",
            "user": {
                "login": "lnielsen",
                "id": 1698163,
                "node_id": "MDQ6VXNlcjE2OTgxNjM=",
                "avatar_url": "https://avatars3.githubusercontent.com/u/1698163?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/lnielsen",
                "html_url": "https://github.com/lnielsen",
                "followers_url": "https://api.github.com/users/lnielsen/followers",
                "following_url": "https://api.github.com/users/lnielsen/following{/other_user}",
                "gists_url": "https://api.github.com/users/lnielsen/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/lnielsen/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/lnielsen/subscriptions",
                "organizations_url": "https://api.github.com/users/lnielsen/orgs",
                "repos_url": "https://api.github.com/users/lnielsen/repos",
                "events_url": "https://api.github.com/users/lnielsen/events{/privacy}",
                "received_events_url": "https://api.github.com/users/lnielsen/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-11-22T19:18:55Z",
            "updated_at": "2016-11-22T19:18:55Z",
            "author_association": "NONE",
            "body": "Check e.g. the request.mimetype and make sure it is not ``application/multipart-formdata`` (if it is, the form parser will likely kick in no matter what).\r\n\r\nA side not is that likely you want to read bigger chunks that 10 bytes when writing the file."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/262564401",
            "html_url": "https://github.com/pallets/flask/issues/2086#issuecomment-262564401",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2086",
            "id": 262564401,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI2MjU2NDQwMQ==",
            "user": {
                "login": "cecemel",
                "id": 2422745,
                "node_id": "MDQ6VXNlcjI0MjI3NDU=",
                "avatar_url": "https://avatars3.githubusercontent.com/u/2422745?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/cecemel",
                "html_url": "https://github.com/cecemel",
                "followers_url": "https://api.github.com/users/cecemel/followers",
                "following_url": "https://api.github.com/users/cecemel/following{/other_user}",
                "gists_url": "https://api.github.com/users/cecemel/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/cecemel/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/cecemel/subscriptions",
                "organizations_url": "https://api.github.com/users/cecemel/orgs",
                "repos_url": "https://api.github.com/users/cecemel/repos",
                "events_url": "https://api.github.com/users/cecemel/events{/privacy}",
                "received_events_url": "https://api.github.com/users/cecemel/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-11-23T16:30:39Z",
            "updated_at": "2016-11-23T16:30:39Z",
            "author_association": "NONE",
            "body": "Hi, \r\n\r\nthanks for the tips again! \r\nYes the 10 bytes reading was just illustrative to make sure the chunks remain small. \r\n\r\nHowever, I am Still facing the same issue, even with other mimetypes. With or without WSGI server (gunicorn). Memory usage just explodes.\r\n\r\nBut it looks like more and more an issue with werkzeug. Citing someone in [this issue](https://github.com/codalab/codalab-cli/issues/301)\r\n\r\n>(...) What it does instead is always store the entire file in memory, at least in one part of the code.\r\n\r\nI will try to look for alternatives and bump the werkzeug people\r\nThanks for all the help!\r\n\r\n\r\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/262738132",
            "html_url": "https://github.com/pallets/flask/issues/2086#issuecomment-262738132",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2086",
            "id": 262738132,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI2MjczODEzMg==",
            "user": {
                "login": "cecemel",
                "id": 2422745,
                "node_id": "MDQ6VXNlcjI0MjI3NDU=",
                "avatar_url": "https://avatars3.githubusercontent.com/u/2422745?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/cecemel",
                "html_url": "https://github.com/cecemel",
                "followers_url": "https://api.github.com/users/cecemel/followers",
                "following_url": "https://api.github.com/users/cecemel/following{/other_user}",
                "gists_url": "https://api.github.com/users/cecemel/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/cecemel/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/cecemel/subscriptions",
                "organizations_url": "https://api.github.com/users/cecemel/orgs",
                "repos_url": "https://api.github.com/users/cecemel/repos",
                "events_url": "https://api.github.com/users/cecemel/events{/privacy}",
                "received_events_url": "https://api.github.com/users/cecemel/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-11-24T10:08:29Z",
            "updated_at": "2016-11-24T10:08:29Z",
            "author_association": "NONE",
            "body": "To better frame the issue, I created a docker image which may be tried out.\r\n\r\nTo run it:\r\n\r\n`docker run --name flask_upload_issue -p 5000:5000 docker.io/cecemel/flask_upload_issue`\r\n\r\nClient side you could upload a file, like\r\n\r\n`curl -X POST -F file=@some_large_file http://localhost:5000/uploads`\r\n\r\nTo monitor memory usage\r\n\r\n`docker stats flask_upload_issue`\r\n\r\nTo check the code, go inside the container (so it should be running):\r\n\r\n`docker exec -ti flask_upload_issue bash`\r\n\r\nThe folder 'example' contains the code.\r\n\r\nPerhaps this gives more clues.\r\nThanks!\r\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/262954796",
            "html_url": "https://github.com/pallets/flask/issues/2086#issuecomment-262954796",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2086",
            "id": 262954796,
            "node_id": "MDEyOklzc3VlQ29tbWVudDI2Mjk1NDc5Ng==",
            "user": {
                "login": "ivarref",
                "id": 74075,
                "node_id": "MDQ6VXNlcjc0MDc1",
                "avatar_url": "https://avatars1.githubusercontent.com/u/74075?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ivarref",
                "html_url": "https://github.com/ivarref",
                "followers_url": "https://api.github.com/users/ivarref/followers",
                "following_url": "https://api.github.com/users/ivarref/following{/other_user}",
                "gists_url": "https://api.github.com/users/ivarref/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ivarref/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ivarref/subscriptions",
                "organizations_url": "https://api.github.com/users/ivarref/orgs",
                "repos_url": "https://api.github.com/users/ivarref/repos",
                "events_url": "https://api.github.com/users/ivarref/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ivarref/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-11-25T13:11:28Z",
            "updated_at": "2019-08-24T11:08:20Z",
            "author_association": "NONE",
            "body": "Cross post from https://github.com/pallets/werkzeug/issues/1041 :\r\n\r\nHere is a sample Flask application for handling huge file uploads:\r\nhttps://gitlab.nsd.no/ire/python-webserver-file-submission-poc/blob/master/flask_app.py\r\n\r\nAt my machine it handles a 22 GiB file in ~60 seconds. Memory usage is constant at about 13 MiB.\r\n\r\nNote: This approach bypasses `Flask` and uses `werkzeug.formparser` directly.\r\n\r\nEdit 2019 (three years later): \r\nUpdate to correct link.\r\nWarning: I have not updated the code since 2016, and thus old versions of both Flask and Werkzeug is used."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/305813499",
            "html_url": "https://github.com/pallets/flask/issues/2086#issuecomment-305813499",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2086",
            "id": 305813499,
            "node_id": "MDEyOklzc3VlQ29tbWVudDMwNTgxMzQ5OQ==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-06-02T15:00:50Z",
            "updated_at": "2017-06-02T15:01:31Z",
            "author_association": "MEMBER",
            "body": "Closing, this is a Werkzeug issue and is already reported there. If anyone has experience dealing with this and can work it into a patch, we appreciate any help!"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/308673900",
            "html_url": "https://github.com/pallets/flask/issues/2086#issuecomment-308673900",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2086",
            "id": 308673900,
            "node_id": "MDEyOklzc3VlQ29tbWVudDMwODY3MzkwMA==",
            "user": {
                "login": "bingtel",
                "id": 24327444,
                "node_id": "MDQ6VXNlcjI0MzI3NDQ0",
                "avatar_url": "https://avatars0.githubusercontent.com/u/24327444?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/bingtel",
                "html_url": "https://github.com/bingtel",
                "followers_url": "https://api.github.com/users/bingtel/followers",
                "following_url": "https://api.github.com/users/bingtel/following{/other_user}",
                "gists_url": "https://api.github.com/users/bingtel/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/bingtel/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/bingtel/subscriptions",
                "organizations_url": "https://api.github.com/users/bingtel/orgs",
                "repos_url": "https://api.github.com/users/bingtel/repos",
                "events_url": "https://api.github.com/users/bingtel/events{/privacy}",
                "received_events_url": "https://api.github.com/users/bingtel/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2017-06-15T09:06:06Z",
            "updated_at": "2017-06-15T09:06:06Z",
            "author_association": "NONE",
            "body": "@ivarref I tried your way\uff0c but **buf /cache** will be used too much\uff1a\r\n\r\nYou can reproduce the result with 'free -m'"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/358910296",
            "html_url": "https://github.com/pallets/flask/issues/2086#issuecomment-358910296",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2086",
            "id": 358910296,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM1ODkxMDI5Ng==",
            "user": {
                "login": "nejdetckenobi",
                "id": 4905664,
                "node_id": "MDQ6VXNlcjQ5MDU2NjQ=",
                "avatar_url": "https://avatars0.githubusercontent.com/u/4905664?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/nejdetckenobi",
                "html_url": "https://github.com/nejdetckenobi",
                "followers_url": "https://api.github.com/users/nejdetckenobi/followers",
                "following_url": "https://api.github.com/users/nejdetckenobi/following{/other_user}",
                "gists_url": "https://api.github.com/users/nejdetckenobi/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/nejdetckenobi/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/nejdetckenobi/subscriptions",
                "organizations_url": "https://api.github.com/users/nejdetckenobi/orgs",
                "repos_url": "https://api.github.com/users/nejdetckenobi/repos",
                "events_url": "https://api.github.com/users/nejdetckenobi/events{/privacy}",
                "received_events_url": "https://api.github.com/users/nejdetckenobi/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-01-19T09:21:18Z",
            "updated_at": "2018-03-13T07:10:36Z",
            "author_association": "NONE",
            "body": "It is worth to note that after @ivarref's approach, config keys like `MAX_CONTENT_LENGTH` can not be used automatically (because of bypassing Flask I think)."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/364708543",
            "html_url": "https://github.com/pallets/flask/issues/2086#issuecomment-364708543",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2086",
            "id": 364708543,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM2NDcwODU0Mw==",
            "user": {
                "login": "dhruvp",
                "id": 2255690,
                "node_id": "MDQ6VXNlcjIyNTU2OTA=",
                "avatar_url": "https://avatars2.githubusercontent.com/u/2255690?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/dhruvp",
                "html_url": "https://github.com/dhruvp",
                "followers_url": "https://api.github.com/users/dhruvp/followers",
                "following_url": "https://api.github.com/users/dhruvp/following{/other_user}",
                "gists_url": "https://api.github.com/users/dhruvp/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/dhruvp/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/dhruvp/subscriptions",
                "organizations_url": "https://api.github.com/users/dhruvp/orgs",
                "repos_url": "https://api.github.com/users/dhruvp/repos",
                "events_url": "https://api.github.com/users/dhruvp/events{/privacy}",
                "received_events_url": "https://api.github.com/users/dhruvp/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-02-11T00:38:02Z",
            "updated_at": "2018-02-11T00:38:02Z",
            "author_association": "NONE",
            "body": "@ivarref thank you for the snippet! It works great locally but when I put it in an environment w/ Gunicorn behind an NGINX server, I keep seeing ClientDisconnect errors during the parsing of the from. Any idea what might be going on? Have you encountered this?"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/365247979",
            "html_url": "https://github.com/pallets/flask/issues/2086#issuecomment-365247979",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2086",
            "id": 365247979,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM2NTI0Nzk3OQ==",
            "user": {
                "login": "ivarref",
                "id": 74075,
                "node_id": "MDQ6VXNlcjc0MDc1",
                "avatar_url": "https://avatars1.githubusercontent.com/u/74075?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ivarref",
                "html_url": "https://github.com/ivarref",
                "followers_url": "https://api.github.com/users/ivarref/followers",
                "following_url": "https://api.github.com/users/ivarref/following{/other_user}",
                "gists_url": "https://api.github.com/users/ivarref/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ivarref/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ivarref/subscriptions",
                "organizations_url": "https://api.github.com/users/ivarref/orgs",
                "repos_url": "https://api.github.com/users/ivarref/repos",
                "events_url": "https://api.github.com/users/ivarref/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ivarref/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-02-13T12:06:47Z",
            "updated_at": "2018-02-13T12:06:47Z",
            "author_association": "NONE",
            "body": "Sorry @dhruvp I have no suggestion."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/389580761",
            "html_url": "https://github.com/pallets/flask/issues/2086#issuecomment-389580761",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2086",
            "id": 389580761,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM4OTU4MDc2MQ==",
            "user": {
                "login": "swwelch",
                "id": 6289523,
                "node_id": "MDQ6VXNlcjYyODk1MjM=",
                "avatar_url": "https://avatars2.githubusercontent.com/u/6289523?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/swwelch",
                "html_url": "https://github.com/swwelch",
                "followers_url": "https://api.github.com/users/swwelch/followers",
                "following_url": "https://api.github.com/users/swwelch/following{/other_user}",
                "gists_url": "https://api.github.com/users/swwelch/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/swwelch/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/swwelch/subscriptions",
                "organizations_url": "https://api.github.com/users/swwelch/orgs",
                "repos_url": "https://api.github.com/users/swwelch/repos",
                "events_url": "https://api.github.com/users/swwelch/events{/privacy}",
                "received_events_url": "https://api.github.com/users/swwelch/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-05-16T16:24:18Z",
            "updated_at": "2018-05-16T19:54:32Z",
            "author_association": "NONE",
            "body": "I needed to chunk file uploads to AWS for a project recently, and I was able to do this using @ivarref's approach by subclassing Flask and overriding only the stream factory. @nejdetckenobi, this enables `MAX_CONTENT_LENGTH` and things like `flask_wtf` to still be used to handle the forms. An example module is [here](https://gist.github.com/swwelch/cb84357a6a233d7b3b6edaa5372cf91d). With that, you should be able to create an application with something like:\r\n```\r\nfrom streaming_flask import StreamingFlask\r\napp = StreamingFlask(__name__)\r\n```\r\n@dhruvp the code here worked for me using gunicorn with gevent workers, although I currently have worker timeout set to 120 seconds."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/389591479",
            "html_url": "https://github.com/pallets/flask/issues/2086#issuecomment-389591479",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2086",
            "id": 389591479,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM4OTU5MTQ3OQ==",
            "user": {
                "login": "dhruvp",
                "id": 2255690,
                "node_id": "MDQ6VXNlcjIyNTU2OTA=",
                "avatar_url": "https://avatars2.githubusercontent.com/u/2255690?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/dhruvp",
                "html_url": "https://github.com/dhruvp",
                "followers_url": "https://api.github.com/users/dhruvp/followers",
                "following_url": "https://api.github.com/users/dhruvp/following{/other_user}",
                "gists_url": "https://api.github.com/users/dhruvp/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/dhruvp/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/dhruvp/subscriptions",
                "organizations_url": "https://api.github.com/users/dhruvp/orgs",
                "repos_url": "https://api.github.com/users/dhruvp/repos",
                "events_url": "https://api.github.com/users/dhruvp/events{/privacy}",
                "received_events_url": "https://api.github.com/users/dhruvp/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-05-16T16:58:10Z",
            "updated_at": "2019-01-06T14:50:47Z",
            "author_association": "NONE",
            "body": "Thanks for the tips @swwelch !"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/451747222",
            "html_url": "https://github.com/pallets/flask/issues/2086#issuecomment-451747222",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2086",
            "id": 451747222,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MTc0NzIyMg==",
            "user": {
                "login": "mhocine",
                "id": 9307282,
                "node_id": "MDQ6VXNlcjkzMDcyODI=",
                "avatar_url": "https://avatars0.githubusercontent.com/u/9307282?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/mhocine",
                "html_url": "https://github.com/mhocine",
                "followers_url": "https://api.github.com/users/mhocine/followers",
                "following_url": "https://api.github.com/users/mhocine/following{/other_user}",
                "gists_url": "https://api.github.com/users/mhocine/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/mhocine/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/mhocine/subscriptions",
                "organizations_url": "https://api.github.com/users/mhocine/orgs",
                "repos_url": "https://api.github.com/users/mhocine/repos",
                "events_url": "https://api.github.com/users/mhocine/events{/privacy}",
                "received_events_url": "https://api.github.com/users/mhocine/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-01-06T14:49:08Z",
            "updated_at": "2019-01-06T14:50:52Z",
            "author_association": "NONE",
            "body": "Thank you ! This Helped me !"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/524298450",
            "html_url": "https://github.com/pallets/flask/issues/2086#issuecomment-524298450",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2086",
            "id": 524298450,
            "node_id": "MDEyOklzc3VlQ29tbWVudDUyNDI5ODQ1MA==",
            "user": {
                "login": "OdysLam",
                "id": 13405632,
                "node_id": "MDQ6VXNlcjEzNDA1NjMy",
                "avatar_url": "https://avatars0.githubusercontent.com/u/13405632?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/OdysLam",
                "html_url": "https://github.com/OdysLam",
                "followers_url": "https://api.github.com/users/OdysLam/followers",
                "following_url": "https://api.github.com/users/OdysLam/following{/other_user}",
                "gists_url": "https://api.github.com/users/OdysLam/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/OdysLam/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/OdysLam/subscriptions",
                "organizations_url": "https://api.github.com/users/OdysLam/orgs",
                "repos_url": "https://api.github.com/users/OdysLam/repos",
                "events_url": "https://api.github.com/users/OdysLam/events{/privacy}",
                "received_events_url": "https://api.github.com/users/OdysLam/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-08-23T12:34:42Z",
            "updated_at": "2019-08-23T12:34:42Z",
            "author_association": "NONE",
            "body": "Hey @ivarref ,\r\n\r\nThank you for your snippet! What kind of request must be done to that flask server? I hope that my question is not extremely elementary.\r\n\r\nCheers! :)"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/524541614",
            "html_url": "https://github.com/pallets/flask/issues/2086#issuecomment-524541614",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2086",
            "id": 524541614,
            "node_id": "MDEyOklzc3VlQ29tbWVudDUyNDU0MTYxNA==",
            "user": {
                "login": "ivarref",
                "id": 74075,
                "node_id": "MDQ6VXNlcjc0MDc1",
                "avatar_url": "https://avatars1.githubusercontent.com/u/74075?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/ivarref",
                "html_url": "https://github.com/ivarref",
                "followers_url": "https://api.github.com/users/ivarref/followers",
                "following_url": "https://api.github.com/users/ivarref/following{/other_user}",
                "gists_url": "https://api.github.com/users/ivarref/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/ivarref/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/ivarref/subscriptions",
                "organizations_url": "https://api.github.com/users/ivarref/orgs",
                "repos_url": "https://api.github.com/users/ivarref/repos",
                "events_url": "https://api.github.com/users/ivarref/events{/privacy}",
                "received_events_url": "https://api.github.com/users/ivarref/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2019-08-24T11:04:00Z",
            "updated_at": "2019-08-24T11:04:00Z",
            "author_association": "NONE",
            "body": "Hey @OdysLam \r\n\r\nHere is an example request using curl:\r\n\r\n```bash\r\ncurl -XPOST -F \"file=@./my.big.file.bin\" \"http://localhost:8090/\"\r\n```\r\n\r\nThis is documented at the [repository root](https://gitlab.nsd.no/ire/python-webserver-file-submission-poc).\r\n\r\nWarning: Please note that this code uses Flask version 0.11.1, while as of writing this Flask 1.1.1 has been released. Also I have not looked at this code since writing it."
        }
    ]
}