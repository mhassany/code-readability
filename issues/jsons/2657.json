{
    "url": "https://api.github.com/repos/pallets/flask/issues/2657",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/2657/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/2657/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/2657/events",
    "html_url": "https://github.com/pallets/flask/issues/2657",
    "id": 304155561,
    "node_id": "MDU6SXNzdWUzMDQxNTU1NjE=",
    "number": 2657,
    "title": "Reloader different behavior Windows vs Linux ",
    "user": {
        "login": "jgyates",
        "id": 4513286,
        "node_id": "MDQ6VXNlcjQ1MTMyODY=",
        "avatar_url": "https://avatars1.githubusercontent.com/u/4513286?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/jgyates",
        "html_url": "https://github.com/jgyates",
        "followers_url": "https://api.github.com/users/jgyates/followers",
        "following_url": "https://api.github.com/users/jgyates/following{/other_user}",
        "gists_url": "https://api.github.com/users/jgyates/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/jgyates/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/jgyates/subscriptions",
        "organizations_url": "https://api.github.com/users/jgyates/orgs",
        "repos_url": "https://api.github.com/users/jgyates/repos",
        "events_url": "https://api.github.com/users/jgyates/events{/privacy}",
        "received_events_url": "https://api.github.com/users/jgyates/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 1,
    "created_at": "2018-03-11T12:49:46Z",
    "updated_at": "2018-03-13T15:37:17Z",
    "closed_at": "2018-03-13T15:37:00Z",
    "author_association": "NONE",
    "body": "I have a simple flask app that I want to restart if the server port is changed in a config file. I have the following code:\r\n\r\n    #!/usr/bin/env python\r\n\r\n    from flask import Flask, redirect\r\n    import os\r\n    import configparser\r\n\r\n    config = configparser.ConfigParser()\r\n    config.read('portnumber.ini')\r\n\r\n    app = Flask(__name__,static_url_path='')\r\n\r\n    HTTPPort = config['MAIN'].getint('portnumber')\r\n\r\n\r\n    def touchMe():\r\n        with open(__file__, 'a'):\r\n            print(\" - setting timestamp of \" + __file__ )\r\n            os.utime(__file__, None)\r\n\r\n    @app.route(\"/newport/<newport>\")\r\n    def changeRoute(newport):\r\n        HTTPPort = newport\r\n        name = newport\r\n        config['MAIN']['portnumber'] = newport\r\n        with open('portnumber.ini', 'w') as configfile:\r\n            config.write(configfile)\r\n        touchMe()\r\n        newurl = \"http://192.168.11.15:\" + HTTPPort + \"/\"\r\n        print(\"Redirecting to \" + newurl)\r\n\r\n        return redirect(newurl, code=302)\r\n\r\n\r\n    #------------------------------------------------------------\r\n    if __name__ == \"__main__\":\r\n\r\n        # load options from file, which change HTTPPort value\r\n        # LoadConfig()\r\n        while True:\r\n            app.run(host=\"0.0.0.0\", port=HTTPPort, debug=True, use_reloader=True)\r\n\r\nThe this code works as expected on Windows 10, however the port fails to change on Linux (or ssl_context also does not change if used). I am running Raspbian Jessie. I have also tried disabling the reloader and replacing the python process with the following call:\r\n\r\n    os.execl(sys.executable, 'python', __file__, *sys.argv[1:])\r\n    \r\nThis works on Windows, however on Linux, app.run() fails on reload with \"\"Address already in use\"\" error. I have reviewed the documentation and past issues however I have not found anything specific to these symptoms. \r\n\r\nI have found that, on Linux, if I use and external script to kill the python script (pkill) and reload the script it works about half of the time. When it fails it is due the \"Address already in use\" error.\r\n\r\nI have also tried this with Watchdog and I get the same results on Linux. I have duplicated this with python 2.7.9 and 3.6.4. I am using Flask 0.12.2 \r\n\r\nIs this a known issue and if so are there any workarounds? Is there another way to pragmatically change the port and ssl_context of a running Flask app on Linux?\r\n\r\n\r\n### Environment\r\n* Windows 10 and Raspbian Jessie\r\n* Python version: 2.7.9 and 3.6.4\r\n* Flask version: 0.12.2\r\n* Werkzeug version: 0.12.2\r\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/372709182",
            "html_url": "https://github.com/pallets/flask/issues/2657#issuecomment-372709182",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/2657",
            "id": 372709182,
            "node_id": "MDEyOklzc3VlQ29tbWVudDM3MjcwOTE4Mg==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-03-13T15:37:00Z",
            "updated_at": "2018-03-13T15:37:17Z",
            "author_association": "MEMBER",
            "body": "I'm not really clear why you're trying to do that, but changing the port of the dev server while it's running is not supported (and would be a Werkzeug issue if it was). Also, you shouldn't be using the dev server in a production environment, use a production WSGI server like uWSGI. If you want to manage a server's configuration and running processes, use a configuration management tool like Ansible."
        }
    ]
}