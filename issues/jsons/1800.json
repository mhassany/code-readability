{
    "url": "https://api.github.com/repos/pallets/flask/issues/1800",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/1800/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/1800/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/1800/events",
    "html_url": "https://github.com/pallets/flask/issues/1800",
    "id": 153631049,
    "node_id": "MDU6SXNzdWUxNTM2MzEwNDk=",
    "number": 1800,
    "title": "ImportError when dropping privileges before running Flask",
    "user": {
        "login": "blechschmidt",
        "id": 18330291,
        "node_id": "MDQ6VXNlcjE4MzMwMjkx",
        "avatar_url": "https://avatars1.githubusercontent.com/u/18330291?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/blechschmidt",
        "html_url": "https://github.com/blechschmidt",
        "followers_url": "https://api.github.com/users/blechschmidt/followers",
        "following_url": "https://api.github.com/users/blechschmidt/following{/other_user}",
        "gists_url": "https://api.github.com/users/blechschmidt/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/blechschmidt/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/blechschmidt/subscriptions",
        "organizations_url": "https://api.github.com/users/blechschmidt/orgs",
        "repos_url": "https://api.github.com/users/blechschmidt/repos",
        "events_url": "https://api.github.com/users/blechschmidt/events{/privacy}",
        "received_events_url": "https://api.github.com/users/blechschmidt/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 4,
    "created_at": "2016-05-08T02:37:33Z",
    "updated_at": "2016-05-08T15:48:00Z",
    "closed_at": "2016-05-08T15:48:00Z",
    "author_association": "NONE",
    "body": "When using Flask as privileged user, it may under circumstances not be possible to drop permissions before the app is run, including when using ports that do not require root privileges.\n\n```\ndrop_privileges() # drop privileges to nobody\napp.run()\n```\n\nThe above code will throw an `ImportError`, given the scenario that Flask's python files are not accessible to the nobody user due to file permissions, because Flask's `run`-method (and other internal methods) make use of additional inline imports.\n\nAs this scenario might be more common, it may be desirable to move all inline imports to the top of their respective module.\n\nThere are various other reasons that might support the request to move imports to the top of modules: See [Python import coding style](https://stackoverflow.com/questions/477096).\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/217698154",
            "html_url": "https://github.com/pallets/flask/issues/1800#issuecomment-217698154",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1800",
            "id": 217698154,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIxNzY5ODE1NA==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-05-08T06:31:09Z",
            "updated_at": "2016-05-08T06:33:05Z",
            "author_association": "MEMBER",
            "body": "I can't reproduce your error.  Running Python as root, setting group and user to \"nobody\", then importing Flask still succeeds.\n\nA better pattern is to create a user for your app, set up a virtualenv with that user, and run as that user.  Supervisor, uWSGI, and probably others all include the ability to set the user and group to run as.\n\n`/usr/lib/pythonX.Y/site-packages` is typically installed with other+read privileges as well, so should still be readable anyway.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/217699230",
            "html_url": "https://github.com/pallets/flask/issues/1800#issuecomment-217699230",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1800",
            "id": 217699230,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIxNzY5OTIzMA==",
            "user": {
                "login": "RonnyPfannschmidt",
                "id": 156838,
                "node_id": "MDQ6VXNlcjE1NjgzOA==",
                "avatar_url": "https://avatars1.githubusercontent.com/u/156838?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/RonnyPfannschmidt",
                "html_url": "https://github.com/RonnyPfannschmidt",
                "followers_url": "https://api.github.com/users/RonnyPfannschmidt/followers",
                "following_url": "https://api.github.com/users/RonnyPfannschmidt/following{/other_user}",
                "gists_url": "https://api.github.com/users/RonnyPfannschmidt/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/RonnyPfannschmidt/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/RonnyPfannschmidt/subscriptions",
                "organizations_url": "https://api.github.com/users/RonnyPfannschmidt/orgs",
                "repos_url": "https://api.github.com/users/RonnyPfannschmidt/repos",
                "events_url": "https://api.github.com/users/RonnyPfannschmidt/events{/privacy}",
                "received_events_url": "https://api.github.com/users/RonnyPfannschmidt/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-05-08T06:58:38Z",
            "updated_at": "2016-05-08T06:58:38Z",
            "author_association": "CONTRIBUTOR",
            "body": "also note that you should never use `app.run` in production\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/217726770",
            "html_url": "https://github.com/pallets/flask/issues/1800#issuecomment-217726770",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1800",
            "id": 217726770,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIxNzcyNjc3MA==",
            "user": {
                "login": "blechschmidt",
                "id": 18330291,
                "node_id": "MDQ6VXNlcjE4MzMwMjkx",
                "avatar_url": "https://avatars1.githubusercontent.com/u/18330291?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/blechschmidt",
                "html_url": "https://github.com/blechschmidt",
                "followers_url": "https://api.github.com/users/blechschmidt/followers",
                "following_url": "https://api.github.com/users/blechschmidt/following{/other_user}",
                "gists_url": "https://api.github.com/users/blechschmidt/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/blechschmidt/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/blechschmidt/subscriptions",
                "organizations_url": "https://api.github.com/users/blechschmidt/orgs",
                "repos_url": "https://api.github.com/users/blechschmidt/repos",
                "events_url": "https://api.github.com/users/blechschmidt/events{/privacy}",
                "received_events_url": "https://api.github.com/users/blechschmidt/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-05-08T15:22:06Z",
            "updated_at": "2016-05-08T15:23:24Z",
            "author_association": "NONE",
            "body": "> I can't reproduce your error. Running Python as root, setting group and user to \"nobody\", then importing Flask still succeeds.\n\nThis is probably the case in a standard non-virtualized environment.\n\nIn my case, the virtual environment is located within the _/root/_-folder which _nobody_ does not have access to. Additionally, I have no control over the location of the virtual environment and at some point, the scripts within the environment indeed require _root_-access.\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/217727906",
            "html_url": "https://github.com/pallets/flask/issues/1800#issuecomment-217727906",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/1800",
            "id": 217727906,
            "node_id": "MDEyOklzc3VlQ29tbWVudDIxNzcyNzkwNg==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2016-05-08T15:48:00Z",
            "updated_at": "2016-05-08T15:48:00Z",
            "author_association": "MEMBER",
            "body": "Don't put your virtual environments in root.  That's not something we can fix.\n"
        }
    ]
}