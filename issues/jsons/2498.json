{
    "url": "https://api.github.com/repos/pallets/flask/issues/2498",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/2498/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/2498/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/2498/events",
    "html_url": "https://github.com/pallets/flask/issues/2498",
    "id": 266795706,
    "node_id": "MDU6SXNzdWUyNjY3OTU3MDY=",
    "number": 2498,
    "title": "Flask uploaded files successfully and the database changed but can't find the uploaded file in in the server",
    "user": {
        "login": "ym13349140",
        "id": 17507937,
        "node_id": "MDQ6VXNlcjE3NTA3OTM3",
        "avatar_url": "https://avatars0.githubusercontent.com/u/17507937?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ym13349140",
        "html_url": "https://github.com/ym13349140",
        "followers_url": "https://api.github.com/users/ym13349140/followers",
        "following_url": "https://api.github.com/users/ym13349140/following{/other_user}",
        "gists_url": "https://api.github.com/users/ym13349140/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/ym13349140/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/ym13349140/subscriptions",
        "organizations_url": "https://api.github.com/users/ym13349140/orgs",
        "repos_url": "https://api.github.com/users/ym13349140/repos",
        "events_url": "https://api.github.com/users/ym13349140/events{/privacy}",
        "received_events_url": "https://api.github.com/users/ym13349140/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 0,
    "created_at": "2017-10-19T10:33:43Z",
    "updated_at": "2017-10-19T12:30:25Z",
    "closed_at": "2017-10-19T12:30:25Z",
    "author_association": "NONE",
    "body": "hi,I used Flask to upload files to the server,.while I was uploading,nothing went wrong and there were not any bugs either, after the file was uploaded,the database was also modified, but when uploading finished, I clicked on the file link to find that no corresponding file on the server so the downloading process failed.Actually,there was a judgment after uploading,only when the file saved successfully success that it would write the database, but now the result turned out to be opposite,so I don't know where went wrong.Can somebody have a look?\r\n\r\n### my upload file function\r\n```\r\ndef upload_file(file_src, des_path, allowed_type=None):\r\n    if file_src.filename == '':\r\n        message = gettext('No selected file')\r\n        return False, message\r\n\r\n    extension = file_src.filename[file_src.filename.rfind('.')+1:]\r\n    file_type = extension_to_file_type(extension)\r\n    folder = des_path[:des_path.rfind('/')]\r\n\r\n    if not allowed_type:\r\n        allowed_type = current_app.config['ALLOWED_RESOURCE_TYPE']\r\n\r\n    if file_src and '.' in file_src.filename and file_type in allowed_type:\r\n        if not os.path.exists(folder):\r\n            os.makedirs(folder)\r\n        file_src.save(des_path)\r\n        unique_uri = os.stat(des_path).st_mtime\r\n        if os.path.exists(des_path):\r\n            return True, unique_uri\r\n        else:\r\n            message = gettext(\"Save File Failed!\")\r\n            return False, message\r\n    else:\r\n        message = gettext(\"Invalid file\")\r\n        return False, message\r\n```\r\n\r\n\r\n```python\r\nPaste a minimal example that causes the problem.\r\n```\r\n\r\n\r\n\r\n### Environment\r\n\r\n* Python version: 2.7.14\r\n* Flask version: 0.11.1\r\n* Werkzeug version:\r\n"
}