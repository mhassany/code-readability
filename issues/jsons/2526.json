{
    "url": "https://api.github.com/repos/pallets/flask/issues/2526",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/2526/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/2526/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/2526/events",
    "html_url": "https://github.com/pallets/flask/issues/2526",
    "id": 276305025,
    "node_id": "MDU6SXNzdWUyNzYzMDUwMjU=",
    "number": 2526,
    "title": "Invalid range with send_file() and xsendfile causes ValueError",
    "user": {
        "login": "ThiefMaster",
        "id": 179599,
        "node_id": "MDQ6VXNlcjE3OTU5OQ==",
        "avatar_url": "https://avatars1.githubusercontent.com/u/179599?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ThiefMaster",
        "html_url": "https://github.com/ThiefMaster",
        "followers_url": "https://api.github.com/users/ThiefMaster/followers",
        "following_url": "https://api.github.com/users/ThiefMaster/following{/other_user}",
        "gists_url": "https://api.github.com/users/ThiefMaster/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/ThiefMaster/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/ThiefMaster/subscriptions",
        "organizations_url": "https://api.github.com/users/ThiefMaster/orgs",
        "repos_url": "https://api.github.com/users/ThiefMaster/repos",
        "events_url": "https://api.github.com/users/ThiefMaster/events{/privacy}",
        "received_events_url": "https://api.github.com/users/ThiefMaster/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [
        {
            "id": 135583063,
            "node_id": "MDU6TGFiZWwxMzU1ODMwNjM=",
            "url": "https://api.github.com/repos/pallets/flask/labels/bug",
            "name": "bug",
            "color": "d93f0b",
            "default": true,
            "description": null
        }
    ],
    "state": "closed",
    "locked": false,
    "assignee": {
        "login": "ThiefMaster",
        "id": 179599,
        "node_id": "MDQ6VXNlcjE3OTU5OQ==",
        "avatar_url": "https://avatars1.githubusercontent.com/u/179599?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/ThiefMaster",
        "html_url": "https://github.com/ThiefMaster",
        "followers_url": "https://api.github.com/users/ThiefMaster/followers",
        "following_url": "https://api.github.com/users/ThiefMaster/following{/other_user}",
        "gists_url": "https://api.github.com/users/ThiefMaster/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/ThiefMaster/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/ThiefMaster/subscriptions",
        "organizations_url": "https://api.github.com/users/ThiefMaster/orgs",
        "repos_url": "https://api.github.com/users/ThiefMaster/repos",
        "events_url": "https://api.github.com/users/ThiefMaster/events{/privacy}",
        "received_events_url": "https://api.github.com/users/ThiefMaster/received_events",
        "type": "User",
        "site_admin": false
    },
    "assignees": [
        {
            "login": "ThiefMaster",
            "id": 179599,
            "node_id": "MDQ6VXNlcjE3OTU5OQ==",
            "avatar_url": "https://avatars1.githubusercontent.com/u/179599?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/ThiefMaster",
            "html_url": "https://github.com/ThiefMaster",
            "followers_url": "https://api.github.com/users/ThiefMaster/followers",
            "following_url": "https://api.github.com/users/ThiefMaster/following{/other_user}",
            "gists_url": "https://api.github.com/users/ThiefMaster/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/ThiefMaster/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/ThiefMaster/subscriptions",
            "organizations_url": "https://api.github.com/users/ThiefMaster/orgs",
            "repos_url": "https://api.github.com/users/ThiefMaster/repos",
            "events_url": "https://api.github.com/users/ThiefMaster/events{/privacy}",
            "received_events_url": "https://api.github.com/users/ThiefMaster/received_events",
            "type": "User",
            "site_admin": false
        }
    ],
    "milestone": null,
    "comments": 0,
    "created_at": "2017-11-23T09:13:39Z",
    "updated_at": "2017-11-24T23:44:49Z",
    "closed_at": "2017-11-24T23:44:49Z",
    "author_association": "MEMBER",
    "body": "```python\r\nfrom flask import Flask, send_file\r\n\r\napp = Flask(__name__)\r\napp.use_x_sendfile = True\r\n\r\n\r\n@app.route('/')\r\ndef index():\r\n    return send_file('/etc/passwd', mimetype='text/plain', conditional=True)\r\n```\r\n\r\n`http get http://127.0.0.1:8009/ Range:bytes=10000-` (the range needs to be invalid, so depending on the file sent the number needs to be higher) fails with this ValueError:\r\n\r\n```pytb\r\nTraceback (most recent call last):\r\n  File \"/home/adrian/dev/indico/env/lib/python2.7/site-packages/flask/app.py\", line 1982, in wsgi_app\r\n    response = self.full_dispatch_request()\r\n  File \"/home/adrian/dev/indico/env/lib/python2.7/site-packages/flask/app.py\", line 1614, in full_dispatch_request\r\n    rv = self.handle_user_exception(e)\r\n  File \"/home/adrian/dev/indico/env/lib/python2.7/site-packages/flask/app.py\", line 1517, in handle_user_exception\r\n    reraise(exc_type, exc_value, tb)\r\n  File \"/home/adrian/dev/indico/env/lib/python2.7/site-packages/flask/app.py\", line 1612, in full_dispatch_request\r\n    rv = self.dispatch_request()\r\n  File \"/home/adrian/dev/indico/env/lib/python2.7/site-packages/flask/app.py\", line 1598, in dispatch_request\r\n    return self.view_functions[rule.endpoint](**req.view_args)\r\n  File \"/home/adrian/dev/indico/src/flasktest.py\", line 10, in index\r\n    return send_file('/etc/passwd', mimetype='text/plain', conditional=True)\r\n  File \"/home/adrian/dev/indico/env/lib/python2.7/site-packages/flask/helpers.py\", line 594, in send_file\r\n    file.close()\r\nAttributeError: 'NoneType' object has no attribute 'close'\r\n```\r\n\r\nProbably just a missing `if file is not None` check."
}