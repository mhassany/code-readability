{
    "url": "https://api.github.com/repos/pallets/flask/issues/3014",
    "repository_url": "https://api.github.com/repos/pallets/flask",
    "labels_url": "https://api.github.com/repos/pallets/flask/issues/3014/labels{/name}",
    "comments_url": "https://api.github.com/repos/pallets/flask/issues/3014/comments",
    "events_url": "https://api.github.com/repos/pallets/flask/issues/3014/events",
    "html_url": "https://github.com/pallets/flask/issues/3014",
    "id": 387558507,
    "node_id": "MDU6SXNzdWUzODc1NTg1MDc=",
    "number": 3014,
    "title": "server banner seems works not as expected",
    "user": {
        "login": "lt94",
        "id": 10162120,
        "node_id": "MDQ6VXNlcjEwMTYyMTIw",
        "avatar_url": "https://avatars1.githubusercontent.com/u/10162120?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/lt94",
        "html_url": "https://github.com/lt94",
        "followers_url": "https://api.github.com/users/lt94/followers",
        "following_url": "https://api.github.com/users/lt94/following{/other_user}",
        "gists_url": "https://api.github.com/users/lt94/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/lt94/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/lt94/subscriptions",
        "organizations_url": "https://api.github.com/users/lt94/orgs",
        "repos_url": "https://api.github.com/users/lt94/repos",
        "events_url": "https://api.github.com/users/lt94/events{/privacy}",
        "received_events_url": "https://api.github.com/users/lt94/received_events",
        "type": "User",
        "site_admin": false
    },
    "labels": [],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [],
    "milestone": null,
    "comments": 7,
    "created_at": "2018-12-05T01:50:47Z",
    "updated_at": "2018-12-05T06:35:23Z",
    "closed_at": "2018-12-05T02:09:00Z",
    "author_association": "NONE",
    "body": "### Expected Behavior\r\nI had already config the variable \"ENV\" in the config, which was set as 'development', It seemed that the banner should display \"Environment: development\",actually,it didn't. What's more, it worked with env development.\r\n\r\n```python\r\n# config\r\nclass Config:\r\n    # ...\r\n    @staticmethod\r\n    def init_app(app):\r\n        pass\r\nclass DevelopmentConfig(Config):\r\n    ENV='development'\r\n\r\ndef create_app(config_name):\r\n    app = Flask(__name__, static_folder='static', static_url_path='')\r\n\r\n    app.config.from_object(config[config_name])\r\n    config[config_name].init_app(app)\r\n    # ...\r\n    print(\"*Actual Environment: {}\".format(app.config['ENV']))\r\n    return app\r\n\r\n# wsgi.py\r\nfrom app import create_app\r\n\r\napplication = create_app('default')\r\n```\r\n\r\n### Actual Behavior\r\n```pyrb\r\n * Serving Flask app \"wsgi.py\"\r\n * Environment: production\r\n   WARNING: Do not use the development server in a production environment.\r\n   Use a production WSGI server instead.\r\n * Debug mode: off\r\n*Actual Environment:development\r\n * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)\r\n```\r\n### Environment\r\n\r\n* Python version: 3.6.5\r\n* Flask version: 1.0.2\r\n* Werkzeug version: 0.14.1\r\n",
    "comments_inline": [
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/444330752",
            "html_url": "https://github.com/pallets/flask/issues/3014#issuecomment-444330752",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3014",
            "id": 444330752,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NDMzMDc1Mg==",
            "user": {
                "login": "garenchan",
                "id": 13200012,
                "node_id": "MDQ6VXNlcjEzMjAwMDEy",
                "avatar_url": "https://avatars2.githubusercontent.com/u/13200012?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/garenchan",
                "html_url": "https://github.com/garenchan",
                "followers_url": "https://api.github.com/users/garenchan/followers",
                "following_url": "https://api.github.com/users/garenchan/following{/other_user}",
                "gists_url": "https://api.github.com/users/garenchan/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/garenchan/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/garenchan/subscriptions",
                "organizations_url": "https://api.github.com/users/garenchan/orgs",
                "repos_url": "https://api.github.com/users/garenchan/repos",
                "events_url": "https://api.github.com/users/garenchan/events{/privacy}",
                "received_events_url": "https://api.github.com/users/garenchan/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-12-05T02:04:00Z",
            "updated_at": "2018-12-05T02:08:16Z",
            "author_association": "CONTRIBUTOR",
            "body": "As the doc said, setting up the environment in your code may not work. You need to set it in the environment variables.\r\nhttps://github.com/pallets/flask/blob/d5665e4ba6cf4f7eabdc0be047952a27965a455f/flask/app.py#L810-L814\r\n\r\nOn Windows:\r\n```bat\r\nset FLASK_ENV=development\r\n```\r\nOn Linux:\r\n```shell\r\nexport FLASK_ENV=development\r\n```\r\nOr set environment variables in your code. If you use `app.run()` to run your development server, the following setting must be executed before it.\r\n```python\r\nimport os\r\nos.environ['FLASK_ENV'] = 'development'\r\n```\r\n"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/444331356",
            "html_url": "https://github.com/pallets/flask/issues/3014#issuecomment-444331356",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3014",
            "id": 444331356,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NDMzMTM1Ng==",
            "user": {
                "login": "lt94",
                "id": 10162120,
                "node_id": "MDQ6VXNlcjEwMTYyMTIw",
                "avatar_url": "https://avatars1.githubusercontent.com/u/10162120?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/lt94",
                "html_url": "https://github.com/lt94",
                "followers_url": "https://api.github.com/users/lt94/followers",
                "following_url": "https://api.github.com/users/lt94/following{/other_user}",
                "gists_url": "https://api.github.com/users/lt94/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/lt94/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/lt94/subscriptions",
                "organizations_url": "https://api.github.com/users/lt94/orgs",
                "repos_url": "https://api.github.com/users/lt94/repos",
                "events_url": "https://api.github.com/users/lt94/events{/privacy}",
                "received_events_url": "https://api.github.com/users/lt94/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-12-05T02:07:03Z",
            "updated_at": "2018-12-05T02:07:03Z",
            "author_association": "NONE",
            "body": "@garenchan is it a bug? it worked actually, but just the banner display wrong"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/444331742",
            "html_url": "https://github.com/pallets/flask/issues/3014#issuecomment-444331742",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3014",
            "id": 444331742,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NDMzMTc0Mg==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-12-05T02:09:00Z",
            "updated_at": "2018-12-05T02:09:00Z",
            "author_association": "MEMBER",
            "body": "You've confused variables in Python code with environment variables. FLASK_ENV must be set as an environment variable. See the docs on the CLI for more information."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/444332016",
            "html_url": "https://github.com/pallets/flask/issues/3014#issuecomment-444332016",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3014",
            "id": 444332016,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NDMzMjAxNg==",
            "user": {
                "login": "garenchan",
                "id": 13200012,
                "node_id": "MDQ6VXNlcjEzMjAwMDEy",
                "avatar_url": "https://avatars2.githubusercontent.com/u/13200012?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/garenchan",
                "html_url": "https://github.com/garenchan",
                "followers_url": "https://api.github.com/users/garenchan/followers",
                "following_url": "https://api.github.com/users/garenchan/following{/other_user}",
                "gists_url": "https://api.github.com/users/garenchan/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/garenchan/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/garenchan/subscriptions",
                "organizations_url": "https://api.github.com/users/garenchan/orgs",
                "repos_url": "https://api.github.com/users/garenchan/repos",
                "events_url": "https://api.github.com/users/garenchan/events{/privacy}",
                "received_events_url": "https://api.github.com/users/garenchan/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-12-05T02:10:27Z",
            "updated_at": "2018-12-05T02:10:27Z",
            "author_association": "CONTRIBUTOR",
            "body": "@lt94 , it's not a bug. You should use `app.env` to get the actual environment."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/444332174",
            "html_url": "https://github.com/pallets/flask/issues/3014#issuecomment-444332174",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3014",
            "id": 444332174,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NDMzMjE3NA==",
            "user": {
                "login": "lt94",
                "id": 10162120,
                "node_id": "MDQ6VXNlcjEwMTYyMTIw",
                "avatar_url": "https://avatars1.githubusercontent.com/u/10162120?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/lt94",
                "html_url": "https://github.com/lt94",
                "followers_url": "https://api.github.com/users/lt94/followers",
                "following_url": "https://api.github.com/users/lt94/following{/other_user}",
                "gists_url": "https://api.github.com/users/lt94/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/lt94/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/lt94/subscriptions",
                "organizations_url": "https://api.github.com/users/lt94/orgs",
                "repos_url": "https://api.github.com/users/lt94/repos",
                "events_url": "https://api.github.com/users/lt94/events{/privacy}",
                "received_events_url": "https://api.github.com/users/lt94/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-12-05T02:11:22Z",
            "updated_at": "2018-12-05T02:11:22Z",
            "author_association": "NONE",
            "body": "thanks~"
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/444342152",
            "html_url": "https://github.com/pallets/flask/issues/3014#issuecomment-444342152",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3014",
            "id": 444342152,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NDM0MjE1Mg==",
            "user": {
                "login": "davidism",
                "id": 1242887,
                "node_id": "MDQ6VXNlcjEyNDI4ODc=",
                "avatar_url": "https://avatars1.githubusercontent.com/u/1242887?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/davidism",
                "html_url": "https://github.com/davidism",
                "followers_url": "https://api.github.com/users/davidism/followers",
                "following_url": "https://api.github.com/users/davidism/following{/other_user}",
                "gists_url": "https://api.github.com/users/davidism/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/davidism/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/davidism/subscriptions",
                "organizations_url": "https://api.github.com/users/davidism/orgs",
                "repos_url": "https://api.github.com/users/davidism/repos",
                "events_url": "https://api.github.com/users/davidism/events{/privacy}",
                "received_events_url": "https://api.github.com/users/davidism/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-12-05T03:06:00Z",
            "updated_at": "2018-12-05T03:06:00Z",
            "author_association": "MEMBER",
            "body": "You cannot set the env with `app.env`. You must set it with the `FLASK_ENV` environment variable."
        },
        {
            "url": "https://api.github.com/repos/pallets/flask/issues/comments/444375450",
            "html_url": "https://github.com/pallets/flask/issues/3014#issuecomment-444375450",
            "issue_url": "https://api.github.com/repos/pallets/flask/issues/3014",
            "id": 444375450,
            "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NDM3NTQ1MA==",
            "user": {
                "login": "garenchan",
                "id": 13200012,
                "node_id": "MDQ6VXNlcjEzMjAwMDEy",
                "avatar_url": "https://avatars2.githubusercontent.com/u/13200012?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/garenchan",
                "html_url": "https://github.com/garenchan",
                "followers_url": "https://api.github.com/users/garenchan/followers",
                "following_url": "https://api.github.com/users/garenchan/following{/other_user}",
                "gists_url": "https://api.github.com/users/garenchan/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/garenchan/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/garenchan/subscriptions",
                "organizations_url": "https://api.github.com/users/garenchan/orgs",
                "repos_url": "https://api.github.com/users/garenchan/repos",
                "events_url": "https://api.github.com/users/garenchan/events{/privacy}",
                "received_events_url": "https://api.github.com/users/garenchan/received_events",
                "type": "User",
                "site_admin": false
            },
            "created_at": "2018-12-05T06:35:23Z",
            "updated_at": "2018-12-05T06:35:23Z",
            "author_association": "CONTRIBUTOR",
            "body": "@lt94 , I'm so sorry I misled you. You're right and this is indeed a bug.\r\n\r\n- If you run your app with `flask` CLI, the `Environment` in the banner may be wrong. Because `flask` CLI may use a lazy loading strategy, it means that when you run `flask run`, the app may not be available yet, so `flask` cli can't know what the final `Env` is at this moment.  If you change the `Env` in the `create_app`,  then the `Environment` that was printed before will be wrong.\r\n- If you run your app with `app.run`, you won't have this problem.\r\n\r\nI can give a PR to solve this problem, but I think it may not be accepted. So my advice to you is to use `FLASK_ENV` environment variable to set the `Env`."
        }
    ]
}